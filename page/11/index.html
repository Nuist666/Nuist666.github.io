<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Nuist666的个人博客</title>

  <!-- keywords -->
  

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Nuist666的个人博客">
<meta property="og:url" content="https://nuist666.github.io/page/11/index.html">
<meta property="og:site_name" content="Nuist666的个人博客">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Nuist666">
<meta name="twitter:card" content="summary">
  
    <link rel="alternative" href="/atom.xml" title="Nuist666的个人博客" type="application/atom+xml">
  
  
    <link rel="icon" href="/img/favicon.ico">
  
  
<link rel="stylesheet" href="/css/style.css">

  
  

  
<script src="//cdn.bootcss.com/require.js/2.3.2/require.min.js"></script>

  
<script src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script>


  
<meta name="generator" content="Hexo 7.1.1"></head>
<body>
  <div id="container">
    <div id="particles-js"></div>
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
				<img lazy-src="/img/avatar.png" class="js-avatar">
			
		</a>

		<hgroup>
			<h1 class="header-author"><a href="/">Nuist666</a></h1>
		</hgroup>

		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">Home</a></li>
				        
							<li><a href="/archives">Archives</a></li>
				        
						</ul>
					</nav>
					<nav class="half-header-menu">
						<a class="hide">Home</a>
						<a>Tags</a>
						<a>Links</a>
						<a>About</a>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/Nuist666" title="github">github</a>
					        
								<a class="mail" target="_blank" href="mailto:202183290043@gmail.com" title="mail">mail</a>
					        
								<a class="weibo" target="_blank" href="https://weibo.com/u/5586096129" title="weibo">weibo</a>
					        
								<a class="twitter" target="_blank" href="https://twitter.com/nuist_666" title="twitter">twitter</a>
					        
						</div>
						<!-- music -->
						
							<!-- <div style="position: absolute; bottom: 120px; left: auto; width: 85%;"> -->
							<div style="position: absolute; left: auto; width: 85%;">
								<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=220 height=86 src="//music.163.com/outchain/player?type=2&id=28411862&auto=1&height=66"></iframe>
							</div>
						
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/Overflow-Mirai-LLOneBot-OneBot/" style="font-size: 10px;">Overflow,Mirai,LLOneBot,OneBot</a> <a href="/tags/python-%E6%B0%94%E8%B1%A1%E4%BF%A1%E6%81%AF%E7%B3%BB%E7%BB%9F%E5%B7%A5%E7%A8%8B/" style="font-size: 20px;">python,气象信息系统工程</a> <a href="/tags/%E5%8D%8E%E4%B8%BA%E4%BA%91-%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2-Hexo/" style="font-size: 10px;">华为云,个人博客,Hexo</a> <a href="/tags/%E6%A8%A1%E6%9D%BF-%E5%B0%8F%E4%B9%A6%E5%8C%A0-%E4%B8%89%E5%B3%B0%E7%9C%9F%E7%99%BD-%E6%96%B0%E5%BB%BA/" style="font-size: 10px;">模板,小书匠,三峰真白,新建</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="https://qm.qq.com/q/HrJvHGMzek">qq</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="https://space.bilibili.com/3546647772531174">bilibili</a>
			        
			        </div>
				</section>
				

				
				
				<section class="switch-part switch-part4">
				
					<div id="js-aboutme">I&#39;m a student in NUIST.</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>

<img src="1" onerror="localStorage.setItem('modelId','25')" style="display: none;">

<script>

// live2d_path 参数建议使用绝对路径
const live2d_path = "https://fastly.jsdelivr.net/gh/stevenjoezhang/live2d-widget@latest/";
//const live2d_path = "/live2d-widget/";

// 封装异步加载资源的方法
function loadExternalResource(url, type) {
	return new Promise((resolve, reject) => {
		let tag;

		if (type === "css") {
			tag = document.createElement("link");
			tag.rel = "stylesheet";
			tag.href = url;
		}
		else if (type === "js") {
			tag = document.createElement("script");
			tag.src = url;
		}
		if (tag) {
			tag.onload = () => resolve(url);
			tag.onerror = () => reject(url);
			document.head.appendChild(tag);
		}
	});
}

// 加载 waifu.css live2d.min.js waifu-tips.js
	Promise.all([
		loadExternalResource(live2d_path + "waifu.css", "css"),
		loadExternalResource(live2d_path + "live2d.min.js", "js"),
		loadExternalResource(live2d_path + "waifu-tips.js", "js")
	]).then(() => {
		// 配置选项的具体用法见 README.md
		initWidget({
			waifuPath: live2d_path + "waifu-tips.json",
			apiPath: "https://api.zsq.im/live2d/",
			//cdnPath: "https://fastly.jsdelivr.net/gh/fghrsh/live2d_api/",
			tools: ["hitokoto", "asteroids", "switch-model", "switch-texture", "photo", "info", "quit"]
		});
	});

console.log(`
  く__,.ヘヽ.        /  ,ー､ 〉
           ＼ ', !-─‐-i  /  /´
           ／｀ｰ'       L/／｀ヽ､
         /   ／,   /|   ,   ,       ',
       ｲ   / /-‐/  ｉ  L_ ﾊ ヽ!   i
        ﾚ ﾍ 7ｲ｀ﾄ   ﾚ'ｧ-ﾄ､!ハ|   |
          !,/7 '0'     ´0iソ|    |
          |.从"    _     ,,,, / |./    |
          ﾚ'| i＞.､,,__  _,.イ /   .i   |
            ﾚ'| | / k_７_/ﾚ'ヽ,  ﾊ.  |
              | |/i 〈|/   i  ,.ﾍ |  i  |
             .|/ /  ｉ：    ﾍ!    ＼  |
              kヽ>､ﾊ    _,.ﾍ､    /､!
              !'〈//｀Ｔ´', ＼ ｀'7'ｰr'
              ﾚ'ヽL__|___i,___,ンﾚ|ノ
                  ﾄ-,/  |___./
                  'ｰ'    !_,.:
`);

</script>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide"></h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="/img/avatar.png" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author"></h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">Home</a></li>
		        
					<li><a href="/archives">Archives</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/Nuist666" title="github">github</a>
			        
						<a class="mail" target="_blank" href="mailto:202183290043@gmail.com" title="mail">mail</a>
			        
						<a class="weibo" target="_blank" href="https://weibo.com/u/5586096129" title="weibo">weibo</a>
			        
						<a class="twitter" target="_blank" href="https://twitter.com/nuist_666" title="twitter">twitter</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap">
  
    <article id="post-第四章" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2000/01/01/%E7%AC%AC%E5%9B%9B%E7%AB%A0/" class="article-date">
  	<time datetime="1999-12-31T16:04:00.000Z" itemprop="datePublished">2000-01-01</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2000/01/01/%E7%AC%AC%E5%9B%9B%E7%AB%A0/">
        python气象信息系统工程 第四章
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="第4章-pandas：优秀的数据分析工具"><a href="#第4章-pandas：优秀的数据分析工具" class="headerlink" title="第4章 pandas：优秀的数据分析工具"></a>第4章 pandas：优秀的数据分析工具</h1><h2 id="4-2-pd-Series——序列"><a href="#4-2-pd-Series——序列" class="headerlink" title="4.2  pd.Series——序列"></a>4.2  pd.Series——序列</h2><h3 id="4-2-1-创建序列"><a href="#4-2-1-创建序列" class="headerlink" title="4.2.1  创建序列"></a>4.2.1  创建序列</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建序列</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.Series([<span class="number">9.1</span>, <span class="number">9.5</span>, <span class="number">10.0</span>, <span class="number">11.2</span>])</span><br><span class="line"><span class="built_in">print</span>(a)</span><br></pre></td></tr></table></figure>

<pre><code>0     9.1
1     9.5
2    10.0
3    11.2
dtype: float64
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建时指定索引</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.Series([<span class="number">9.1</span>, <span class="number">9.5</span>, <span class="number">10.0</span>, <span class="number">11.2</span>], index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(a)</span><br></pre></td></tr></table></figure>

<pre><code>a     9.1
b     9.5
c    10.0
d    11.2
dtype: float64
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建时指定名称</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.Series([<span class="number">9.1</span>, <span class="number">9.5</span>, <span class="number">10.0</span>, <span class="number">11.2</span>], index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>], name=<span class="string">&#x27;t&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a)</span><br></pre></td></tr></table></figure>

<pre><code>a     9.1
b     9.5
c    10.0
d    11.2
Name: t, dtype: float64
</code></pre>
<h3 id="4-2-2-时间索引"><a href="#4-2-2-时间索引" class="headerlink" title="4.2.2  时间索引"></a>4.2.2  时间索引</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 为时间序列准备的统计计算方法</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">a = pd.Series([<span class="number">9.1</span>, <span class="number">9.5</span>, <span class="number">10.0</span>, <span class="number">11.2</span>], </span><br><span class="line">            index=pd.to_datetime([<span class="string">&#x27;2020-02-19&#x27;</span>, <span class="string">&#x27;2020-02-20&#x27;</span>, </span><br><span class="line">                              <span class="string">&#x27;2020-02-21&#x27;</span>, <span class="string">&#x27;2020-02-22&#x27;</span>]), </span><br><span class="line">            name=<span class="string">&#x27;t&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="built_in">print</span>(a.index.astype(np.<span class="built_in">int</span>))</span><br></pre></td></tr></table></figure>

<pre><code>2020-02-19     9.1
2020-02-20     9.5
2020-02-21    10.0
2020-02-22    11.2
Name: t, dtype: float64
Int64Index([1582070400000000000, 1582156800000000000, 1582243200000000000,
            1582329600000000000],
           dtype=&#39;int64&#39;)


/opt/conda/lib/python3.7/site-packages/ipykernel_launcher.py:9: DeprecationWarning: `np.int` is a deprecated alias for the builtin `int`. To silence this warning, use `int` by itself. Doing this will not modify any behavior and is safe. When replacing `np.int`, you may wish to use e.g. `np.int64` or `np.int32` to specify the precision. If you wish to review your current use, check the release note link for additional information.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  if __name__ == &#39;__main__&#39;:
/opt/conda/lib/python3.7/site-packages/ipykernel_launcher.py:9: FutureWarning: casting datetime64[ns] values to int64 with .astype(...) is deprecated and will raise in a future version. Use .view(...) instead.
  if __name__ == &#39;__main__&#39;:
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 时区转换</span></span><br><span class="line"><span class="keyword">import</span> datetime <span class="keyword">as</span> dt</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">index_time = pd.to_datetime([<span class="string">&#x27;2020-02-19&#x27;</span>, <span class="string">&#x27;2020-02-20&#x27;</span>, <span class="string">&#x27;2020-02-21&#x27;</span>, <span class="string">&#x27;2020-02-22&#x27;</span>])</span><br><span class="line">index_time = index_time - dt.timedelta(hours=<span class="number">8</span>)</span><br><span class="line">a = pd.Series([<span class="number">9.1</span>, <span class="number">9.5</span>, <span class="number">10.0</span>, <span class="number">11.2</span>], index=index_time, name=<span class="string">&#x27;t&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a)</span><br></pre></td></tr></table></figure>

<pre><code>2020-02-18 16:00:00     9.1
2020-02-19 16:00:00     9.5
2020-02-20 16:00:00    10.0
2020-02-21 16:00:00    11.2
Name: t, dtype: float64
</code></pre>
<h3 id="4-2-3-pd-Series对象的算术运算"><a href="#4-2-3-pd-Series对象的算术运算" class="headerlink" title="4.2.3  pd.Series对象的算术运算"></a>4.2.3  pd.Series对象的算术运算</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 序列的标量运算</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.Series([<span class="number">9.1</span>, <span class="number">9.5</span>, <span class="number">10.0</span>, <span class="number">11.2</span>], index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>], name=<span class="string">&#x27;t&#x27;</span>)</span><br><span class="line">b = a - <span class="number">10</span></span><br><span class="line"><span class="built_in">print</span>(b)</span><br></pre></td></tr></table></figure>

<pre><code>a   -0.9
b   -0.5
c    0.0
d    1.2
Name: t, dtype: float64
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 按照索引的运算</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.Series([<span class="number">9.1</span>, <span class="number">9.5</span>, <span class="number">10.0</span>, <span class="number">11.2</span>], index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>], name=<span class="string">&#x27;t1&#x27;</span>)</span><br><span class="line">b = pd.Series([<span class="number">9.1</span>, <span class="number">9.5</span>, <span class="number">10.0</span>, <span class="number">11.2</span>], index=[<span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>], name=<span class="string">&#x27;t2&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(b - a)</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.Series([<span class="number">9.1</span>, <span class="number">9.5</span>, <span class="number">10.0</span>, <span class="number">11.2</span>], index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>], name=<span class="string">&#x27;t1&#x27;</span>)</span><br><span class="line">b = pd.Series([<span class="number">9.1</span>, <span class="number">9.5</span>, <span class="number">10.0</span>, <span class="number">11.2</span>], index=[<span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;e&#x27;</span>], name=<span class="string">&#x27;t2&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(b - a)</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.Series([<span class="number">9.1</span>, <span class="number">9.5</span>, <span class="number">10.0</span>, <span class="number">11.2</span>], index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>], name=<span class="string">&#x27;t1&#x27;</span>)</span><br><span class="line">b = pd.Series([<span class="number">9.1</span>, <span class="number">9.5</span>, <span class="number">10.0</span>, <span class="number">11.2</span>], index=[<span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;g&#x27;</span>, <span class="string">&#x27;h&#x27;</span>], name=<span class="string">&#x27;t2&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(b - a)</span><br></pre></td></tr></table></figure>

<pre><code>a    0.4
b   -0.4
c    0.0
d    0.0
dtype: float64
a    NaN
b   -0.4
c   -0.5
d   -1.2
e    NaN
dtype: float64
a   NaN
b   NaN
c   NaN
d   NaN
e   NaN
f   NaN
g   NaN
h   NaN
dtype: float64
</code></pre>
<h3 id="4-2-4-pd-Series对象的常用属性"><a href="#4-2-4-pd-Series对象的常用属性" class="headerlink" title="4.2.4  pd.Series对象的常用属性"></a>4.2.4  pd.Series对象的常用属性</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 序列的数据类型</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.Series([<span class="number">9.1</span>, <span class="number">9.5</span>, <span class="number">10.0</span>, <span class="number">11.2</span>], index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>], name=<span class="string">&#x27;t&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.dtype)</span><br></pre></td></tr></table></figure>

<pre><code>float64
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 序列的数据维度</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.Series([<span class="number">9.1</span>, <span class="number">9.5</span>, <span class="number">10.0</span>, <span class="number">11.2</span>], index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>], name=<span class="string">&#x27;t&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.ndim)</span><br></pre></td></tr></table></figure>

<pre><code>1
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 序列的数据形状</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.Series([<span class="number">9.1</span>, <span class="number">9.5</span>, <span class="number">10.0</span>, <span class="number">11.2</span>], index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>], name=<span class="string">&#x27;t&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.shape)</span><br></pre></td></tr></table></figure>

<pre><code>(4,)
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 通过标签索引访问单个元素</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.Series([<span class="number">9.1</span>, <span class="number">9.5</span>, <span class="number">10.0</span>, <span class="number">11.2</span>], index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>], name=<span class="string">&#x27;t&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.at[<span class="string">&#x27;a&#x27;</span>])</span><br></pre></td></tr></table></figure>

<pre><code>9.1
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 通过位置数值索引访问单个元素</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.Series([<span class="number">9.1</span>, <span class="number">9.5</span>, <span class="number">10.0</span>, <span class="number">11.2</span>], index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>], name=<span class="string">&#x27;t&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.iat[<span class="number">0</span>])</span><br></pre></td></tr></table></figure>

<pre><code>9.1
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 通过标签列访问多个元素</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.Series([<span class="number">9.1</span>, <span class="number">9.5</span>, <span class="number">10.0</span>, <span class="number">11.2</span>], index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>], name=<span class="string">&#x27;t&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.loc[<span class="string">&#x27;a&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;----------&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.loc[[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>]])</span><br></pre></td></tr></table></figure>

<pre><code>9.1
----------
a    9.1
b    9.5
Name: t, dtype: float64
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 通过布尔序列列访问多个元素</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.Series([<span class="number">9.1</span>, <span class="number">9.5</span>, <span class="number">10.0</span>, <span class="number">11.2</span>], index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>], name=<span class="string">&#x27;t&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.loc[[<span class="literal">True</span>, <span class="literal">False</span>, <span class="literal">True</span>, <span class="literal">False</span>]])</span><br></pre></td></tr></table></figure>

<pre><code>a     9.1
c    10.0
Name: t, dtype: float64
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 通过位置访问多个元素</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.Series([<span class="number">9.1</span>, <span class="number">9.5</span>, <span class="number">10.0</span>, <span class="number">11.2</span>], index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>], name=<span class="string">&#x27;t&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.iloc[<span class="number">0</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;----------&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.iloc[[<span class="number">0</span>, <span class="number">1</span>]])</span><br></pre></td></tr></table></figure>

<pre><code>9.1
----------
a    9.1
b    9.5
Name: t, dtype: float64
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获取数据的原始np.ndarray对象</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.Series([<span class="number">9.1</span>, <span class="number">9.5</span>, <span class="number">10.0</span>, <span class="number">11.2</span>], index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>], name=<span class="string">&#x27;t&#x27;</span>)</span><br><span class="line">b = a.values</span><br><span class="line"><span class="built_in">print</span>(b)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(b))</span><br></pre></td></tr></table></figure>

<pre><code>[ 9.1  9.5 10.  11.2]
&lt;class &#39;numpy.ndarray&#39;&gt;
</code></pre>
<h3 id="4-2-5-pd-Series对象的常用方法"><a href="#4-2-5-pd-Series对象的常用方法" class="headerlink" title="4.2.5  pd.Series对象的常用方法"></a>4.2.5  pd.Series对象的常用方法</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 删除缺测值NaN</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.Series([<span class="number">9.1</span>, np.nan, <span class="number">10.0</span>, <span class="number">11.2</span>], index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>], name=<span class="string">&#x27;t&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line">b = a.dropna()</span><br><span class="line"><span class="built_in">print</span>(b)</span><br></pre></td></tr></table></figure>

<pre><code>a     9.1
b     NaN
c    10.0
d    11.2
Name: t, dtype: float64
a     9.1
c    10.0
d    11.2
Name: t, dtype: float64
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 根据站号索引分组计算平均值</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.Series([<span class="number">9.1</span>, <span class="number">9.5</span>, <span class="number">10.0</span>, <span class="number">11.2</span>],</span><br><span class="line">            index=[<span class="string">&#x27;sta1&#x27;</span>, <span class="string">&#x27;sta2&#x27;</span>, <span class="string">&#x27;sta1&#x27;</span>, <span class="string">&#x27;sta2&#x27;</span>], </span><br><span class="line">            name=<span class="string">&#x27;t&#x27;</span>)</span><br><span class="line">b = a.groupby(level=<span class="number">0</span>).mean()</span><br><span class="line"><span class="built_in">print</span>(b)</span><br></pre></td></tr></table></figure>

<pre><code>sta1     9.55
sta2    10.35
Name: t, dtype: float64
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 根据阈值分组计算平均值</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.Series([<span class="number">9.1</span>, <span class="number">9.5</span>, <span class="number">10.0</span>, <span class="number">11.2</span>],</span><br><span class="line">            index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>], </span><br><span class="line">            name=<span class="string">&#x27;t&#x27;</span>)</span><br><span class="line">b = a.groupby(a&gt;<span class="number">9.9</span>).mean()</span><br><span class="line"><span class="built_in">print</span>(b)</span><br></pre></td></tr></table></figure>

<pre><code>t
False     9.3
True     10.6
Name: t, dtype: float64
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 按规则映射元素</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.Series([<span class="number">9.1</span>, <span class="number">9.5</span>, <span class="number">10.0</span>, <span class="number">11.2</span>],</span><br><span class="line">            index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>], </span><br><span class="line">            name=<span class="string">&#x27;t&#x27;</span>)</span><br><span class="line">b = a.<span class="built_in">map</span>(<span class="keyword">lambda</span> x: x - <span class="number">5</span>)</span><br><span class="line"><span class="built_in">print</span>(b)</span><br></pre></td></tr></table></figure>

<pre><code>a    4.1
b    4.5
c    5.0
d    6.2
Name: t, dtype: float64
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 插值填充NaN</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.Series([<span class="number">8.0</span>, np.nan, <span class="number">10.0</span>, <span class="number">11.0</span>], </span><br><span class="line">            index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>], </span><br><span class="line">            name=<span class="string">&#x27;t&#x27;</span>)</span><br><span class="line">b = a.interpolate(method=<span class="string">&#x27;linear&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(b)</span><br></pre></td></tr></table></figure>

<pre><code>a     8.0
b     9.0
c    10.0
d    11.0
Name: t, dtype: float64
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 指定值填充NaN</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.Series([<span class="number">8.0</span>, np.nan, <span class="number">10.0</span>, <span class="number">11.0</span>], </span><br><span class="line">            index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>], </span><br><span class="line">            name=<span class="string">&#x27;t&#x27;</span>)</span><br><span class="line">b = a.fillna(value=<span class="number">999</span>)</span><br><span class="line"><span class="built_in">print</span>(b)</span><br></pre></td></tr></table></figure>

<pre><code>a      8.0
b    999.0
c     10.0
d     11.0
Name: t, dtype: float64
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 利用相邻值填充NaN</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.Series([<span class="number">8.0</span>, np.nan, <span class="number">10.0</span>, <span class="number">11.0</span>], </span><br><span class="line">            index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>], </span><br><span class="line">            name=<span class="string">&#x27;t&#x27;</span>)</span><br><span class="line">b = a.fillna(method=<span class="string">&#x27;bfill&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(b)</span><br><span class="line">b = a.fillna(method=<span class="string">&#x27;ffill&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(b)</span><br></pre></td></tr></table></figure>

<pre><code>a     8.0
b    10.0
c    10.0
d    11.0
Name: t, dtype: float64
a     8.0
b     8.0
c    10.0
d    11.0
Name: t, dtype: float64
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 降采样</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.Series([<span class="number">9.1</span>, <span class="number">9.5</span>, <span class="number">10.0</span>, <span class="number">11.2</span>], </span><br><span class="line">            index=pd.to_datetime([<span class="string">&#x27;2020-02-19&#x27;</span>, <span class="string">&#x27;2020-02-20&#x27;</span>, </span><br><span class="line">                              <span class="string">&#x27;2020-02-22&#x27;</span>, <span class="string">&#x27;2020-02-23&#x27;</span>]), </span><br><span class="line">            name=<span class="string">&#x27;t&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.resample(<span class="string">&#x27;2D&#x27;</span>).<span class="built_in">max</span>())</span><br></pre></td></tr></table></figure>

<pre><code>2020-02-19     9.5
2020-02-21    10.0
2020-02-23    11.2
Freq: 2D, Name: t, dtype: float64
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 升采样</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.Series([<span class="number">9.1</span>, <span class="number">9.5</span>, <span class="number">10.0</span>, <span class="number">11.2</span>], </span><br><span class="line">            index=pd.to_datetime([<span class="string">&#x27;2020-02-19&#x27;</span>, <span class="string">&#x27;2020-02-20&#x27;</span>, </span><br><span class="line">                              <span class="string">&#x27;2020-02-22&#x27;</span>, <span class="string">&#x27;2020-02-23&#x27;</span>]), </span><br><span class="line">            name=<span class="string">&#x27;t&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.resample(<span class="string">&#x27;1D&#x27;</span>).asfreq())</span><br><span class="line"><span class="built_in">print</span>(a.resample(<span class="string">&#x27;1D&#x27;</span>).bfill())</span><br></pre></td></tr></table></figure>

<pre><code>2020-02-19     9.1
2020-02-20     9.5
2020-02-21     NaN
2020-02-22    10.0
2020-02-23    11.2
Freq: D, Name: t, dtype: float64
2020-02-19     9.1
2020-02-20     9.5
2020-02-21    10.0
2020-02-22    10.0
2020-02-23    11.2
Freq: D, Name: t, dtype: float64
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 按照指定顺序排序</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.Series([<span class="number">9.1</span>, <span class="number">9.5</span>, <span class="number">10.0</span>, <span class="number">11.2</span>],</span><br><span class="line">            index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>], </span><br><span class="line">            name=<span class="string">&#x27;t&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line">b = a.reindex([<span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;c&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(b)</span><br></pre></td></tr></table></figure>

<pre><code>a     9.1
b     9.5
c    10.0
d    11.2
Name: t, dtype: float64
d    11.2
b     9.5
a     9.1
c    10.0
Name: t, dtype: float64
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用reindex_like()可以用一个序列的索引来对另一个序列进行排序</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.Series([<span class="number">9.1</span>, <span class="number">9.5</span>, <span class="number">10.0</span>, <span class="number">11.2</span>],</span><br><span class="line">            index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>], </span><br><span class="line">            name=<span class="string">&#x27;t1&#x27;</span>)</span><br><span class="line">b = pd.Series([<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">            index=[<span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;d&#x27;</span>], </span><br><span class="line">            name=<span class="string">&#x27;t2&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line">c = a.reindex_like(b)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br></pre></td></tr></table></figure>

<pre><code>a     9.1
b     9.5
c    10.0
d    11.2
Name: t1, dtype: float64
b     9.5
d    11.2
a     9.1
d    11.2
Name: t1, dtype: float64
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 重命名序列</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.Series([<span class="number">9.1</span>, <span class="number">9.5</span>, <span class="number">10.0</span>, <span class="number">11.2</span>],</span><br><span class="line">            index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>], </span><br><span class="line">            name=<span class="string">&#x27;hello&#x27;</span>)</span><br><span class="line">b = a.rename(<span class="string">&#x27;t&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(b)</span><br></pre></td></tr></table></figure>

<pre><code>a     9.1
b     9.5
c    10.0
d    11.2
Name: t, dtype: float64
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 滑动窗口计算</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.Series([<span class="number">9.1</span>, <span class="number">9.5</span>, <span class="number">10.0</span>, <span class="number">11.2</span>, <span class="number">12.1</span>, <span class="number">13.6</span>, <span class="number">14.5</span>, <span class="number">10.1</span>],</span><br><span class="line">            name=<span class="string">&#x27;t&#x27;</span>)</span><br><span class="line">b = a.rolling(<span class="number">3</span>).mean()</span><br><span class="line"><span class="built_in">print</span>(b)</span><br></pre></td></tr></table></figure>

<pre><code>0          NaN
1          NaN
2     9.533333
3    10.233333
4    11.100000
5    12.300000
6    13.400000
7    12.733333
Name: t, dtype: float64
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 中央平均的滑动窗口计算</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.Series([<span class="number">9.1</span>, <span class="number">9.5</span>, <span class="number">10.0</span>, <span class="number">11.2</span>, <span class="number">12.1</span>, <span class="number">13.6</span>, <span class="number">14.5</span>, <span class="number">10.1</span>],</span><br><span class="line">            name=<span class="string">&#x27;t&#x27;</span>)</span><br><span class="line">b = a.rolling(<span class="number">3</span>, center=<span class="literal">True</span>).mean()</span><br><span class="line"><span class="built_in">print</span>(b)</span><br></pre></td></tr></table></figure>

<pre><code>0          NaN
1     9.533333
2    10.233333
3    11.100000
4    12.300000
5    13.400000
6    12.733333
7          NaN
Name: t, dtype: float64
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 平移数据</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.Series([<span class="number">9.1</span>, <span class="number">9.5</span>, <span class="number">10.0</span>, <span class="number">11.2</span>],</span><br><span class="line">            index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>], </span><br><span class="line">            name=<span class="string">&#x27;t&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line">b = a.shift(<span class="number">3</span>)</span><br><span class="line"><span class="built_in">print</span>(b)</span><br></pre></td></tr></table></figure>

<pre><code>a     9.1
b     9.5
c    10.0
d    11.2
Name: t, dtype: float64
a    NaN
b    NaN
c    NaN
d    9.1
Name: t, dtype: float64
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 按照索引排序</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.Series([<span class="number">9.1</span>, <span class="number">9.5</span>, <span class="number">10.0</span>, <span class="number">11.2</span>],</span><br><span class="line">            index=[<span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;a&#x27;</span>], </span><br><span class="line">            name=<span class="string">&#x27;t&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line">b = a.sort_index()</span><br><span class="line"><span class="built_in">print</span>(b)</span><br><span class="line">c = a.sort_index(ascending=<span class="literal">False</span>)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br></pre></td></tr></table></figure>

<pre><code>b     9.1
d     9.5
c    10.0
a    11.2
Name: t, dtype: float64
a    11.2
b     9.1
c    10.0
d     9.5
Name: t, dtype: float64
d     9.5
c    10.0
b     9.1
a    11.2
Name: t, dtype: float64
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 按照数据排序</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.Series([<span class="number">9.5</span>, <span class="number">9.1</span>, <span class="number">11.2</span>, <span class="number">10.0</span>],</span><br><span class="line">            index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>], </span><br><span class="line">            name=<span class="string">&#x27;t&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line">b = a.sort_values()</span><br><span class="line"><span class="built_in">print</span>(b)</span><br><span class="line">c = a.sort_values(ascending=<span class="literal">False</span>)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br></pre></td></tr></table></figure>

<pre><code>a     9.5
b     9.1
c    11.2
d    10.0
Name: t, dtype: float64
b     9.1
a     9.5
d    10.0
c    11.2
Name: t, dtype: float64
c    11.2
d    10.0
a     9.5
b     9.1
Name: t, dtype: float64
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获取最大值/最小值</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.Series([<span class="number">9.5</span>, np.nan, <span class="number">11.2</span>, <span class="number">10.0</span>],</span><br><span class="line">            index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>], </span><br><span class="line">            name=<span class="string">&#x27;t&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.<span class="built_in">max</span>())</span><br><span class="line"><span class="built_in">print</span>(a.<span class="built_in">min</span>())</span><br></pre></td></tr></table></figure>

<pre><code>11.2
9.5
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获取最大值/最小值对应的位置</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.Series([<span class="number">9.5</span>, np.nan, <span class="number">11.2</span>, <span class="number">10.0</span>],</span><br><span class="line">            index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>], </span><br><span class="line">            name=<span class="string">&#x27;t&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.argmax())</span><br><span class="line"><span class="built_in">print</span>(a.argmin())</span><br></pre></td></tr></table></figure>

<pre><code>2
0
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获取最大值/最小值对应的标签索引</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.Series([<span class="number">9.5</span>, np.nan, <span class="number">11.2</span>, <span class="number">10.0</span>],</span><br><span class="line">            index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>], </span><br><span class="line">            name=<span class="string">&#x27;t&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.idxmax())</span><br><span class="line"><span class="built_in">print</span>(a.idxmin())</span><br></pre></td></tr></table></figure>

<pre><code>c
a
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 计算标准差/无偏方差</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.Series([<span class="number">9.5</span>, np.nan, <span class="number">11.2</span>, <span class="number">10.0</span>],</span><br><span class="line">            index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>], </span><br><span class="line">            name=<span class="string">&#x27;t&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.std())</span><br><span class="line"><span class="built_in">print</span>(a.var())</span><br></pre></td></tr></table></figure>

<pre><code>0.87368949480541
0.7633333333333326
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 计算协方差</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.Series([<span class="number">9.5</span>, <span class="number">10.1</span>, <span class="number">11.2</span>, <span class="number">10.0</span>],</span><br><span class="line">            index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>], </span><br><span class="line">            name=<span class="string">&#x27;t1&#x27;</span>)</span><br><span class="line">b = pd.Series([<span class="number">8.5</span>, <span class="number">9.1</span>, <span class="number">12.1</span>, <span class="number">10.5</span>],</span><br><span class="line">            index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>], </span><br><span class="line">            name=<span class="string">&#x27;t2&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.cov(b))</span><br></pre></td></tr></table></figure>

<pre><code>1.046666666666666
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 序列求和/求均值</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.Series([<span class="number">9.5</span>, <span class="number">10.1</span>, <span class="number">11.2</span>, <span class="number">10.0</span>],</span><br><span class="line">            index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>], </span><br><span class="line">            name=<span class="string">&#x27;t&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.<span class="built_in">sum</span>())</span><br><span class="line"><span class="built_in">print</span>(a.mean())</span><br></pre></td></tr></table></figure>

<pre><code>40.8
10.2
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 计算绝对值</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.Series([-<span class="number">9.5</span>, <span class="number">10.1</span>, -<span class="number">11.2</span>, <span class="number">10.0</span>],</span><br><span class="line">            index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>], </span><br><span class="line">            name=<span class="string">&#x27;t&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.<span class="built_in">abs</span>())</span><br></pre></td></tr></table></figure>

<pre><code>a     9.5
b    10.1
c    11.2
d    10.0
Name: t, dtype: float64
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 保存为CSV文件</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.Series([-<span class="number">9.5</span>, <span class="number">10.1</span>, -<span class="number">11.2</span>, <span class="number">10.0</span>],</span><br><span class="line">            index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>], </span><br><span class="line">            name=<span class="string">&#x27;t&#x27;</span>)</span><br><span class="line">a.to_csv(<span class="string">&#x27;series_with_index.csv&#x27;</span>)</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 忽略元素名字和索引，只保存数据</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.Series([-<span class="number">9.5</span>, <span class="number">10.1</span>, -<span class="number">11.2</span>, <span class="number">10.0</span>],</span><br><span class="line">            index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>], </span><br><span class="line">            name=<span class="string">&#x27;t&#x27;</span>)</span><br><span class="line">a.to_csv(<span class="string">&#x27;series_no_index.csv&#x27;</span>, index=<span class="literal">False</span>, header=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 转换为列表对象</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.Series([-<span class="number">9.5</span>, <span class="number">10.1</span>, -<span class="number">11.2</span>, <span class="number">10.0</span>],</span><br><span class="line">            index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>], </span><br><span class="line">            name=<span class="string">&#x27;t&#x27;</span>)</span><br><span class="line">b = a.to_list()</span><br><span class="line"><span class="built_in">print</span>(b)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(b))</span><br></pre></td></tr></table></figure>

<pre><code>[-9.5, 10.1, -11.2, 10.0]
&lt;class &#39;list&#39;&gt;
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 转换数据类型</span></span><br><span class="line"><span class="keyword">import</span> numpy</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.Series([-<span class="number">9.5</span>, <span class="number">10.1</span>, -<span class="number">11.2</span>, <span class="number">10.0</span>],</span><br><span class="line">            index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>], </span><br><span class="line">            name=<span class="string">&#x27;t&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line">b = a.astype(np.int32)</span><br><span class="line"><span class="built_in">print</span>(b)</span><br></pre></td></tr></table></figure>

<pre><code>a    -9.5
b    10.1
c   -11.2
d    10.0
Name: t, dtype: float64
a    -9
b    10
c   -11
d    10
Name: t, dtype: int32
</code></pre>
<h2 id="4-3-pd-DataFrame——数据框"><a href="#4-3-pd-DataFrame——数据框" class="headerlink" title="4.3 pd.DataFrame——数据框"></a>4.3 pd.DataFrame——数据框</h2><h3 id="4-3-1-创建数据框"><a href="#4-3-1-创建数据框" class="headerlink" title="4.3.1  创建数据框"></a>4.3.1  创建数据框</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建一个简单的数据框</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.DataFrame([[<span class="number">21.7</span>, <span class="number">983</span>, <span class="number">0.64</span>],</span><br><span class="line">               [<span class="number">19.2</span>, <span class="number">991</span>, <span class="number">0.75</span>],</span><br><span class="line">               [<span class="number">13.4</span>, <span class="number">973</span>, <span class="number">0.83</span>]]</span><br><span class="line">              )</span><br><span class="line"><span class="built_in">print</span>(a)</span><br></pre></td></tr></table></figure>

<pre><code>      0    1     2
0  21.7  983  0.64
1  19.2  991  0.75
2  13.4  973  0.83
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 为数据框添加行列索引</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.DataFrame([[<span class="number">21.7</span>, <span class="number">983</span>, <span class="number">0.64</span>],</span><br><span class="line">               [<span class="number">19.2</span>, <span class="number">991</span>, <span class="number">0.75</span>],</span><br><span class="line">               [<span class="number">13.4</span>, <span class="number">973</span>, <span class="number">0.83</span>]],</span><br><span class="line">              index=[<span class="string">&#x27;s1&#x27;</span>, <span class="string">&#x27;s2&#x27;</span>, <span class="string">&#x27;s3&#x27;</span>],</span><br><span class="line">              columns=[<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;rh&#x27;</span>]</span><br><span class="line">             )</span><br><span class="line"><span class="built_in">print</span>(a)</span><br></pre></td></tr></table></figure>

<pre><code>       t    p    rh
s1  21.7  983  0.64
s2  19.2  991  0.75
s3  13.4  973  0.83
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 抽取其中的序列对象</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.DataFrame([[<span class="number">21.7</span>, <span class="number">983</span>, <span class="number">0.64</span>],</span><br><span class="line">               [<span class="number">19.2</span>, <span class="number">991</span>, <span class="number">0.75</span>],</span><br><span class="line">               [<span class="number">13.4</span>, <span class="number">973</span>, <span class="number">0.83</span>]],</span><br><span class="line">              index=[<span class="string">&#x27;s1&#x27;</span>, <span class="string">&#x27;s2&#x27;</span>, <span class="string">&#x27;s3&#x27;</span>],</span><br><span class="line">              columns=[<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;rh&#x27;</span>]</span><br><span class="line">             )</span><br><span class="line">b = a[<span class="string">&#x27;t&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span>(b)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(b))</span><br></pre></td></tr></table></figure>

<pre><code>s1    21.7
s2    19.2
s3    13.4
Name: t, dtype: float64
&lt;class &#39;pandas.core.series.Series&#39;&gt;
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 包含不同数据类型的数据框</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.DataFrame([[<span class="number">21.7</span>, <span class="number">983</span>, <span class="number">0.64</span>],</span><br><span class="line">               [<span class="number">19.2</span>, <span class="number">991</span>, <span class="number">0.75</span>],</span><br><span class="line">               [<span class="number">13.4</span>, <span class="number">973</span>, <span class="number">0.83</span>]],</span><br><span class="line">              index=[<span class="string">&#x27;s1&#x27;</span>, <span class="string">&#x27;s2&#x27;</span>, <span class="string">&#x27;s3&#x27;</span>],</span><br><span class="line">              columns=[<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;rh&#x27;</span>]</span><br><span class="line">             )</span><br><span class="line"><span class="built_in">print</span>(a.dtypes)</span><br></pre></td></tr></table></figure>

<pre><code>t     float64
p       int64
rh    float64
dtype: object
</code></pre>
<h3 id="4-3-2-pd-DataFrame的时间索引"><a href="#4-3-2-pd-DataFrame的时间索引" class="headerlink" title="4.3.2  pd.DataFrame的时间索引"></a>4.3.2  pd.DataFrame的时间索引</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 带有时间索引的数据框</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.DataFrame([[<span class="number">21.7</span>, <span class="number">983</span>, <span class="number">0.64</span>],</span><br><span class="line">               [<span class="number">19.2</span>, <span class="number">991</span>, <span class="number">0.75</span>],</span><br><span class="line">               [<span class="number">13.4</span>, <span class="number">973</span>, <span class="number">0.83</span>]],</span><br><span class="line">              index=pd.to_datetime([<span class="string">&#x27;2020-02-19&#x27;</span>, <span class="string">&#x27;2020-02-20&#x27;</span>, <span class="string">&#x27;2020-02-22&#x27;</span>]),</span><br><span class="line">              columns=[<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;rh&#x27;</span>]</span><br><span class="line">             )</span><br><span class="line"><span class="built_in">print</span>(a)</span><br></pre></td></tr></table></figure>

<pre><code>               t    p    rh
2020-02-19  21.7  983  0.64
2020-02-20  19.2  991  0.75
2020-02-22  13.4  973  0.83
</code></pre>
<h3 id="4-3-3-读取CSV文件"><a href="#4-3-3-读取CSV文件" class="headerlink" title="4.3.3  读取CSV文件"></a>4.3.3  读取CSV文件</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 读取带有索引和列名的CSV文件</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.read_csv(<span class="string">&#x27;/home/mw/input/pythonbook9857/pandas_read.csv&#x27;</span>, index_col=<span class="number">0</span>)</span><br><span class="line"><span class="built_in">print</span>(a)</span><br></pre></td></tr></table></figure>

<pre><code>        t      p    rh
sta                   
s1   21.7  983.0  0.64
s2   19.2  991.0  0.75
s3   13.4  973.0  0.83
NaN   NaN    NaN   NaN
NaN   NaN    NaN   NaN
NaN   NaN    NaN   NaN
NaN   NaN    NaN   NaN
NaN   NaN    NaN   NaN
NaN   NaN    NaN   NaN
NaN   NaN    NaN   NaN
NaN   NaN    NaN   NaN
NaN   NaN    NaN   NaN
NaN   NaN    NaN   NaN
NaN   NaN    NaN   NaN
NaN   NaN    NaN   NaN
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 以其他列为索引</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.read_csv(<span class="string">&#x27;/home/mw/input/pythonbook9857/pandas_read.csv&#x27;</span>, index_col=<span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(a)</span><br></pre></td></tr></table></figure>

<pre><code>       sta     t    rh
p                     
983.0   s1  21.7  0.64
991.0   s2  19.2  0.75
973.0   s3  13.4  0.83
NaN    NaN   NaN   NaN
NaN    NaN   NaN   NaN
NaN    NaN   NaN   NaN
NaN    NaN   NaN   NaN
NaN    NaN   NaN   NaN
NaN    NaN   NaN   NaN
NaN    NaN   NaN   NaN
NaN    NaN   NaN   NaN
NaN    NaN   NaN   NaN
NaN    NaN   NaN   NaN
NaN    NaN   NaN   NaN
NaN    NaN   NaN   NaN
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 读取只带有索引或列名的CSV文件</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.read_csv(<span class="string">&#x27;/home/mw/input/pythonbook7300/pandas_read_noheader.csv&#x27;</span>, header=<span class="literal">None</span>, index_col=<span class="number">0</span>)</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.read_csv(<span class="string">&#x27;/home/mw/input/pythonbook7300/pandas_read_noheader.csv&#x27;</span>, </span><br><span class="line">              names=[<span class="string">&#x27;sta&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;rh&#x27;</span>], </span><br><span class="line">              index_col=<span class="number">0</span>)</span><br><span class="line"><span class="built_in">print</span>(a)</span><br></pre></td></tr></table></figure>

<pre><code>       1    2     3
0                  
s1  21.7  983  0.64
s2  19.2  991  0.75
s3  13.4  973  0.83
        t    p    rh
sta                 
s1   21.7  983  0.64
s2   19.2  991  0.75
s3   13.4  973  0.83
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 读取带有时间列的CSV文件</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.read_csv(<span class="string">&#x27;/home/mw/input/pythonbook7300/pandas_read_date.csv&#x27;</span>, parse_dates=[<span class="number">0</span>])</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;----------&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.dtypes)</span><br><span class="line"><span class="comment"># 直接指定time列为索引</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.read_csv(<span class="string">&#x27;/home/mw/input/pythonbook7300/pandas_read_date.csv&#x27;</span>, parse_dates=[<span class="number">0</span>], index_col=<span class="number">0</span>)</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="comment"># 当时间列为多列时</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.read_csv(<span class="string">&#x27;/home/mw/input/pythonbook7300/pandas_read_datetime.csv&#x27;</span>, </span><br><span class="line">              parse_dates=[[<span class="number">0</span>, <span class="number">1</span>]], </span><br><span class="line">              index_col=<span class="number">0</span>)</span><br><span class="line"><span class="built_in">print</span>(a)</span><br></pre></td></tr></table></figure>

<pre><code>        time     t    p    rh
0 2020-02-25  21.7  983  0.64
1 2020-02-26  19.2  991  0.75
2 2020-02-27  13.4  973  0.83
----------
time    datetime64[ns]
t              float64
p                int64
rh             float64
dtype: object
               t    p    rh
time                       
2020-02-25  21.7  983  0.64
2020-02-26  19.2  991  0.75
2020-02-27  13.4  973  0.83
               t    p    rh
date_time                  
2020-02-25  21.7  983  0.64
2020-02-26  19.2  991  0.75
2020-02-27  13.4  973  0.83
</code></pre>
<h3 id="4-3-4-pd-DataFrame的算术运算"><a href="#4-3-4-pd-DataFrame的算术运算" class="headerlink" title="4.3.4  pd.DataFrame的算术运算"></a>4.3.4  pd.DataFrame的算术运算</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># pd.DataFrame与标量的算术运算</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.DataFrame([[<span class="number">21.7</span>, <span class="number">983</span>, <span class="number">0.64</span>],</span><br><span class="line">               [<span class="number">19.2</span>, <span class="number">991</span>, <span class="number">0.75</span>],</span><br><span class="line">               [<span class="number">13.4</span>, <span class="number">973</span>, <span class="number">0.83</span>]],</span><br><span class="line">              index=[<span class="string">&#x27;s1&#x27;</span>, <span class="string">&#x27;s2&#x27;</span>, <span class="string">&#x27;s3&#x27;</span>],</span><br><span class="line">              columns=[<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;rh&#x27;</span>]</span><br><span class="line">             )</span><br><span class="line"><span class="built_in">print</span>(a+<span class="number">100</span>)</span><br></pre></td></tr></table></figure>

<pre><code>        t     p      rh
s1  121.7  1083  100.64
s2  119.2  1091  100.75
s3  113.4  1073  100.83
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># pd.DataFrame的赋值修改</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.DataFrame([[<span class="number">21.7</span>, <span class="number">983</span>, <span class="number">0.64</span>],</span><br><span class="line">               [<span class="number">19.2</span>, <span class="number">991</span>, <span class="number">0.75</span>],</span><br><span class="line">               [<span class="number">13.4</span>, <span class="number">973</span>, <span class="number">0.83</span>]],</span><br><span class="line">              index=[<span class="string">&#x27;s1&#x27;</span>, <span class="string">&#x27;s2&#x27;</span>, <span class="string">&#x27;s3&#x27;</span>],</span><br><span class="line">              columns=[<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;rh&#x27;</span>]</span><br><span class="line">             )</span><br><span class="line">a[<span class="string">&#x27;rh&#x27;</span>] = a[<span class="string">&#x27;rh&#x27;</span>] * <span class="number">100</span></span><br><span class="line"><span class="built_in">print</span>(a)</span><br></pre></td></tr></table></figure>

<pre><code>       t    p    rh
s1  21.7  983  64.0
s2  19.2  991  75.0
s3  13.4  973  83.0
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># pd.DataFrame与pd.Series的算术运算</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.DataFrame([[<span class="number">21.7</span>, <span class="number">983</span>, <span class="number">0.64</span>],</span><br><span class="line">               [<span class="number">19.2</span>, <span class="number">991</span>, <span class="number">0.75</span>],</span><br><span class="line">               [<span class="number">13.4</span>, <span class="number">973</span>, <span class="number">0.83</span>]],</span><br><span class="line">              index=[<span class="string">&#x27;s1&#x27;</span>, <span class="string">&#x27;s2&#x27;</span>, <span class="string">&#x27;s3&#x27;</span>],</span><br><span class="line">              columns=[<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;rh&#x27;</span>]</span><br><span class="line">             )</span><br><span class="line">b = pd.Series([<span class="number">10</span>, -<span class="number">100</span>, <span class="number">0</span>], index=[<span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;rh&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(a + b)</span><br></pre></td></tr></table></figure>

<pre><code>       p    rh     t
s1   993  0.64 -78.3
s2  1001  0.75 -80.8
s3   983  0.83 -86.6
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># pd.DataFrame与pd.DataFrame的算术运算</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.DataFrame([[<span class="number">21.7</span>, <span class="number">983</span>, <span class="number">0.64</span>],</span><br><span class="line">               [<span class="number">19.2</span>, <span class="number">991</span>, <span class="number">0.75</span>],</span><br><span class="line">               [<span class="number">13.4</span>, <span class="number">973</span>, <span class="number">0.83</span>]],</span><br><span class="line">              index=[<span class="string">&#x27;s1&#x27;</span>, <span class="string">&#x27;s2&#x27;</span>, <span class="string">&#x27;s3&#x27;</span>],</span><br><span class="line">              columns=[<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;rh&#x27;</span>]</span><br><span class="line">             )</span><br><span class="line">b = pd.DataFrame([[<span class="number">20</span>, -<span class="number">14</span>, -<span class="number">0.25</span>],</span><br><span class="line">               [<span class="number">10</span>, -<span class="number">5</span>, -<span class="number">0.14</span>],</span><br><span class="line">               [<span class="number">17</span>, -<span class="number">3</span>, -<span class="number">0.33</span>]],</span><br><span class="line">              index=[<span class="string">&#x27;s2&#x27;</span>, <span class="string">&#x27;s1&#x27;</span>, <span class="string">&#x27;s3&#x27;</span>],</span><br><span class="line">              columns=[<span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;rh&#x27;</span>]</span><br><span class="line">             )</span><br><span class="line"><span class="built_in">print</span>(a + b)</span><br></pre></td></tr></table></figure>

<pre><code>       p   rh     t
s1   993  0.5  16.7
s2  1011  0.5   5.2
s3   990  0.5  10.4
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 按数据条件提取满足条件的行</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.DataFrame([[<span class="number">21.7</span>, <span class="number">983</span>, <span class="number">0.64</span>],</span><br><span class="line">               [<span class="number">19.2</span>, <span class="number">991</span>, <span class="number">0.75</span>],</span><br><span class="line">               [<span class="number">13.4</span>, <span class="number">973</span>, <span class="number">0.83</span>]],</span><br><span class="line">              index=[<span class="string">&#x27;s1&#x27;</span>, <span class="string">&#x27;s2&#x27;</span>, <span class="string">&#x27;s3&#x27;</span>],</span><br><span class="line">              columns=[<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;rh&#x27;</span>]</span><br><span class="line">             )</span><br><span class="line">b = a[a[<span class="string">&#x27;t&#x27;</span>]&lt;<span class="number">20</span>]</span><br><span class="line"><span class="built_in">print</span>(b)</span><br></pre></td></tr></table></figure>

<pre><code>       t    p    rh
s2  19.2  991  0.75
s3  13.4  973  0.83
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 按多个数据条件提取满足条件的行</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.DataFrame([[<span class="number">21.7</span>, <span class="number">983</span>, <span class="number">0.64</span>],</span><br><span class="line">               [<span class="number">19.2</span>, <span class="number">991</span>, <span class="number">0.75</span>],</span><br><span class="line">               [<span class="number">13.4</span>, <span class="number">973</span>, <span class="number">0.83</span>]],</span><br><span class="line">              index=[<span class="string">&#x27;s1&#x27;</span>, <span class="string">&#x27;s2&#x27;</span>, <span class="string">&#x27;s3&#x27;</span>],</span><br><span class="line">              columns=[<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;rh&#x27;</span>]</span><br><span class="line">             )</span><br><span class="line">b = a[(a[<span class="string">&#x27;t&#x27;</span>]&lt;<span class="number">20</span>)&amp;(a[<span class="string">&#x27;rh&#x27;</span>]&gt;<span class="number">0.8</span>)]</span><br><span class="line"><span class="built_in">print</span>(b)</span><br><span class="line">b = a[(a[<span class="string">&#x27;t&#x27;</span>]&lt;<span class="number">19</span>)|(a[<span class="string">&#x27;rh&#x27;</span>]&lt;<span class="number">0.7</span>)]</span><br><span class="line"><span class="built_in">print</span>(b)</span><br></pre></td></tr></table></figure>

<pre><code>       t    p    rh
s3  13.4  973  0.83
       t    p    rh
s1  21.7  983  0.64
s3  13.4  973  0.83
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 按照时间索引条件提取</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.DataFrame([[<span class="number">21.7</span>, <span class="number">983</span>, <span class="number">0.64</span>],</span><br><span class="line">               [<span class="number">19.2</span>, <span class="number">991</span>, <span class="number">0.75</span>],</span><br><span class="line">               [<span class="number">13.4</span>, <span class="number">973</span>, <span class="number">0.83</span>]],</span><br><span class="line">              index=pd.to_datetime([<span class="string">&#x27;2020-02-19&#x27;</span>, <span class="string">&#x27;2020-02-20&#x27;</span>, <span class="string">&#x27;2020-02-22&#x27;</span>]),</span><br><span class="line">              columns=[<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;rh&#x27;</span>]</span><br><span class="line">             )</span><br><span class="line">b = a[a.index.day == <span class="number">19</span>]</span><br><span class="line"><span class="built_in">print</span>(b)</span><br><span class="line">b = a[a.index.month == <span class="number">2</span>]</span><br><span class="line"><span class="built_in">print</span>(b)</span><br><span class="line">b = a[a.index.year == <span class="number">2020</span>]</span><br><span class="line"><span class="built_in">print</span>(b)</span><br></pre></td></tr></table></figure>

<pre><code>               t    p    rh
2020-02-19  21.7  983  0.64
               t    p    rh
2020-02-19  21.7  983  0.64
2020-02-20  19.2  991  0.75
2020-02-22  13.4  973  0.83
               t    p    rh
2020-02-19  21.7  983  0.64
2020-02-20  19.2  991  0.75
2020-02-22  13.4  973  0.83
</code></pre>
<h3 id="4-3-6-pd-DataFrame的常用属性"><a href="#4-3-6-pd-DataFrame的常用属性" class="headerlink" title="4.3.6  pd.DataFrame的常用属性"></a>4.3.6  pd.DataFrame的常用属性</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看常用属性</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.DataFrame([[<span class="number">21.7</span>, <span class="number">983</span>, <span class="number">0.64</span>],</span><br><span class="line">               [<span class="number">19.2</span>, <span class="number">991</span>, <span class="number">0.75</span>],</span><br><span class="line">               [<span class="number">13.4</span>, <span class="number">973</span>, <span class="number">0.83</span>]],</span><br><span class="line">              index=[<span class="string">&#x27;s1&#x27;</span>, <span class="string">&#x27;s2&#x27;</span>, <span class="string">&#x27;s3&#x27;</span>],</span><br><span class="line">              columns=[<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;rh&#x27;</span>]</span><br><span class="line">             )</span><br><span class="line"><span class="built_in">print</span>(a.dtypes)</span><br><span class="line"><span class="built_in">print</span>(a.ndim)</span><br><span class="line"><span class="built_in">print</span>(a.shape)</span><br></pre></td></tr></table></figure>

<pre><code>t     float64
p       int64
rh    float64
dtype: object
2
(3, 3)
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 通过行、列标签访问单个元素</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.DataFrame([[<span class="number">21.7</span>, <span class="number">983</span>, <span class="number">0.64</span>],</span><br><span class="line">               [<span class="number">19.2</span>, <span class="number">991</span>, <span class="number">0.75</span>],</span><br><span class="line">               [<span class="number">13.4</span>, <span class="number">973</span>, <span class="number">0.83</span>]],</span><br><span class="line">              index=[<span class="string">&#x27;s1&#x27;</span>, <span class="string">&#x27;s2&#x27;</span>, <span class="string">&#x27;s3&#x27;</span>],</span><br><span class="line">              columns=[<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;rh&#x27;</span>]</span><br><span class="line">             )</span><br><span class="line"><span class="built_in">print</span>(a.at[<span class="string">&#x27;s1&#x27;</span>, <span class="string">&#x27;t&#x27;</span>])</span><br></pre></td></tr></table></figure>

<pre><code>21.7
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 通过行、列位置访问单个元素</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.DataFrame([[<span class="number">21.7</span>, <span class="number">983</span>, <span class="number">0.64</span>],</span><br><span class="line">               [<span class="number">19.2</span>, <span class="number">991</span>, <span class="number">0.75</span>],</span><br><span class="line">               [<span class="number">13.4</span>, <span class="number">973</span>, <span class="number">0.83</span>]],</span><br><span class="line">              index=[<span class="string">&#x27;s1&#x27;</span>, <span class="string">&#x27;s2&#x27;</span>, <span class="string">&#x27;s3&#x27;</span>],</span><br><span class="line">              columns=[<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;rh&#x27;</span>]</span><br><span class="line">             )</span><br><span class="line"><span class="built_in">print</span>(a.iat[<span class="number">0</span>, <span class="number">0</span>])</span><br></pre></td></tr></table></figure>

<pre><code>21.7
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 通过行、列标签或布尔序列访问多个元素</span></span><br><span class="line"><span class="comment"># 按标签访问行</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.DataFrame([[<span class="number">21.7</span>, <span class="number">983</span>, <span class="number">0.64</span>],</span><br><span class="line">               [<span class="number">19.2</span>, <span class="number">991</span>, <span class="number">0.75</span>],</span><br><span class="line">               [<span class="number">13.4</span>, <span class="number">973</span>, <span class="number">0.83</span>]],</span><br><span class="line">              index=[<span class="string">&#x27;s1&#x27;</span>, <span class="string">&#x27;s2&#x27;</span>, <span class="string">&#x27;s3&#x27;</span>],</span><br><span class="line">              columns=[<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;rh&#x27;</span>]</span><br><span class="line">             )</span><br><span class="line"><span class="built_in">print</span>(a.loc[<span class="string">&#x27;s1&#x27;</span>]) <span class="comment"># Series</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;----------&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.loc[[<span class="string">&#x27;s1&#x27;</span>]]) <span class="comment"># DataFrame</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*-*-*-*-*-&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.loc[[<span class="string">&#x27;s1&#x27;</span>, <span class="string">&#x27;s3&#x27;</span>]]) <span class="comment"># DataFrame</span></span><br></pre></td></tr></table></figure>

<pre><code>t      21.70
p     983.00
rh      0.64
Name: s1, dtype: float64
----------
       t    p    rh
s1  21.7  983  0.64
*-*-*-*-*-
       t    p    rh
s1  21.7  983  0.64
s3  13.4  973  0.83
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 通过行、列标签或布尔序列访问多个元素</span></span><br><span class="line"><span class="comment"># 按标签访问行</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.DataFrame([[<span class="number">21.7</span>, <span class="number">983</span>, <span class="number">0.64</span>],</span><br><span class="line">               [<span class="number">19.2</span>, <span class="number">991</span>, <span class="number">0.75</span>],</span><br><span class="line">               [<span class="number">13.4</span>, <span class="number">973</span>, <span class="number">0.83</span>]],</span><br><span class="line">              index=[<span class="string">&#x27;s1&#x27;</span>, <span class="string">&#x27;s2&#x27;</span>, <span class="string">&#x27;s3&#x27;</span>],</span><br><span class="line">              columns=[<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;rh&#x27;</span>]</span><br><span class="line">             )</span><br><span class="line"><span class="built_in">print</span>(a.loc[:, <span class="string">&#x27;t&#x27;</span>]) <span class="comment"># Series</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;----------&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.loc[:, [<span class="string">&#x27;t&#x27;</span>]]) <span class="comment"># DataFrame</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*-*-*-*-*-&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.loc[:, [<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;rh&#x27;</span>]]) <span class="comment"># DataFrame</span></span><br></pre></td></tr></table></figure>

<pre><code>s1    21.7
s2    19.2
s3    13.4
Name: t, dtype: float64
----------
       t
s1  21.7
s2  19.2
s3  13.4
*-*-*-*-*-
       t    rh
s1  21.7  0.64
s2  19.2  0.75
s3  13.4  0.83
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 通过行、列标签或布尔序列访问多个元素</span></span><br><span class="line"><span class="comment"># 按布尔序列访问行、列</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.DataFrame([[<span class="number">21.7</span>, <span class="number">983</span>, <span class="number">0.64</span>],</span><br><span class="line">               [<span class="number">19.2</span>, <span class="number">991</span>, <span class="number">0.75</span>],</span><br><span class="line">               [<span class="number">13.4</span>, <span class="number">973</span>, <span class="number">0.83</span>]],</span><br><span class="line">              index=[<span class="string">&#x27;s1&#x27;</span>, <span class="string">&#x27;s2&#x27;</span>, <span class="string">&#x27;s3&#x27;</span>],</span><br><span class="line">              columns=[<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;rh&#x27;</span>]</span><br><span class="line">             )</span><br><span class="line"><span class="built_in">print</span>(a.loc[[<span class="literal">True</span>, <span class="literal">False</span>, <span class="literal">True</span>]]) <span class="comment"># 行</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;----------&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.loc[:, [<span class="literal">True</span>, <span class="literal">False</span>, <span class="literal">True</span>]]) <span class="comment"># 列</span></span><br></pre></td></tr></table></figure>

<pre><code>       t    p    rh
s1  21.7  983  0.64
s3  13.4  973  0.83
----------
       t    rh
s1  21.7  0.64
s2  19.2  0.75
s3  13.4  0.83
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 通过行、列位置访问多个元素</span></span><br><span class="line"><span class="comment"># 按位置访问行</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.DataFrame([[<span class="number">21.7</span>, <span class="number">983</span>, <span class="number">0.64</span>],</span><br><span class="line">               [<span class="number">19.2</span>, <span class="number">991</span>, <span class="number">0.75</span>],</span><br><span class="line">               [<span class="number">13.4</span>, <span class="number">973</span>, <span class="number">0.83</span>]],</span><br><span class="line">              index=[<span class="string">&#x27;s1&#x27;</span>, <span class="string">&#x27;s2&#x27;</span>, <span class="string">&#x27;s3&#x27;</span>],</span><br><span class="line">              columns=[<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;rh&#x27;</span>]</span><br><span class="line">             )</span><br><span class="line"><span class="built_in">print</span>(a.iloc[<span class="number">0</span>]) <span class="comment"># Series</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;----------&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.iloc[[<span class="number">0</span>]]) <span class="comment"># DataFrame</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*-*-*-*-*-&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.iloc[[<span class="number">0</span>, <span class="number">2</span>]]) <span class="comment"># DataFrame</span></span><br></pre></td></tr></table></figure>

<pre><code>t      21.70
p     983.00
rh      0.64
Name: s1, dtype: float64
----------
       t    p    rh
s1  21.7  983  0.64
*-*-*-*-*-
       t    p    rh
s1  21.7  983  0.64
s3  13.4  973  0.83
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 通过行、列位置访问多个元素</span></span><br><span class="line"><span class="comment"># 按位置访问列</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.DataFrame([[<span class="number">21.7</span>, <span class="number">983</span>, <span class="number">0.64</span>],</span><br><span class="line">               [<span class="number">19.2</span>, <span class="number">991</span>, <span class="number">0.75</span>],</span><br><span class="line">               [<span class="number">13.4</span>, <span class="number">973</span>, <span class="number">0.83</span>]],</span><br><span class="line">              index=[<span class="string">&#x27;s1&#x27;</span>, <span class="string">&#x27;s2&#x27;</span>, <span class="string">&#x27;s3&#x27;</span>],</span><br><span class="line">              columns=[<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;rh&#x27;</span>]</span><br><span class="line">             )</span><br><span class="line"><span class="built_in">print</span>(a.iloc[:, <span class="number">0</span>]) <span class="comment"># Series</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;----------&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.iloc[:, [<span class="number">0</span>]]) <span class="comment"># DataFrame</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*-*-*-*-*-&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.iloc[:, [<span class="number">0</span>, <span class="number">2</span>]]) <span class="comment"># DataFrame</span></span><br></pre></td></tr></table></figure>

<pre><code>s1    21.7
s2    19.2
s3    13.4
Name: t, dtype: float64
----------
       t
s1  21.7
s2  19.2
s3  13.4
*-*-*-*-*-
       t    rh
s1  21.7  0.64
s2  19.2  0.75
s3  13.4  0.83
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获取数据原始的np.ndarray对象</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.DataFrame([[<span class="number">21.7</span>, <span class="number">983</span>, <span class="number">0.64</span>],</span><br><span class="line">               [<span class="number">19.2</span>, <span class="number">991</span>, <span class="number">0.75</span>],</span><br><span class="line">               [<span class="number">13.4</span>, <span class="number">973</span>, <span class="number">0.83</span>]],</span><br><span class="line">              index=[<span class="string">&#x27;s1&#x27;</span>, <span class="string">&#x27;s2&#x27;</span>, <span class="string">&#x27;s3&#x27;</span>],</span><br><span class="line">              columns=[<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;rh&#x27;</span>]</span><br><span class="line">             )</span><br><span class="line">b = a.values</span><br><span class="line"><span class="built_in">print</span>(b)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(b))</span><br></pre></td></tr></table></figure>

<pre><code>[[2.17e+01 9.83e+02 6.40e-01]
 [1.92e+01 9.91e+02 7.50e-01]
 [1.34e+01 9.73e+02 8.30e-01]]
&lt;class &#39;numpy.ndarray&#39;&gt;
</code></pre>
<h3 id="4-3-7-pd-DataFrame的常用方法"><a href="#4-3-7-pd-DataFrame的常用方法" class="headerlink" title="4.3.7  pd.DataFrame的常用方法"></a>4.3.7  pd.DataFrame的常用方法</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 删除包含NaN的行或列</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.DataFrame([[np.nan, <span class="number">983</span>, <span class="number">0.64</span>],</span><br><span class="line">               [np.nan, np.nan, <span class="number">0.75</span>],</span><br><span class="line">               [<span class="number">13.4</span>, <span class="number">973</span>, <span class="number">0.83</span>]],</span><br><span class="line">              index=[<span class="string">&#x27;s1&#x27;</span>, <span class="string">&#x27;s2&#x27;</span>, <span class="string">&#x27;s3&#x27;</span>],</span><br><span class="line">              columns=[<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;rh&#x27;</span>]</span><br><span class="line">             )</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;------&#x27;</span>)</span><br><span class="line">b = a.dropna() <span class="comment"># 删除包含NaN的行</span></span><br><span class="line"><span class="built_in">print</span>(b)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;-*-*-*-*-&#x27;</span>)</span><br><span class="line">c = a.dropna(axis=<span class="number">1</span>) <span class="comment"># 删除包含NaN的列</span></span><br><span class="line"><span class="built_in">print</span>(c)</span><br></pre></td></tr></table></figure>

<pre><code>       t      p    rh
s1   NaN  983.0  0.64
s2   NaN    NaN  0.75
s3  13.4  973.0  0.83
------
       t      p    rh
s3  13.4  973.0  0.83
-*-*-*-*-
      rh
s1  0.64
s2  0.75
s3  0.83
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 仅删除全为NaN的行或列</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.DataFrame([[np.nan, <span class="number">983</span>, <span class="number">0.64</span>],</span><br><span class="line">               [np.nan, np.nan, np.nan],</span><br><span class="line">               [np.nan, <span class="number">973</span>, <span class="number">0.83</span>]],</span><br><span class="line">              index=[<span class="string">&#x27;s1&#x27;</span>, <span class="string">&#x27;s2&#x27;</span>, <span class="string">&#x27;s3&#x27;</span>],</span><br><span class="line">              columns=[<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;rh&#x27;</span>]</span><br><span class="line">             )</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;------&#x27;</span>)</span><br><span class="line">b = a.dropna(how=<span class="string">&#x27;all&#x27;</span>) <span class="comment"># 删除全为NaN的行</span></span><br><span class="line"><span class="built_in">print</span>(b)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;-*-*-*-*-&#x27;</span>)</span><br><span class="line">c = a.dropna(axis=<span class="number">1</span>, how=<span class="string">&#x27;all&#x27;</span>) <span class="comment"># 删除全为NaN的列</span></span><br><span class="line"><span class="built_in">print</span>(c)</span><br></pre></td></tr></table></figure>

<pre><code>     t      p    rh
s1 NaN  983.0  0.64
s2 NaN    NaN   NaN
s3 NaN  973.0  0.83
------
     t      p    rh
s1 NaN  983.0  0.64
s3 NaN  973.0  0.83
-*-*-*-*-
        p    rh
s1  983.0  0.64
s2    NaN   NaN
s3  973.0  0.83
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 通过原始数据分组</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.DataFrame([[<span class="number">21.7</span>, <span class="number">983</span>, <span class="number">0.64</span>, <span class="string">&#x27;a&#x27;</span>],</span><br><span class="line">               [<span class="number">19.2</span>, <span class="number">991</span>, <span class="number">0.75</span>, <span class="string">&#x27;b&#x27;</span>],</span><br><span class="line">               [<span class="number">13.4</span>, <span class="number">973</span>, <span class="number">0.83</span>, <span class="string">&#x27;a&#x27;</span>],</span><br><span class="line">               [<span class="number">13.4</span>, <span class="number">973</span>, <span class="number">0.83</span>, <span class="string">&#x27;b&#x27;</span>]],</span><br><span class="line">              index=[<span class="string">&#x27;s1&#x27;</span>, <span class="string">&#x27;s2&#x27;</span>, <span class="string">&#x27;s3&#x27;</span>, <span class="string">&#x27;s2&#x27;</span>],</span><br><span class="line">              columns=[<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;rh&#x27;</span>, <span class="string">&#x27;kind&#x27;</span>]</span><br><span class="line">             )</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;--------&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.groupby(level=<span class="number">0</span>).<span class="built_in">sum</span>())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;-*-*-*-*-*&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.groupby(level=<span class="number">0</span>).size())</span><br></pre></td></tr></table></figure>

<pre><code>       t    p    rh kind
s1  21.7  983  0.64    a
s2  19.2  991  0.75    b
s3  13.4  973  0.83    a
s2  13.4  973  0.83    b
--------
       t     p    rh
s1  21.7   983  0.64
s2  32.6  1964  1.58
s3  13.4   973  0.83
-*-*-*-*-*
s1    1
s2    2
s3    1
dtype: int64
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 指定列名通过数据分组</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.DataFrame([[<span class="number">21.7</span>, <span class="number">983</span>, <span class="number">0.64</span>, <span class="string">&#x27;a&#x27;</span>],</span><br><span class="line">               [<span class="number">19.2</span>, <span class="number">991</span>, <span class="number">0.75</span>, <span class="string">&#x27;b&#x27;</span>],</span><br><span class="line">               [<span class="number">13.4</span>, <span class="number">973</span>, <span class="number">0.83</span>, <span class="string">&#x27;a&#x27;</span>],</span><br><span class="line">               [<span class="number">13.4</span>, <span class="number">973</span>, <span class="number">0.83</span>, <span class="string">&#x27;b&#x27;</span>]],</span><br><span class="line">              index=[<span class="string">&#x27;s1&#x27;</span>, <span class="string">&#x27;s2&#x27;</span>, <span class="string">&#x27;s3&#x27;</span>, <span class="string">&#x27;s2&#x27;</span>],</span><br><span class="line">              columns=[<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;rh&#x27;</span>, <span class="string">&#x27;kind&#x27;</span>]</span><br><span class="line">             )</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;--------&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.groupby(by=<span class="string">&#x27;kind&#x27;</span>).<span class="built_in">sum</span>())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;-*-*-*-*-*&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.groupby(by=<span class="string">&#x27;kind&#x27;</span>).size())</span><br></pre></td></tr></table></figure>

<pre><code>       t    p    rh kind
s1  21.7  983  0.64    a
s2  19.2  991  0.75    b
s3  13.4  973  0.83    a
s2  13.4  973  0.83    b
--------
         t     p    rh
kind                  
a     35.1  1956  1.47
b     32.6  1964  1.58
-*-*-*-*-*
kind
a    2
b    2
dtype: int64
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 通过函数分组</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.DataFrame([[<span class="number">21.7</span>, <span class="number">983</span>, <span class="number">0.64</span>, <span class="string">&#x27;a&#x27;</span>],</span><br><span class="line">               [<span class="number">19.2</span>, <span class="number">991</span>, <span class="number">0.75</span>, <span class="string">&#x27;b&#x27;</span>],</span><br><span class="line">               [<span class="number">13.4</span>, <span class="number">973</span>, <span class="number">0.83</span>, <span class="string">&#x27;a&#x27;</span>],</span><br><span class="line">               [<span class="number">13.4</span>, <span class="number">973</span>, <span class="number">0.83</span>, <span class="string">&#x27;b&#x27;</span>]],</span><br><span class="line">              index=[<span class="string">&#x27;s1&#x27;</span>, <span class="string">&#x27;s2&#x27;</span>, <span class="string">&#x27;s3&#x27;</span>, <span class="string">&#x27;s2&#x27;</span>],</span><br><span class="line">              columns=[<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;rh&#x27;</span>, <span class="string">&#x27;kind&#x27;</span>]</span><br><span class="line">             )</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;--------&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.groupby(by=<span class="keyword">lambda</span> x:x==<span class="string">&#x27;s2&#x27;</span>).<span class="built_in">sum</span>())</span><br></pre></td></tr></table></figure>

<pre><code>       t    p    rh kind
s1  21.7  983  0.64    a
s2  19.2  991  0.75    b
s3  13.4  973  0.83    a
s2  13.4  973  0.83    b
--------
          t     p    rh
False  35.1  1956  1.47
True   32.6  1964  1.58
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 对时间戳类型的索引进行分组</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.DataFrame([[<span class="number">21.7</span>, <span class="number">983</span>, <span class="number">0.64</span>],</span><br><span class="line">               [<span class="number">19.2</span>, <span class="number">991</span>, <span class="number">0.75</span>],</span><br><span class="line">               [<span class="number">13.4</span>, <span class="number">973</span>, <span class="number">0.83</span>]],</span><br><span class="line">              index=pd.to_datetime([<span class="string">&#x27;2020-02-19&#x27;</span>, <span class="string">&#x27;2020-02-20&#x27;</span>, <span class="string">&#x27;2020-03-22&#x27;</span>]),</span><br><span class="line">              columns=[<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;rh&#x27;</span>]</span><br><span class="line">             )</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;--------&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.groupby(by=<span class="keyword">lambda</span> x:x.month).<span class="built_in">sum</span>())</span><br></pre></td></tr></table></figure>

<pre><code>               t    p    rh
2020-02-19  21.7  983  0.64
2020-02-20  19.2  991  0.75
2020-03-22  13.4  973  0.83
--------
      t     p    rh
2  40.9  1974  1.39
3  13.4   973  0.83
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 按规则映射分组</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.DataFrame([[<span class="number">21.7</span>, <span class="number">983</span>, <span class="number">0.64</span>],</span><br><span class="line">               [<span class="number">19.2</span>, <span class="number">991</span>, <span class="number">0.75</span>],</span><br><span class="line">               [<span class="number">13.4</span>, <span class="number">973</span>, <span class="number">0.83</span>]],</span><br><span class="line">              index=[<span class="string">&#x27;s1&#x27;</span>, <span class="string">&#x27;s2&#x27;</span>, <span class="string">&#x27;s3&#x27;</span>],</span><br><span class="line">              columns=[<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;rh&#x27;</span>]</span><br><span class="line">             )</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;--------&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.applymap(<span class="keyword">lambda</span> x:x/<span class="number">10</span>))</span><br></pre></td></tr></table></figure>

<pre><code>       t    p    rh
s1  21.7  983  0.64
s2  19.2  991  0.75
s3  13.4  973  0.83
--------
       t     p     rh
s1  2.17  98.3  0.064
s2  1.92  99.1  0.075
s3  1.34  97.3  0.083
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 重采样</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.DataFrame([[<span class="number">21.7</span>, <span class="number">983</span>, <span class="number">0.64</span>],</span><br><span class="line">               [<span class="number">19.2</span>, <span class="number">991</span>, <span class="number">0.75</span>],</span><br><span class="line">               [<span class="number">13.4</span>, <span class="number">973</span>, <span class="number">0.83</span>]],</span><br><span class="line">              index=pd.to_datetime([<span class="string">&#x27;2020-02-19&#x27;</span>, <span class="string">&#x27;2020-02-20&#x27;</span>, <span class="string">&#x27;2020-02-22&#x27;</span>]),</span><br><span class="line">              columns=[<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;rh&#x27;</span>]</span><br><span class="line">             )</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;--------&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.resample(<span class="string">&#x27;2D&#x27;</span>).mean())</span><br></pre></td></tr></table></figure>

<pre><code>               t    p    rh
2020-02-19  21.7  983  0.64
2020-02-20  19.2  991  0.75
2020-02-22  13.4  973  0.83
--------
                t      p     rh
2020-02-19  20.45  987.0  0.695
2020-02-21  13.40  973.0  0.830
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 填充NaN</span></span><br><span class="line"><span class="comment"># 通过插值的方式填充</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.DataFrame([[<span class="number">21.7</span>, <span class="number">983</span>, <span class="number">0.64</span>],</span><br><span class="line">               [<span class="number">19.2</span>, np.nan, <span class="number">0.75</span>],</span><br><span class="line">               [<span class="number">13.4</span>, <span class="number">973</span>, <span class="number">0.83</span>]],</span><br><span class="line">              index=[<span class="string">&#x27;s1&#x27;</span>, <span class="string">&#x27;s2&#x27;</span>, <span class="string">&#x27;s3&#x27;</span>],</span><br><span class="line">              columns=[<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;rh&#x27;</span>]</span><br><span class="line">             )</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;--------&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.interpolate(method=<span class="string">&#x27;linear&#x27;</span>)) <span class="comment"># 列向线性插值</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*-*-*-*-*-&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.interpolate(method=<span class="string">&#x27;linear&#x27;</span>, axis=<span class="number">1</span>)) <span class="comment"># 行向线性插值</span></span><br></pre></td></tr></table></figure>

<pre><code>       t      p    rh
s1  21.7  983.0  0.64
s2  19.2    NaN  0.75
s3  13.4  973.0  0.83
--------
       t      p    rh
s1  21.7  983.0  0.64
s2  19.2  978.0  0.75
s3  13.4  973.0  0.83
*-*-*-*-*-
       t        p    rh
s1  21.7  983.000  0.64
s2  19.2    9.975  0.75
s3  13.4  973.000  0.83
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 用指定值填充或根据行或列的前后值填充</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.DataFrame([[<span class="number">21.7</span>, <span class="number">983</span>, <span class="number">0.64</span>],</span><br><span class="line">               [<span class="number">19.2</span>, np.nan, <span class="number">0.75</span>],</span><br><span class="line">               [<span class="number">13.4</span>, <span class="number">973</span>, <span class="number">0.83</span>]],</span><br><span class="line">              index=[<span class="string">&#x27;s1&#x27;</span>, <span class="string">&#x27;s2&#x27;</span>, <span class="string">&#x27;s3&#x27;</span>],</span><br><span class="line">              columns=[<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;rh&#x27;</span>]</span><br><span class="line">             )</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;--------&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.fillna(<span class="number">9999</span>)) <span class="comment"># 用值填充</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*-*-*-*-*-&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.fillna(method=<span class="string">&#x27;bfill&#x27;</span>)) <span class="comment"># 列向后值填充</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;**********&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.fillna(method=<span class="string">&#x27;ffill&#x27;</span>)) <span class="comment"># 列向前值填充</span></span><br></pre></td></tr></table></figure>

<pre><code>       t      p    rh
s1  21.7  983.0  0.64
s2  19.2    NaN  0.75
s3  13.4  973.0  0.83
--------
       t       p    rh
s1  21.7   983.0  0.64
s2  19.2  9999.0  0.75
s3  13.4   973.0  0.83
*-*-*-*-*-
       t      p    rh
s1  21.7  983.0  0.64
s2  19.2  973.0  0.75
s3  13.4  973.0  0.83
**********
       t      p    rh
s1  21.7  983.0  0.64
s2  19.2  983.0  0.75
s3  13.4  973.0  0.83
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 根据行的前后值进行填充</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.DataFrame([[<span class="number">21.7</span>, <span class="number">983</span>, <span class="number">0.64</span>],</span><br><span class="line">               [<span class="number">19.2</span>, np.nan, <span class="number">0.75</span>],</span><br><span class="line">               [<span class="number">13.4</span>, <span class="number">973</span>, <span class="number">0.83</span>]],</span><br><span class="line">              index=[<span class="string">&#x27;s1&#x27;</span>, <span class="string">&#x27;s2&#x27;</span>, <span class="string">&#x27;s3&#x27;</span>],</span><br><span class="line">              columns=[<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;rh&#x27;</span>]</span><br><span class="line">             )</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;--------&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.fillna(method=<span class="string">&#x27;bfill&#x27;</span>, axis=<span class="number">1</span>)) <span class="comment"># 行向后值填充</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*-*-*-*-*-&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.fillna(method=<span class="string">&#x27;ffill&#x27;</span>, axis=<span class="number">1</span>)) <span class="comment"># 行向前值填充</span></span><br></pre></td></tr></table></figure>

<pre><code>       t      p    rh
s1  21.7  983.0  0.64
s2  19.2    NaN  0.75
s3  13.4  973.0  0.83
--------
       t       p    rh
s1  21.7  983.00  0.64
s2  19.2    0.75  0.75
s3  13.4  973.00  0.83
*-*-*-*-*-
       t      p    rh
s1  21.7  983.0  0.64
s2  19.2   19.2  0.75
s3  13.4  973.0  0.83
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 按照指定序列/索引和列名排序</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.DataFrame([[<span class="number">21.7</span>, <span class="number">983</span>, <span class="number">0.64</span>],</span><br><span class="line">               [<span class="number">19.2</span>, <span class="number">991</span>, <span class="number">0.75</span>],</span><br><span class="line">               [<span class="number">13.4</span>, <span class="number">973</span>, <span class="number">0.83</span>]],</span><br><span class="line">              index=[<span class="string">&#x27;s1&#x27;</span>, <span class="string">&#x27;s2&#x27;</span>, <span class="string">&#x27;s3&#x27;</span>],</span><br><span class="line">              columns=[<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;rh&#x27;</span>]</span><br><span class="line">             )</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;--------&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.reindex([<span class="string">&#x27;s2&#x27;</span>, <span class="string">&#x27;s3&#x27;</span>, <span class="string">&#x27;s1&#x27;</span>]))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*-*-*-*-*-&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.reindex(index=[<span class="string">&#x27;s2&#x27;</span>, <span class="string">&#x27;s3&#x27;</span>, <span class="string">&#x27;s1&#x27;</span>], columns=[<span class="string">&#x27;rh&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;p&#x27;</span>]))</span><br></pre></td></tr></table></figure>

<pre><code>       t    p    rh
s1  21.7  983  0.64
s2  19.2  991  0.75
s3  13.4  973  0.83
--------
       t    p    rh
s2  19.2  991  0.75
s3  13.4  973  0.83
s1  21.7  983  0.64
*-*-*-*-*-
      rh     t    p
s2  0.75  19.2  991
s3  0.83  13.4  973
s1  0.64  21.7  983
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 按照已有DataFrame对象的索引和列名排序</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.DataFrame([[<span class="number">21.7</span>, <span class="number">983</span>, <span class="number">0.64</span>],</span><br><span class="line">               [<span class="number">19.2</span>, <span class="number">991</span>, <span class="number">0.75</span>],</span><br><span class="line">               [<span class="number">13.4</span>, <span class="number">973</span>, <span class="number">0.83</span>]],</span><br><span class="line">              index=[<span class="string">&#x27;s1&#x27;</span>, <span class="string">&#x27;s2&#x27;</span>, <span class="string">&#x27;s3&#x27;</span>],</span><br><span class="line">              columns=[<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;rh&#x27;</span>]</span><br><span class="line">             )</span><br><span class="line">b = pd.DataFrame(data=<span class="literal">None</span>, index=[<span class="string">&#x27;s2&#x27;</span>, <span class="string">&#x27;s1&#x27;</span>, <span class="string">&#x27;s3&#x27;</span>], columns=[<span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;rh&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;--------&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.reindex_like(b))</span><br></pre></td></tr></table></figure>

<pre><code>       t    p    rh
s1  21.7  983  0.64
s2  19.2  991  0.75
s3  13.4  973  0.83
--------
      p     t    rh
s2  991  19.2  0.75
s1  983  21.7  0.64
s3  973  13.4  0.83
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 重置索引</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.DataFrame([[<span class="number">21.7</span>, <span class="number">983</span>, <span class="number">0.64</span>],</span><br><span class="line">               [<span class="number">19.2</span>, <span class="number">991</span>, <span class="number">0.75</span>],</span><br><span class="line">               [<span class="number">13.4</span>, <span class="number">973</span>, <span class="number">0.83</span>],</span><br><span class="line">               [<span class="number">12.4</span>, <span class="number">963</span>, <span class="number">0.73</span>]],</span><br><span class="line">              index=[<span class="string">&#x27;s1&#x27;</span>, <span class="string">&#x27;s2&#x27;</span>, <span class="string">&#x27;s3&#x27;</span>, <span class="string">&#x27;s4&#x27;</span>],</span><br><span class="line">              columns=[<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;rh&#x27;</span>]</span><br><span class="line">             )</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;--------&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.reset_index())</span><br></pre></td></tr></table></figure>

<pre><code>       t    p    rh
s1  21.7  983  0.64
s2  19.2  991  0.75
s3  13.4  973  0.83
s4  12.4  963  0.73
--------
  index     t    p    rh
0    s1  21.7  983  0.64
1    s2  19.2  991  0.75
2    s3  13.4  973  0.83
3    s4  12.4  963  0.73
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 滑动窗口计算</span></span><br><span class="line"><span class="comment"># 对普通序列进行滑动计算</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.DataFrame([[<span class="number">21.7</span>, <span class="number">983</span>, <span class="number">0.64</span>],</span><br><span class="line">               [<span class="number">19.2</span>, <span class="number">991</span>, <span class="number">0.75</span>],</span><br><span class="line">               [<span class="number">13.4</span>, <span class="number">973</span>, <span class="number">0.83</span>],</span><br><span class="line">               [<span class="number">12.4</span>, <span class="number">963</span>, <span class="number">0.73</span>]],</span><br><span class="line">              index=[<span class="string">&#x27;s1&#x27;</span>, <span class="string">&#x27;s2&#x27;</span>, <span class="string">&#x27;s3&#x27;</span>, <span class="string">&#x27;s4&#x27;</span>],</span><br><span class="line">              columns=[<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;rh&#x27;</span>]</span><br><span class="line">             )</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;--------&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.rolling(<span class="number">2</span>).mean()) <span class="comment">#此处滑动窗口值为2</span></span><br></pre></td></tr></table></figure>

<pre><code>       t    p    rh
s1  21.7  983  0.64
s2  19.2  991  0.75
s3  13.4  973  0.83
s4  12.4  963  0.73
--------
        t      p     rh
s1    NaN    NaN    NaN
s2  20.45  987.0  0.695
s3  16.30  982.0  0.790
s4  12.90  968.0  0.780
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 滑动窗口计算</span></span><br><span class="line"><span class="comment"># 对时间序列进行滑动计算</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.DataFrame([[<span class="number">21.7</span>, <span class="number">983</span>, <span class="number">0.64</span>],</span><br><span class="line">               [<span class="number">19.2</span>, <span class="number">991</span>, <span class="number">0.75</span>],</span><br><span class="line">               [<span class="number">13.4</span>, <span class="number">973</span>, <span class="number">0.83</span>],</span><br><span class="line">               [<span class="number">12.4</span>, <span class="number">963</span>, <span class="number">0.73</span>]],</span><br><span class="line">              index=pd.to_datetime([<span class="string">&#x27;2020-02-19&#x27;</span>, <span class="string">&#x27;2020-02-20&#x27;</span>,</span><br><span class="line">                                <span class="string">&#x27;2020-02-21&#x27;</span>, <span class="string">&#x27;2020-02-22&#x27;</span>]),</span><br><span class="line">              columns=[<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;rh&#x27;</span>]</span><br><span class="line">             )</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;--------&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.rolling(<span class="string">&#x27;2D&#x27;</span>).mean())</span><br></pre></td></tr></table></figure>

<pre><code>               t    p    rh
2020-02-19  21.7  983  0.64
2020-02-20  19.2  991  0.75
2020-02-21  13.4  973  0.83
2020-02-22  12.4  963  0.73
--------
                t      p     rh
2020-02-19  21.70  983.0  0.640
2020-02-20  20.45  987.0  0.695
2020-02-21  16.30  982.0  0.790
2020-02-22  12.90  968.0  0.780
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 平移数据</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.DataFrame([[<span class="number">21.7</span>, <span class="number">983</span>, <span class="number">0.64</span>],</span><br><span class="line">               [<span class="number">19.2</span>, <span class="number">991</span>, <span class="number">0.75</span>],</span><br><span class="line">               [<span class="number">13.4</span>, <span class="number">973</span>, <span class="number">0.83</span>]],</span><br><span class="line">              index=[<span class="string">&#x27;s1&#x27;</span>, <span class="string">&#x27;s2&#x27;</span>, <span class="string">&#x27;s3&#x27;</span>],</span><br><span class="line">              columns=[<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;rh&#x27;</span>]</span><br><span class="line">             )</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;--------&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.shift(<span class="number">1</span>)) <span class="comment"># 列方向平移</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*-*-*-*-*-&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.shift(<span class="number">1</span>, axis=<span class="number">1</span>)) <span class="comment"># 行方向平移</span></span><br></pre></td></tr></table></figure>

<pre><code>       t    p    rh
s1  21.7  983  0.64
s2  19.2  991  0.75
s3  13.4  973  0.83
--------
       t      p    rh
s1   NaN    NaN   NaN
s2  21.7  983.0  0.64
s3  19.2  991.0  0.75
*-*-*-*-*-
     t     p   rh
s1 NaN  21.7  983
s2 NaN  19.2  991
s3 NaN  13.4  973
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 按照索引排序</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.DataFrame([[<span class="number">21.7</span>, <span class="number">983</span>, <span class="number">0.64</span>],</span><br><span class="line">               [<span class="number">19.2</span>, <span class="number">991</span>, <span class="number">0.75</span>],</span><br><span class="line">               [<span class="number">13.4</span>, <span class="number">973</span>, <span class="number">0.83</span>]],</span><br><span class="line">              index=[<span class="string">&#x27;s2&#x27;</span>, <span class="string">&#x27;s1&#x27;</span>, <span class="string">&#x27;s3&#x27;</span>],</span><br><span class="line">              columns=[<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;rh&#x27;</span>]</span><br><span class="line">             )</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;--------&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.sort_index()) <span class="comment"># 升序排列</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*-*-*-*-*-&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.sort_index(ascending=<span class="literal">False</span>)) <span class="comment"># 降序排列</span></span><br></pre></td></tr></table></figure>

<pre><code>       t    p    rh
s2  21.7  983  0.64
s1  19.2  991  0.75
s3  13.4  973  0.83
--------
       t    p    rh
s1  19.2  991  0.75
s2  21.7  983  0.64
s3  13.4  973  0.83
*-*-*-*-*-
       t    p    rh
s3  13.4  973  0.83
s2  21.7  983  0.64
s1  19.2  991  0.75
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 按照数据排序</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.DataFrame([[<span class="number">21.7</span>, <span class="number">983</span>, <span class="number">0.64</span>],</span><br><span class="line">               [<span class="number">19.2</span>, <span class="number">991</span>, <span class="number">0.75</span>],</span><br><span class="line">               [<span class="number">13.4</span>, <span class="number">973</span>, <span class="number">0.83</span>]],</span><br><span class="line">              index=[<span class="string">&#x27;s1&#x27;</span>, <span class="string">&#x27;s2&#x27;</span>, <span class="string">&#x27;s3&#x27;</span>],</span><br><span class="line">              columns=[<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;rh&#x27;</span>]</span><br><span class="line">             )</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;--------&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.sort_values(<span class="string">&#x27;p&#x27;</span>)) <span class="comment"># 按p列升序排列</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*-*-*-*-*-&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.sort_values(<span class="string">&#x27;p&#x27;</span>, ascending=<span class="literal">False</span>)) <span class="comment"># 按p列降序排列</span></span><br></pre></td></tr></table></figure>

<pre><code>       t    p    rh
s1  21.7  983  0.64
s2  19.2  991  0.75
s3  13.4  973  0.83
--------
       t    p    rh
s3  13.4  973  0.83
s1  21.7  983  0.64
s2  19.2  991  0.75
*-*-*-*-*-
       t    p    rh
s2  19.2  991  0.75
s1  21.7  983  0.64
s3  13.4  973  0.83
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获取最大值/最小值</span></span><br><span class="line"><span class="comment"># 使用max()/min()可以获取列的最大值/最小值</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.DataFrame([[<span class="number">21.7</span>, <span class="number">983</span>, <span class="number">0.64</span>],</span><br><span class="line">               [<span class="number">19.2</span>, <span class="number">991</span>, <span class="number">0.75</span>],</span><br><span class="line">               [<span class="number">13.4</span>, <span class="number">973</span>, <span class="number">0.83</span>]],</span><br><span class="line">              index=[<span class="string">&#x27;s1&#x27;</span>, <span class="string">&#x27;s2&#x27;</span>, <span class="string">&#x27;s3&#x27;</span>],</span><br><span class="line">              columns=[<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;rh&#x27;</span>]</span><br><span class="line">             )</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;--------&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.<span class="built_in">max</span>()) <span class="comment"># 列最大值</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*-*-*-*-*-&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.<span class="built_in">min</span>()) <span class="comment"># 列最小值</span></span><br></pre></td></tr></table></figure>

<pre><code>       t    p    rh
s1  21.7  983  0.64
s2  19.2  991  0.75
s3  13.4  973  0.83
--------
t      21.70
p     991.00
rh      0.83
dtype: float64
*-*-*-*-*-
t      13.40
p     973.00
rh      0.64
dtype: float64
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获取最大值/最小值</span></span><br><span class="line"><span class="comment"># 使用max()/min()也可以获取行的最大值/最小值</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.DataFrame([[<span class="number">21.7</span>, <span class="number">983</span>, <span class="number">0.64</span>],</span><br><span class="line">               [<span class="number">19.2</span>, <span class="number">991</span>, <span class="number">0.75</span>],</span><br><span class="line">               [<span class="number">13.4</span>, <span class="number">973</span>, <span class="number">0.83</span>]],</span><br><span class="line">              index=[<span class="string">&#x27;s1&#x27;</span>, <span class="string">&#x27;s2&#x27;</span>, <span class="string">&#x27;s3&#x27;</span>],</span><br><span class="line">              columns=[<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;rh&#x27;</span>]</span><br><span class="line">             )</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;--------&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.<span class="built_in">max</span>(axis=<span class="number">1</span>)) <span class="comment"># 行最大值</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*-*-*-*-*-&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.<span class="built_in">min</span>(axis=<span class="number">1</span>)) <span class="comment"># 行最小值</span></span><br></pre></td></tr></table></figure>

<pre><code>       t    p    rh
s1  21.7  983  0.64
s2  19.2  991  0.75
s3  13.4  973  0.83
--------
s1    983.0
s2    991.0
s3    973.0
dtype: float64
*-*-*-*-*-
s1    0.64
s2    0.75
s3    0.83
dtype: float64
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获取最大值/最小值对应的标签</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.DataFrame([[<span class="number">21.7</span>, <span class="number">983</span>, <span class="number">0.64</span>],</span><br><span class="line">               [<span class="number">19.2</span>, <span class="number">991</span>, <span class="number">0.75</span>],</span><br><span class="line">               [<span class="number">13.4</span>, <span class="number">973</span>, <span class="number">0.83</span>]],</span><br><span class="line">              index=[<span class="string">&#x27;s1&#x27;</span>, <span class="string">&#x27;s2&#x27;</span>, <span class="string">&#x27;s3&#x27;</span>],</span><br><span class="line">              columns=[<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;rh&#x27;</span>]</span><br><span class="line">             )</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;--------&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.idxmin())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;*-*-*-*-*-&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.idxmax())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;~~~~~~&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.idxmax(axis=<span class="number">1</span>))</span><br></pre></td></tr></table></figure>

<pre><code>       t    p    rh
s1  21.7  983  0.64
s2  19.2  991  0.75
s3  13.4  973  0.83
--------
t     s3
p     s3
rh    s1
dtype: object
*-*-*-*-*-
t     s1
p     s2
rh    s3
dtype: object
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">    s1    p</span><br><span class="line">    s2    p</span><br><span class="line">    s3    p</span><br><span class="line">    dtype: object</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">```python</span><br><span class="line"># 计算标准差/无偏方差</span><br><span class="line">import pandas as pd</span><br><span class="line">a = pd.DataFrame([[21.7, 983, 0.64],</span><br><span class="line">               [19.2, 991, 0.75],</span><br><span class="line">               [13.4, 973, 0.83]],</span><br><span class="line">              index=[&#x27;s1&#x27;, &#x27;s2&#x27;, &#x27;s3&#x27;],</span><br><span class="line">              columns=[&#x27;t&#x27;, &#x27;p&#x27;, &#x27;rh&#x27;]</span><br><span class="line">             )</span><br><span class="line">print(a)</span><br><span class="line">print(&#x27;--------&#x27;)</span><br><span class="line">print(a.std()) # 按列计算标准差</span><br><span class="line">print(&#x27;*-*-*-*-*-&#x27;)</span><br><span class="line">print(a.var()) # 按列计算无偏方差</span><br><span class="line">print(&#x27;~~~~~~&#x27;)</span><br><span class="line">print(a.std(axis=1))</span><br><span class="line">```</span><br><span class="line"></span><br><span class="line">           t    p    rh</span><br><span class="line">    s1  21.7  983  0.64</span><br><span class="line">    s2  19.2  991  0.75</span><br><span class="line">    s3  13.4  973  0.83</span><br><span class="line">    --------</span><br><span class="line">    t     4.257934</span><br><span class="line">    p     9.018500</span><br><span class="line">    rh    0.095394</span><br><span class="line">    dtype: float64</span><br><span class="line">    *-*-*-*-*-</span><br><span class="line">    t     18.130000</span><br><span class="line">    p     81.333333</span><br><span class="line">    rh     0.009100</span><br><span class="line">    dtype: float64</span><br></pre></td></tr></table></figure>
s1    561.185113
s2    566.470168
s3    557.689381
dtype: float64
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 计算相关系数</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.DataFrame([[<span class="number">21.7</span>, <span class="number">983</span>, <span class="number">0.64</span>],</span><br><span class="line">               [<span class="number">19.2</span>, <span class="number">991</span>, <span class="number">0.75</span>],</span><br><span class="line">               [<span class="number">13.4</span>, <span class="number">973</span>, <span class="number">0.83</span>]],</span><br><span class="line">              index=[<span class="string">&#x27;s1&#x27;</span>, <span class="string">&#x27;s2&#x27;</span>, <span class="string">&#x27;s3&#x27;</span>],</span><br><span class="line">              columns=[<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;rh&#x27;</span>]</span><br><span class="line">             )</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;--------&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.corr())</span><br></pre></td></tr></table></figure>

<pre><code>       t    p    rh
s1  21.7  983  0.64
s2  19.2  991  0.75
s3  13.4  973  0.83
--------
           t         p        rh
t   1.000000  0.726559 -0.950315
p   0.726559  1.000000 -0.476572
rh -0.950315 -0.476572  1.000000
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用corrwith()计算pd.DataFram与另一个pd.Series或pd.DataFrame之间的相关系数</span></span><br><span class="line">a = pd.DataFrame([[<span class="number">21.7</span>, <span class="number">983</span>, <span class="number">0.64</span>],</span><br><span class="line">               [<span class="number">19.2</span>, <span class="number">991</span>, <span class="number">0.75</span>],</span><br><span class="line">               [<span class="number">13.4</span>, <span class="number">973</span>, <span class="number">0.83</span>]],</span><br><span class="line">              index=[<span class="string">&#x27;s1&#x27;</span>, <span class="string">&#x27;s2&#x27;</span>, <span class="string">&#x27;s3&#x27;</span>],</span><br><span class="line">              columns=[<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;rh&#x27;</span>]</span><br><span class="line">             )</span><br><span class="line">b = pd.DataFrame([[<span class="number">21.5</span>, <span class="number">988</span>, <span class="number">0.62</span>],</span><br><span class="line">               [<span class="number">19.4</span>, <span class="number">996</span>, <span class="number">0.74</span>],</span><br><span class="line">               [<span class="number">13.2</span>, <span class="number">973</span>, <span class="number">0.85</span>]],</span><br><span class="line">              index=[<span class="string">&#x27;s1&#x27;</span>, <span class="string">&#x27;s2&#x27;</span>, <span class="string">&#x27;s3&#x27;</span>],</span><br><span class="line">              columns=[<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;rh&#x27;</span>]</span><br><span class="line">             )</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;--------&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.corrwith(b))</span><br></pre></td></tr></table></figure>

<pre><code>       t    p    rh
s1  21.7  983  0.64
s2  19.2  991  0.75
s3  13.4  973  0.83
--------
t     0.998639
p     0.993970
rh    0.997835
dtype: float64
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 计算协方差</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.DataFrame([[<span class="number">21.7</span>, <span class="number">983</span>, <span class="number">0.64</span>],</span><br><span class="line">               [<span class="number">19.2</span>, <span class="number">991</span>, <span class="number">0.75</span>],</span><br><span class="line">               [<span class="number">13.4</span>, <span class="number">973</span>, <span class="number">0.83</span>]],</span><br><span class="line">              index=[<span class="string">&#x27;s1&#x27;</span>, <span class="string">&#x27;s2&#x27;</span>, <span class="string">&#x27;s3&#x27;</span>],</span><br><span class="line">              columns=[<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;rh&#x27;</span>]</span><br><span class="line">             )</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;--------&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.cov())</span><br></pre></td></tr></table></figure>

<pre><code>       t    p    rh
s1  21.7  983  0.64
s2  19.2  991  0.75
s3  13.4  973  0.83
--------
         t          p      rh
t   18.130  27.900000 -0.3860
p   27.900  81.333333 -0.4100
rh  -0.386  -0.410000  0.0091
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 序列求和/求均值</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.DataFrame([[<span class="number">21.7</span>, <span class="number">983</span>, <span class="number">0.64</span>],</span><br><span class="line">               [<span class="number">19.2</span>, <span class="number">991</span>, <span class="number">0.75</span>],</span><br><span class="line">               [<span class="number">13.4</span>, <span class="number">973</span>, <span class="number">0.83</span>]],</span><br><span class="line">              index=[<span class="string">&#x27;s1&#x27;</span>, <span class="string">&#x27;s2&#x27;</span>, <span class="string">&#x27;s3&#x27;</span>],</span><br><span class="line">              columns=[<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;rh&#x27;</span>]</span><br><span class="line">             )</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;--------&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.<span class="built_in">sum</span>())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;-*-*-*-*-&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.mean())</span><br></pre></td></tr></table></figure>

<pre><code>       t    p    rh
s1  21.7  983  0.64
s2  19.2  991  0.75
s3  13.4  973  0.83
--------
t       54.30
p     2947.00
rh       2.22
dtype: float64
-*-*-*-*-
t      18.100000
p     982.333333
rh      0.740000
dtype: float64
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获取绝对值</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.DataFrame([[-<span class="number">21.7</span>, <span class="number">983</span>, <span class="number">0.64</span>],</span><br><span class="line">               [<span class="number">19.2</span>, <span class="number">991</span>, <span class="number">0.75</span>],</span><br><span class="line">               [<span class="number">13.4</span>, -<span class="number">973</span>, -<span class="number">0.83</span>]],</span><br><span class="line">              index=[<span class="string">&#x27;s1&#x27;</span>, <span class="string">&#x27;s2&#x27;</span>, <span class="string">&#x27;s3&#x27;</span>],</span><br><span class="line">              columns=[<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;rh&#x27;</span>]</span><br><span class="line">             )</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;--------&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a.<span class="built_in">abs</span>())</span><br></pre></td></tr></table></figure>

<pre><code>       t    p    rh
s1 -21.7  983  0.64
s2  19.2  991  0.75
s3  13.4 -973 -0.83
--------
       t    p    rh
s1  21.7  983  0.64
s2  19.2  991  0.75
s3  13.4  973  0.83
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 保存为CSV文件</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.DataFrame([[-<span class="number">21.7</span>, <span class="number">983</span>, <span class="number">0.64</span>],</span><br><span class="line">               [<span class="number">19.2</span>, <span class="number">991</span>, <span class="number">0.75</span>],</span><br><span class="line">               [<span class="number">13.4</span>, -<span class="number">973</span>, -<span class="number">0.83</span>]],</span><br><span class="line">              index=[<span class="string">&#x27;s1&#x27;</span>, <span class="string">&#x27;s2&#x27;</span>, <span class="string">&#x27;s3&#x27;</span>],</span><br><span class="line">              columns=[<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;rh&#x27;</span>]</span><br><span class="line">             )</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line">a.to_csv(<span class="string">&#x27;dataframe_to.csv&#x27;</span>)</span><br></pre></td></tr></table></figure>

<pre><code>       t    p    rh
s1 -21.7  983  0.64
s2  19.2  991  0.75
s3  13.4 -973 -0.83
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 转换数据类型</span></span><br><span class="line"><span class="comment"># 统一转换</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.DataFrame([[<span class="number">21.7</span>, <span class="number">983</span>, <span class="number">0.64</span>],</span><br><span class="line">               [<span class="number">19.2</span>, <span class="number">991</span>, <span class="number">0.75</span>],</span><br><span class="line">               [<span class="number">13.4</span>, <span class="number">973</span>, <span class="number">0.83</span>]],</span><br><span class="line">              index=[<span class="string">&#x27;s1&#x27;</span>, <span class="string">&#x27;s2&#x27;</span>, <span class="string">&#x27;s3&#x27;</span>],</span><br><span class="line">              columns=[<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;rh&#x27;</span>]</span><br><span class="line">             )</span><br><span class="line"><span class="built_in">print</span>(a.dtypes)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;--------&#x27;</span>)</span><br><span class="line">b = a.astype(np.float32)</span><br><span class="line"><span class="built_in">print</span>(b.dtypes)</span><br></pre></td></tr></table></figure>

<pre><code>t     float64
p       int64
rh    float64
dtype: object
--------
t     float32
p     float32
rh    float32
dtype: object
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 转换数据类型</span></span><br><span class="line"><span class="comment"># 指定列转换</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.DataFrame([[<span class="number">21.7</span>, <span class="number">983</span>, <span class="number">0.64</span>],</span><br><span class="line">               [<span class="number">19.2</span>, <span class="number">991</span>, <span class="number">0.75</span>],</span><br><span class="line">               [<span class="number">13.4</span>, <span class="number">973</span>, <span class="number">0.83</span>]],</span><br><span class="line">              index=[<span class="string">&#x27;s1&#x27;</span>, <span class="string">&#x27;s2&#x27;</span>, <span class="string">&#x27;s3&#x27;</span>],</span><br><span class="line">              columns=[<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;rh&#x27;</span>]</span><br><span class="line">             )</span><br><span class="line"><span class="built_in">print</span>(a.dtypes)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;--------&#x27;</span>)</span><br><span class="line">b = a.astype(&#123;<span class="string">&#x27;t&#x27;</span>: np.float32, <span class="string">&#x27;p&#x27;</span>: np.float64&#125;)</span><br><span class="line"><span class="built_in">print</span>(b.dtypes)</span><br></pre></td></tr></table></figure>

<pre><code>t     float64
p       int64
rh    float64
dtype: object
--------
t     float32
p     float64
rh    float64
dtype: object
</code></pre>
<h2 id="4-4-pandas的常用函数"><a href="#4-4-pandas的常用函数" class="headerlink" title="4.4  pandas的常用函数"></a>4.4  pandas的常用函数</h2><h3 id="4-4-1-to-numeric-——将序列转换为数值类型"><a href="#4-4-1-to-numeric-——将序列转换为数值类型" class="headerlink" title="4.4.1  to_numeric()——将序列转换为数值类型"></a>4.4.1  to_numeric()——将序列转换为数值类型</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将非数值类型的序列转换为数值类型</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.DataFrame([[<span class="number">21.7</span>, <span class="number">983</span>, <span class="number">0.64</span>],</span><br><span class="line">               [<span class="string">&#x27;19.2&#x27;</span>, <span class="number">991</span>, <span class="number">0.75</span>],</span><br><span class="line">               [<span class="number">13.4</span>, <span class="number">973</span>, <span class="number">0.83</span>]],</span><br><span class="line">              index=[<span class="string">&#x27;s1&#x27;</span>, <span class="string">&#x27;s2&#x27;</span>, <span class="string">&#x27;s3&#x27;</span>],</span><br><span class="line">              columns=[<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;rh&#x27;</span>]</span><br><span class="line">             )</span><br><span class="line"><span class="built_in">print</span>(a.dtypes)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;--------&#x27;</span>)</span><br><span class="line">a[<span class="string">&#x27;t&#x27;</span>] = pd.to_numeric(a[<span class="string">&#x27;t&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(a.dtypes)</span><br></pre></td></tr></table></figure>

<pre><code>t      object
p       int64
rh    float64
dtype: object
--------
t     float64
p       int64
rh    float64
dtype: object
</code></pre>
<h3 id="4-4-2-to-datetime-——将序列转换为时间戳类型"><a href="#4-4-2-to-datetime-——将序列转换为时间戳类型" class="headerlink" title="4.4.2  to_datetime()——将序列转换为时间戳类型"></a>4.4.2  to_datetime()——将序列转换为时间戳类型</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 直接解析标准格式的时间字符串</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">a = pd.to_datetime([<span class="string">&#x27;20200228&#x27;</span>, <span class="string">&#x27;20200301&#x27;</span>])</span><br><span class="line">b = pd.to_datetime([<span class="string">&#x27;2020-02-28&#x27;</span>, <span class="string">&#x27;2020-03-01&#x27;</span>])</span><br><span class="line">c = pd.to_datetime([<span class="string">&#x27;2020/02/28&#x27;</span>, <span class="string">&#x27;2020/03/01&#x27;</span>])</span><br><span class="line">d = pd.to_datetime([<span class="string">&#x27;202002281200&#x27;</span>, <span class="string">&#x27;202002281200&#x27;</span>])</span><br><span class="line">e = pd.to_datetime([<span class="string">&#x27;2020-02-28 12:00&#x27;</span>, <span class="string">&#x27;2020-03-01 12:00&#x27;</span>])</span><br><span class="line">f = pd.to_datetime([<span class="string">&#x27;2020/02/28 12:00&#x27;</span>, <span class="string">&#x27;2020/03/01 12:00&#x27;</span>])</span><br><span class="line">g = pd.to_datetime([<span class="string">&#x27;20200228120050&#x27;</span>, <span class="string">&#x27;20200228120050&#x27;</span>])</span><br><span class="line">h = pd.to_datetime([<span class="string">&#x27;2020-02-28 12:00:50&#x27;</span>, <span class="string">&#x27;2020-03-01 12:00:50&#x27;</span>])</span><br><span class="line">i = pd.to_datetime([<span class="string">&#x27;2020/02/28 12:00:50&#x27;</span>, <span class="string">&#x27;2020/03/01 12:00:50&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="built_in">print</span>(b)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"><span class="built_in">print</span>(d)</span><br><span class="line"><span class="built_in">print</span>(e)</span><br><span class="line"><span class="built_in">print</span>(f)</span><br><span class="line"><span class="built_in">print</span>(g)</span><br><span class="line"><span class="built_in">print</span>(h)</span><br><span class="line"><span class="built_in">print</span>(i)</span><br></pre></td></tr></table></figure>

<pre><code>DatetimeIndex([&#39;2020-02-28&#39;, &#39;2020-03-01&#39;], dtype=&#39;datetime64[ns]&#39;, freq=None)
DatetimeIndex([&#39;2020-02-28&#39;, &#39;2020-03-01&#39;], dtype=&#39;datetime64[ns]&#39;, freq=None)
DatetimeIndex([&#39;2020-02-28&#39;, &#39;2020-03-01&#39;], dtype=&#39;datetime64[ns]&#39;, freq=None)
DatetimeIndex([&#39;2020-02-28 12:00:00&#39;, &#39;2020-02-28 12:00:00&#39;], dtype=&#39;datetime64[ns]&#39;, freq=None)
DatetimeIndex([&#39;2020-02-28 12:00:00&#39;, &#39;2020-03-01 12:00:00&#39;], dtype=&#39;datetime64[ns]&#39;, freq=None)
DatetimeIndex([&#39;2020-02-28 12:00:00&#39;, &#39;2020-03-01 12:00:00&#39;], dtype=&#39;datetime64[ns]&#39;, freq=None)
DatetimeIndex([&#39;2020-02-28 12:00:50&#39;, &#39;2020-02-28 12:00:50&#39;], dtype=&#39;datetime64[ns]&#39;, freq=None)
DatetimeIndex([&#39;2020-02-28 12:00:50&#39;, &#39;2020-03-01 12:00:50&#39;], dtype=&#39;datetime64[ns]&#39;, freq=None)
DatetimeIndex([&#39;2020-02-28 12:00:50&#39;, &#39;2020-03-01 12:00:50&#39;], dtype=&#39;datetime64[ns]&#39;, freq=None)
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 对于特殊格式的时间字符串的解析</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.to_datetime([<span class="string">&#x27;2020年02月28日&#x27;</span>, <span class="string">&#x27;2020年03月28日&#x27;</span>], <span class="built_in">format</span>=<span class="string">&#x27;%Y年%m月%d日&#x27;</span>)</span><br><span class="line">b = pd.to_datetime([<span class="string">&#x27;202002(28)&#x27;</span>, <span class="string">&#x27;202003(28)&#x27;</span>], <span class="built_in">format</span>=<span class="string">&#x27;%Y%m(%d)&#x27;</span>)</span><br><span class="line">c = pd.to_datetime([<span class="string">&#x27;20200228(1200)&#x27;</span>, <span class="string">&#x27;20200328(1200)&#x27;</span>], <span class="built_in">format</span>=<span class="string">&#x27;%Y%m%d(%H%M)&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="built_in">print</span>(b)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br></pre></td></tr></table></figure>

<pre><code>DatetimeIndex([&#39;2020-02-28&#39;, &#39;2020-03-28&#39;], dtype=&#39;datetime64[ns]&#39;, freq=None)
DatetimeIndex([&#39;2020-02-28&#39;, &#39;2020-03-28&#39;], dtype=&#39;datetime64[ns]&#39;, freq=None)
DatetimeIndex([&#39;2020-02-28 12:00:00&#39;, &#39;2020-03-28 12:00:00&#39;], dtype=&#39;datetime64[ns]&#39;, freq=None)
</code></pre>
<h3 id="4-4-3-to-timedelta-——将序列转换为时间差类型"><a href="#4-4-3-to-timedelta-——将序列转换为时间差类型" class="headerlink" title="4.4.3  to_timedelta()——将序列转换为时间差类型"></a>4.4.3  to_timedelta()——将序列转换为时间差类型</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 时间差的概念</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.to_timedelta([<span class="string">&#x27;1 day&#x27;</span>, <span class="string">&#x27;10 min&#x27;</span>, <span class="string">&#x27;20S&#x27;</span>])</span><br><span class="line">b = pd.to_timedelta([<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>], unit=<span class="string">&#x27;D&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="built_in">print</span>(b)</span><br></pre></td></tr></table></figure>

<pre><code>TimedeltaIndex([&#39;1 days 00:00:00&#39;, &#39;0 days 00:10:00&#39;, &#39;0 days 00:00:20&#39;], dtype=&#39;timedelta64[ns]&#39;, freq=None)
TimedeltaIndex([&#39;1 days&#39;, &#39;3 days&#39;, &#39;5 days&#39;], dtype=&#39;timedelta64[ns]&#39;, freq=None)
</code></pre>
<h3 id="4-4-4-date-range-——生成时间序列"><a href="#4-4-4-date-range-——生成时间序列" class="headerlink" title="4.4.4  date_range()——生成时间序列"></a>4.4.4  date_range()——生成时间序列</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 生成时间序列</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">a = pd.date_range(start=<span class="string">&#x27;2020-03-01&#x27;</span>, periods=<span class="number">3</span>, freq=<span class="string">&#x27;3H&#x27;</span>)</span><br><span class="line">b = pd.date_range(start=<span class="string">&#x27;2020-03-01&#x27;</span>, end=<span class="string">&#x27;2020-03-03&#x27;</span>, freq=<span class="string">&#x27;D&#x27;</span>)</span><br><span class="line">c = pd.date_range(start=<span class="string">&#x27;2020-03-01&#x27;</span>, end=<span class="string">&#x27;2020-03-03&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="built_in">print</span>(b)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<pre><code>DatetimeIndex([&#39;2020-03-01 00:00:00&#39;, &#39;2020-03-01 03:00:00&#39;,
               &#39;2020-03-01 06:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, freq=&#39;3H&#39;)
DatetimeIndex([&#39;2020-03-01&#39;, &#39;2020-03-02&#39;, &#39;2020-03-03&#39;], dtype=&#39;datetime64[ns]&#39;, freq=&#39;D&#39;)
DatetimeIndex([&#39;2020-03-01&#39;, &#39;2020-03-02&#39;, &#39;2020-03-03&#39;], dtype=&#39;datetime64[ns]&#39;, freq=&#39;D&#39;)
</code></pre>
<h3 id="4-4-5-merge-——按值连接两个pd-DataFrame"><a href="#4-4-5-merge-——按值连接两个pd-DataFrame" class="headerlink" title="4.4.5  merge()——按值连接两个pd.DataFrame"></a>4.4.5  merge()——按值连接两个pd.DataFrame</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 按值连接两个pd.DataFrame</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.DataFrame([[<span class="string">&#x27;sunny&#x27;</span>, <span class="number">983</span>, <span class="number">0.64</span>],</span><br><span class="line">               [<span class="string">&#x27;rain&#x27;</span>, <span class="number">991</span>, <span class="number">0.75</span>],</span><br><span class="line">               [<span class="string">&#x27;fog&#x27;</span>, <span class="number">973</span>, <span class="number">0.83</span>],</span><br><span class="line">               [<span class="string">&#x27;haze&#x27;</span>, <span class="number">1001</span>, <span class="number">0.93</span>]],</span><br><span class="line">              index=[<span class="string">&#x27;d1&#x27;</span>, <span class="string">&#x27;d2&#x27;</span>, <span class="string">&#x27;d3&#x27;</span>, <span class="string">&#x27;d4&#x27;</span>],</span><br><span class="line">              columns=[<span class="string">&#x27;weather&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;rh&#x27;</span>]</span><br><span class="line">             )</span><br><span class="line">b = pd.DataFrame([[<span class="string">&#x27;rain&#x27;</span>, <span class="string">&#x27;0121&#x27;</span>],</span><br><span class="line">               [<span class="string">&#x27;windy&#x27;</span>, <span class="string">&#x27;1123&#x27;</span>],</span><br><span class="line">               [<span class="string">&#x27;fog&#x27;</span>, <span class="string">&#x27;1234&#x27;</span>],</span><br><span class="line">               [<span class="string">&#x27;sunny&#x27;</span>, <span class="string">&#x27;2234&#x27;</span>]],</span><br><span class="line">              columns=[<span class="string">&#x27;weather&#x27;</span>, <span class="string">&#x27;code&#x27;</span>]</span><br><span class="line">             )</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;------&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(b)</span><br><span class="line"><span class="comment"># 左连接</span></span><br><span class="line">c = pd.merge(left=a, right=b, left_on=<span class="string">&#x27;weather&#x27;</span>, right_on=<span class="string">&#x27;weather&#x27;</span>, how=<span class="string">&#x27;left&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"><span class="comment"># 右连接</span></span><br><span class="line">c = pd.merge(left=a, right=b, left_on=<span class="string">&#x27;weather&#x27;</span>, right_on=<span class="string">&#x27;weather&#x27;</span>, how=<span class="string">&#x27;right&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"><span class="comment"># 内连接</span></span><br><span class="line">c = pd.merge(left=a, right=b, left_on=<span class="string">&#x27;weather&#x27;</span>, right_on=<span class="string">&#x27;weather&#x27;</span>, how=<span class="string">&#x27;inner&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"><span class="comment"># 外连接</span></span><br><span class="line">c = pd.merge(left=a, right=b, left_on=<span class="string">&#x27;weather&#x27;</span>, right_on=<span class="string">&#x27;weather&#x27;</span>, how=<span class="string">&#x27;outer&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br></pre></td></tr></table></figure>

<pre><code>   weather     p    rh
d1   sunny   983  0.64
d2    rain   991  0.75
d3     fog   973  0.83
d4    haze  1001  0.93
------
  weather  code
0    rain  0121
1   windy  1123
2     fog  1234
3   sunny  2234
  weather     p    rh  code
0   sunny   983  0.64  2234
1    rain   991  0.75  0121
2     fog   973  0.83  1234
3    haze  1001  0.93   NaN
  weather      p    rh  code
0    rain  991.0  0.75  0121
1   windy    NaN   NaN  1123
2     fog  973.0  0.83  1234
3   sunny  983.0  0.64  2234
  weather    p    rh  code
0   sunny  983  0.64  2234
1    rain  991  0.75  0121
2     fog  973  0.83  1234
  weather       p    rh  code
0   sunny   983.0  0.64  2234
1    rain   991.0  0.75  0121
2     fog   973.0  0.83  1234
3    haze  1001.0  0.93   NaN
4   windy     NaN   NaN  1123
</code></pre>
<h3 id="4-4-6-concat-——合并多个pd-DataFrame"><a href="#4-4-6-concat-——合并多个pd-DataFrame" class="headerlink" title="4.4.6  concat()——合并多个pd.DataFrame"></a>4.4.6  concat()——合并多个pd.DataFrame</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 直接按照行或列合并多个pd.DataFrame</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">a = pd.DataFrame([[<span class="string">&#x27;sunny&#x27;</span>, <span class="number">983</span>, <span class="number">0.64</span>],</span><br><span class="line">               [<span class="string">&#x27;rain&#x27;</span>, <span class="number">991</span>, <span class="number">0.75</span>],</span><br><span class="line">               [<span class="string">&#x27;fog&#x27;</span>, <span class="number">973</span>, <span class="number">0.83</span>],</span><br><span class="line">               [<span class="string">&#x27;haze&#x27;</span>, <span class="number">1001</span>, <span class="number">0.93</span>]],</span><br><span class="line">              index=[<span class="string">&#x27;d1&#x27;</span>, <span class="string">&#x27;d2&#x27;</span>, <span class="string">&#x27;d3&#x27;</span>, <span class="string">&#x27;d4&#x27;</span>],</span><br><span class="line">              columns=[<span class="string">&#x27;weather&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;rh&#x27;</span>]</span><br><span class="line">             )</span><br><span class="line"><span class="built_in">print</span>(pd.concat([a, a]))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;-----&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(pd.concat([a, a], axis=<span class="number">1</span>))</span><br></pre></td></tr></table></figure>

<pre><code>   weather     p    rh
d1   sunny   983  0.64
d2    rain   991  0.75
d3     fog   973  0.83
d4    haze  1001  0.93
d1   sunny   983  0.64
d2    rain   991  0.75
d3     fog   973  0.83
d4    haze  1001  0.93
-----
   weather     p    rh weather     p    rh
d1   sunny   983  0.64   sunny   983  0.64
d2    rain   991  0.75    rain   991  0.75
d3     fog   973  0.83     fog   973  0.83
d4    haze  1001  0.93    haze  1001  0.93
</code></pre>
<script src="https://utteranc.es/client.js"
        repo="Nuist666/blog_comment"
        issue-term="python气象信息系统工程 第四章"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python-%E6%B0%94%E8%B1%A1%E4%BF%A1%E6%81%AF%E7%B3%BB%E7%BB%9F%E5%B7%A5%E7%A8%8B/" rel="tag">python,气象信息系统工程</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/%E5%B0%8F%E4%B9%A6%E5%8C%A0-python/">/小书匠/python</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/page/10/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/9/">9</a><a class="page-number" href="/page/10/">10</a><span class="page-number current">11</span><a class="page-number" href="/page/12/">12</a><a class="page-number" href="/page/13/">13</a><span class="space">&hellip;</span><a class="page-number" href="/page/15/">15</a><a class="extend next" rel="next" href="/page/12/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
      <div class="footer-left">
        &copy; 2024 Nuist666
      </div>
        <div class="footer-right">
          <a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/preccrep/hexo-theme-jelly" target="_blank">Jelly</a>
        </div>
    </div>
  </div>
</footer>
    </div>
    
  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">



<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: false,
		animate: true,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>

<script src="/js/main.js"></script>




  </div>
</body>
</html>