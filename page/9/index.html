<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Nuist666的个人博客</title>

  <!-- keywords -->
  

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Nuist666的个人博客">
<meta property="og:url" content="https://nuist666.github.io/page/9/index.html">
<meta property="og:site_name" content="Nuist666的个人博客">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Nuist666">
<meta name="twitter:card" content="summary">
  
    <link rel="alternative" href="/atom.xml" title="Nuist666的个人博客" type="application/atom+xml">
  
  
    <link rel="icon" href="/img/favicon.ico">
  
  
<link rel="stylesheet" href="/css/style.css">

  
  

  
<script src="//cdn.bootcss.com/require.js/2.3.2/require.min.js"></script>

  
<script src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script>


  
<meta name="generator" content="Hexo 7.1.1"></head>
<body>
  <div id="container">
    <div id="particles-js"></div>
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
				<img lazy-src="/img/avatar.png" class="js-avatar">
			
		</a>

		<hgroup>
			<h1 class="header-author"><a href="/">Nuist666</a></h1>
		</hgroup>

		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">Home</a></li>
				        
							<li><a href="/archives">Archives</a></li>
				        
						</ul>
					</nav>
					<nav class="half-header-menu">
						<a class="hide">Home</a>
						<a>Tags</a>
						<a>Links</a>
						<a>About</a>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/Nuist666" title="github">github</a>
					        
								<a class="mail" target="_blank" href="mailto:202183290043@nuist.edu.cn" title="mail">mail</a>
					        
								<a class="weibo" target="_blank" href="https://weibo.com/u/5586096129" title="weibo">weibo</a>
					        
								<a class="twitter" target="_blank" href="https://twitter.com/nuist_666" title="twitter">twitter</a>
					        
						</div>
						<!-- music -->
						
							<!-- <div style="position: absolute; bottom: 120px; left: auto; width: 85%;"> -->
							<div style="position: absolute; left: auto; width: 85%;">
								<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=220 height=86 src="//music.163.com/outchain/player?type=2&id=28411862&auto=1&height=66"></iframe>
							</div>
						
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/Overflow-Mirai-LLOneBot-OneBot/" style="font-size: 10px;">Overflow,Mirai,LLOneBot,OneBot</a> <a href="/tags/python-%E6%B0%94%E8%B1%A1%E4%BF%A1%E6%81%AF%E7%B3%BB%E7%BB%9F%E5%B7%A5%E7%A8%8B/" style="font-size: 20px;">python,气象信息系统工程</a> <a href="/tags/%E5%8D%8E%E4%B8%BA%E4%BA%91-%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2-Hexo/" style="font-size: 10px;">华为云,个人博客,Hexo</a> <a href="/tags/%E6%A8%A1%E6%9D%BF-%E5%B0%8F%E4%B9%A6%E5%8C%A0-%E4%B8%89%E5%B3%B0%E7%9C%9F%E7%99%BD-%E6%96%B0%E5%BB%BA/" style="font-size: 10px;">模板,小书匠,三峰真白,新建</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="https://qm.qq.com/q/HrJvHGMzek">qq</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="https://space.bilibili.com/3546647772531174">bilibili</a>
			        
			        </div>
				</section>
				

				
				
				<section class="switch-part switch-part4">
				
					<div id="js-aboutme">I&#39;m a student in NUIST.</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>

<img src="1" onerror="localStorage.setItem('modelId','25')" style="display: none;">

<script>

// live2d_path 参数建议使用绝对路径
const live2d_path = "https://fastly.jsdelivr.net/gh/stevenjoezhang/live2d-widget@latest/";
//const live2d_path = "/live2d-widget/";

// 封装异步加载资源的方法
function loadExternalResource(url, type) {
	return new Promise((resolve, reject) => {
		let tag;

		if (type === "css") {
			tag = document.createElement("link");
			tag.rel = "stylesheet";
			tag.href = url;
		}
		else if (type === "js") {
			tag = document.createElement("script");
			tag.src = url;
		}
		if (tag) {
			tag.onload = () => resolve(url);
			tag.onerror = () => reject(url);
			document.head.appendChild(tag);
		}
	});
}

// 加载 waifu.css live2d.min.js waifu-tips.js
	Promise.all([
		loadExternalResource(live2d_path + "waifu.css", "css"),
		loadExternalResource(live2d_path + "live2d.min.js", "js"),
		loadExternalResource(live2d_path + "waifu-tips.js", "js")
	]).then(() => {
		// 配置选项的具体用法见 README.md
		initWidget({
			waifuPath: live2d_path + "waifu-tips.json",
			apiPath: "https://api.zsq.im/live2d/",
			//cdnPath: "https://fastly.jsdelivr.net/gh/fghrsh/live2d_api/",
			tools: ["hitokoto", "asteroids", "switch-model", "switch-texture", "photo", "info", "quit"]
		});
	});

console.log(`
  く__,.ヘヽ.        /  ,ー､ 〉
           ＼ ', !-─‐-i  /  /´
           ／｀ｰ'       L/／｀ヽ､
         /   ／,   /|   ,   ,       ',
       ｲ   / /-‐/  ｉ  L_ ﾊ ヽ!   i
        ﾚ ﾍ 7ｲ｀ﾄ   ﾚ'ｧ-ﾄ､!ハ|   |
          !,/7 '0'     ´0iソ|    |
          |.从"    _     ,,,, / |./    |
          ﾚ'| i＞.､,,__  _,.イ /   .i   |
            ﾚ'| | / k_７_/ﾚ'ヽ,  ﾊ.  |
              | |/i 〈|/   i  ,.ﾍ |  i  |
             .|/ /  ｉ：    ﾍ!    ＼  |
              kヽ>､ﾊ    _,.ﾍ､    /､!
              !'〈//｀Ｔ´', ＼ ｀'7'ｰr'
              ﾚ'ヽL__|___i,___,ンﾚ|ノ
                  ﾄ-,/  |___./
                  'ｰ'    !_,.:
`);

</script>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide"></h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="/img/avatar.png" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author"></h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">Home</a></li>
		        
					<li><a href="/archives">Archives</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/Nuist666" title="github">github</a>
			        
						<a class="mail" target="_blank" href="mailto:202183290043@nuist.edu.cn" title="mail">mail</a>
			        
						<a class="weibo" target="_blank" href="https://weibo.com/u/5586096129" title="weibo">weibo</a>
			        
						<a class="twitter" target="_blank" href="https://twitter.com/nuist_666" title="twitter">twitter</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap">
  
    <article id="post-第六章" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2000/01/01/%E7%AC%AC%E5%85%AD%E7%AB%A0/" class="article-date">
  	<time datetime="1999-12-31T16:06:00.000Z" itemprop="datePublished">2000-01-01</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2000/01/01/%E7%AC%AC%E5%85%AD%E7%AB%A0/">
        python气象信息系统工程 第六章
        
      </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="第六章"><a href="#第六章" class="headerlink" title="第六章"></a>第六章</h1><h2 id="6-1-文本文件"><a href="#6-1-文本文件" class="headerlink" title="6.1 文本文件"></a>6.1 文本文件</h2><h3 id="6-1-2-CSV文件"><a href="#6-1-2-CSV文件" class="headerlink" title="6.1.2  CSV文件"></a>6.1.2  CSV文件</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 读取csv，同时将时间字符串解析为时间戳类型</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">dat = pd.read_csv(<span class="string">&#x27;/home/mw/input/pythonbook7300/sta.csv&#x27;</span>, parse_dates=[<span class="string">&#x27;time&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(dat.dtypes)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;--------&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(dat)</span><br></pre></td></tr></table></figure>

<pre><code>time       datetime64[ns]
station             int64
t                 float64
tmax              float64
tmin              float64
dtype: object
--------
         time  station     t  tmax  tmin
0  2020-03-01    58238   8.7  12.5   1.3
1  2020-03-01    58235   7.5  11.3   0.8
2  2020-03-01    58237   8.5  11.8   1.2
3  2020-03-02    58238   9.5  13.3   4.4
4  2020-03-02    58235   8.3  12.8   4.0
5  2020-03-02    58237   8.8  12.9   4.2
6  2020-03-03    58238  13.1  14.5  10.1
7  2020-03-03    58235  12.4  13.7   9.6
8  2020-03-03    58237  13.0  14.1  10.0
9  2020-03-04    58238  10.3  13.8   5.2
10 2020-03-04    58235   9.8  12.9   4.5
11 2020-03-04    58237  10.1  13.1   4.8
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将站号指定为字符串类型</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">dat = pd.read_csv(<span class="string">&#x27;/home/mw/input/pythonbook7300/sta.csv&#x27;</span>, </span><br><span class="line">               parse_dates=[<span class="string">&#x27;time&#x27;</span>], </span><br><span class="line">               dtype=&#123;<span class="string">&#x27;station&#x27;</span>: np.unicode_&#125;)</span><br><span class="line"><span class="built_in">print</span>(dat.dtypes)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;--------&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(dat)</span><br></pre></td></tr></table></figure>

<pre><code>time       datetime64[ns]
station            object
t                 float64
tmax              float64
tmin              float64
dtype: object
--------
         time station     t  tmax  tmin
0  2020-03-01   58238   8.7  12.5   1.3
1  2020-03-01   58235   7.5  11.3   0.8
2  2020-03-01   58237   8.5  11.8   1.2
3  2020-03-02   58238   9.5  13.3   4.4
4  2020-03-02   58235   8.3  12.8   4.0
5  2020-03-02   58237   8.8  12.9   4.2
6  2020-03-03   58238  13.1  14.5  10.1
7  2020-03-03   58235  12.4  13.7   9.6
8  2020-03-03   58237  13.0  14.1  10.0
9  2020-03-04   58238  10.3  13.8   5.2
10 2020-03-04   58235   9.8  12.9   4.5
11 2020-03-04   58237  10.1  13.1   4.8
</code></pre>
<h3 id="6-1-3-空格（制表符）作为分隔符的文件"><a href="#6-1-3-空格（制表符）作为分隔符的文件" class="headerlink" title="6.1.3  空格（制表符）作为分隔符的文件"></a>6.1.3  空格（制表符）作为分隔符的文件</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 读取空格为分隔符的文件</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">dat = pd.read_csv(<span class="string">&#x27;/home/mw/input/pythonbook7300/sta.txt&#x27;</span>, </span><br><span class="line">               sep=<span class="string">&#x27;\s&#x27;</span>, <span class="comment">#如果是空格分隔符，则此处参数值为1s</span></span><br><span class="line">               parse_dates=[<span class="string">&#x27;time&#x27;</span>], </span><br><span class="line">               dtype=&#123;<span class="string">&#x27;station&#x27;</span>: np.unicode_&#125;)</span><br><span class="line"><span class="built_in">print</span>(dat.dtypes)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;--------&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(dat)</span><br></pre></td></tr></table></figure>

<pre><code>time       datetime64[ns]
station            object
t                 float64
tmax              float64
tmin              float64
dtype: object
--------
                 time station     t  tmax  tmin
2020-03-01 2023-03-02   58238   8.7  12.5   1.3
2020-03-01 2023-03-02   58235   7.5  11.3   0.8
2020-03-01 2023-03-02   58237   8.5  11.8   1.2
2020-03-02 2023-03-02   58238   9.5  13.3   4.4
2020-03-02 2023-03-02   58235   8.3  12.8   4.0
2020-03-02 2023-03-02   58237   8.8  12.9   4.2
2020-03-03 2023-03-02   58238  13.1  14.5  10.1
2020-03-03 2023-03-02   58235  12.4  13.7   9.6
2020-03-03 2023-03-02   58237  13.0  14.1  10.0
2020-03-04 2023-03-02   58238  10.3  13.8   5.2
2020-03-04 2023-03-02   58235   9.8  12.9   4.5
2020-03-04 2023-03-02   58237  10.1  13.1   4.8


/opt/conda/lib/python3.7/site-packages/pandas/util/_decorators.py:311: ParserWarning: Falling back to the &#39;python&#39; engine because the &#39;c&#39; engine does not support regex separators (separators &gt; 1 char and different from &#39;\s+&#39; are interpreted as regex); you can avoid this warning by specifying engine=&#39;python&#39;.
  return func(*args, **kwargs)
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 读取栅格型文本数据</span></span><br><span class="line"><span class="comment"># 行列与经纬栅格相关</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> xarray <span class="keyword">as</span> xr</span><br><span class="line">array_raw = np.loadtxt(<span class="string">&#x27;/home/mw/input/pythonbook7300/grid_1.txt&#x27;</span>, dtype=np.float64)</span><br><span class="line"><span class="built_in">print</span>(array_raw) <span class="comment"># 这一行用于演示读取结果，并非必要输入， 数据量过大时可能会导致卡顿</span></span><br><span class="line">lon = np.linspace(<span class="number">120</span>, <span class="number">122.5</span>, <span class="number">5</span>)</span><br><span class="line">lat = np.linspace(<span class="number">10</span>, <span class="number">13</span>, <span class="number">4</span>)</span><br><span class="line"><span class="built_in">print</span>(lon) <span class="comment"># 此行仅用于演示</span></span><br><span class="line"><span class="built_in">print</span>(lat) <span class="comment"># 此行仅用于演示</span></span><br><span class="line">t_grid = xr.DataArray(array_raw, coords=[lat, lon], dims=[<span class="string">&quot;lat&quot;</span>, <span class="string">&quot;lon&quot;</span>])</span><br><span class="line"><span class="built_in">print</span>(t_grid)</span><br></pre></td></tr></table></figure>

<pre><code>Warning: ecCodes 2.21.0 or higher is recommended. You are running version 2.14.1
[[10.12 11.15 11.3  10.25  9.97]
 [10.23 11.54 11.12 10.01  9.85]
 [10.07 11.37 10.98 10.42  9.58]
 [10.33 12.01 10.38 10.36 10.12]]
[120.    120.625 121.25  121.875 122.5  ]
[10. 11. 12. 13.]
&lt;xarray.DataArray (lat: 4, lon: 5)&gt;
array([[10.12, 11.15, 11.3 , 10.25,  9.97],
       [10.23, 11.54, 11.12, 10.01,  9.85],
       [10.07, 11.37, 10.98, 10.42,  9.58],
       [10.33, 12.01, 10.38, 10.36, 10.12]])
Coordinates:
  * lat      (lat) float64 10.0 11.0 12.0 13.0
  * lon      (lon) float64 120.0 120.6 121.2 121.9 122.5
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 读取栅格型文本数据</span></span><br><span class="line"><span class="comment"># 行列与经纬栅格无关</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> xarray <span class="keyword">as</span> xr</span><br><span class="line">array_raw = np.loadtxt(<span class="string">&#x27;/home/mw/input/pythonbook7300/grid_2.txt&#x27;</span>, dtype=np.float64)</span><br><span class="line"><span class="built_in">print</span>(array_raw) <span class="comment"># 这一行用于演示结果，并非必要输入，数据量过大时可能会导致卡顿</span></span><br><span class="line">array_raw = array_raw.reshape((<span class="number">4</span>, <span class="number">5</span>))</span><br><span class="line"><span class="built_in">print</span>(array_raw) <span class="comment"># 这一行用于演示结果，并非必要输入，数据量过大时可能会导致卡顿</span></span><br><span class="line">lon = np.linspace(<span class="number">120</span>, <span class="number">122.5</span>, <span class="number">5</span>)</span><br><span class="line">lat = np.linspace(<span class="number">10</span>, <span class="number">13</span>, <span class="number">4</span>)</span><br><span class="line"><span class="built_in">print</span>(lon) <span class="comment"># 此行仅用于演示</span></span><br><span class="line"><span class="built_in">print</span>(lat) <span class="comment"># 此行仅用于演示</span></span><br><span class="line">t_grid = xr.DataArray(array_raw, coords=[lat, lon], dims=[<span class="string">&quot;lat&quot;</span>, <span class="string">&quot;lon&quot;</span>])</span><br><span class="line"><span class="built_in">print</span>(t_grid)</span><br></pre></td></tr></table></figure>

<pre><code>[[10.12 11.15 11.3  10.25  9.97 10.23 11.54 11.12 10.01  9.85]
 [10.07 11.37 10.98 10.42  9.58 10.33 12.01 10.38 10.36 10.12]]
[[10.12 11.15 11.3  10.25  9.97]
 [10.23 11.54 11.12 10.01  9.85]
 [10.07 11.37 10.98 10.42  9.58]
 [10.33 12.01 10.38 10.36 10.12]]
[120.    120.625 121.25  121.875 122.5  ]
[10. 11. 12. 13.]
&lt;xarray.DataArray (lat: 4, lon: 5)&gt;
array([[10.12, 11.15, 11.3 , 10.25,  9.97],
       [10.23, 11.54, 11.12, 10.01,  9.85],
       [10.07, 11.37, 10.98, 10.42,  9.58],
       [10.33, 12.01, 10.38, 10.36, 10.12]])
Coordinates:
  * lat      (lat) float64 10.0 11.0 12.0 13.0
  * lon      (lon) float64 120.0 120.6 121.2 121.9 122.5
</code></pre>
<h2 id="6-2-Excel文件"><a href="#6-2-Excel文件" class="headerlink" title="6.2 Excel文件"></a>6.2 Excel文件</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">dat = pd.read_excel(<span class="string">&#x27;/home/mw/input/pythonbook7300/read.xlsx&#x27;</span>, sheet_name=<span class="string">&#x27;Sheet1&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(dat)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;-----&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(dat.dtypes)</span><br></pre></td></tr></table></figure>

<pre><code>          时间  最高温度  降水
0 2020-01-01  10.3   0
1 2020-01-02  13.3   0
2 2020-01-03  12.1   0
3 2020-01-04   9.9   0
-----
时间      datetime64[ns]
最高温度           float64
降水               int64
dtype: object
</code></pre>
<h2 id="6-3-NetCDF文件"><a href="#6-3-NetCDF文件" class="headerlink" title="6.3  NetCDF文件"></a>6.3  NetCDF文件</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 读取NetCDF文件</span></span><br><span class="line"><span class="keyword">import</span> xarray <span class="keyword">as</span> xr</span><br><span class="line"><span class="comment"># 将文件路径改为自己的</span></span><br><span class="line">dataset = xr.open_dataset(<span class="string">&#x27;/home/mw/input/pythonbook9857/1980060106.nc&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(dataset)</span><br><span class="line">t = dataset[<span class="string">&#x27;t&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span>(t)</span><br></pre></td></tr></table></figure>

<pre><code>&lt;xarray.Dataset&gt;
Dimensions:    (longitude: 721, latitude: 361, level: 13, time: 1)
Coordinates:
  * longitude  (longitude) float32 0.0 0.25 0.5 0.75 ... 179.2 179.5 179.8 180.0
  * latitude   (latitude) float32 90.0 89.75 89.5 89.25 ... 0.75 0.5 0.25 0.0
  * level      (level) int32 1000 975 925 850 700 600 ... 300 250 200 150 100
  * time       (time) datetime64[ns] 1980-06-01T06:00:00
Data variables:
    pv         (time, level, latitude, longitude) float32 ...
    z          (time, level, latitude, longitude) float32 ...
    t          (time, level, latitude, longitude) float32 ...
    q          (time, level, latitude, longitude) float32 ...
    w          (time, level, latitude, longitude) float32 ...
    vo         (time, level, latitude, longitude) float32 ...
    d          (time, level, latitude, longitude) float32 ...
    u          (time, level, latitude, longitude) float32 ...
    v          (time, level, latitude, longitude) float32 ...
    r          (time, level, latitude, longitude) float32 ...
    clwc       (time, level, latitude, longitude) float32 ...
Attributes:
    Conventions:  CF-1.6
    history:      2017-03-27 13:09:45 GMT by grib_to_netcdf-2.1.0: grib_to_ne...
&lt;xarray.DataArray &#39;t&#39; (time: 1, level: 13, latitude: 361, longitude: 721)&gt;
[3383653 values with dtype=float32]
Coordinates:
  * longitude  (longitude) float32 0.0 0.25 0.5 0.75 ... 179.2 179.5 179.8 180.0
  * latitude   (latitude) float32 90.0 89.75 89.5 89.25 ... 0.75 0.5 0.25 0.0
  * level      (level) int32 1000 975 925 850 700 600 ... 300 250 200 150 100
  * time       (time) datetime64[ns] 1980-06-01T06:00:00
Attributes:
    units:          K
    long_name:      Temperature
    standard_name:  air_temperature
</code></pre>
<h2 id="6-4-GRIB文件"><a href="#6-4-GRIB文件" class="headerlink" title="6.4  GRIB文件"></a>6.4  GRIB文件</h2><h3 id="6-4-1-使用PyNIO"><a href="#6-4-1-使用PyNIO" class="headerlink" title="6.4.1  使用PyNIO"></a>6.4.1  使用PyNIO</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用PyNIO读取GRIB文件</span></span><br><span class="line"><span class="keyword">import</span> xarray <span class="keyword">as</span> xr</span><br><span class="line">dataset = xr.open_dataset(<span class="string">&#x27;/home/mw/input/pythonbook9857/fnl_201906011800.grib2&#x27;</span>, engine=<span class="string">&#x27;pynio&#x27;</span>) <span class="comment"># 将文件路径改为自己的</span></span><br><span class="line"><span class="built_in">print</span>(dataset)</span><br><span class="line">data = dataset[<span class="string">&#x27;TMP_P0_L1_GLL0&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span>(data)</span><br></pre></td></tr></table></figure>

<pre><code>&lt;xarray.Dataset&gt;
Dimensions:              (lat_0: 181, lon_0: 360, lv_ISBL0: 31, lv_AMSL1: 3, lv_HTGL2: 3, lv_PVL3: 2, lv_HTGL4: 2, lv_SIGL5: 4, lv_ISBL6: 21, lv_HTGL7: 3, lv_ISBL8: 26, lv_SPDL9: 2, lv_ISBL10: 17, lv_DBLL11: 4)
Coordinates:
  * lv_ISBL10            (lv_ISBL10) float32 100.0 200.0 300.0 ... 3.5e+04 4e+04
  * lv_ISBL8             (lv_ISBL8) float32 1e+03 2e+03 3e+03 ... 9.75e+04 1e+05
  * lv_HTGL7             (lv_HTGL7) float32 10.0 80.0 100.0
  * lv_ISBL6             (lv_ISBL6) float32 1e+04 1.5e+04 ... 9.75e+04 1e+05
  * lv_HTGL4             (lv_HTGL4) float32 2.0 80.0
  * lv_PVL3              (lv_PVL3) float32 -2e-06 2e-06
  * lv_HTGL2             (lv_HTGL2) float32 2.0 80.0 100.0
  * lv_AMSL1             (lv_AMSL1) float32 1.829e+03 2.743e+03 3.658e+03
  * lv_ISBL0             (lv_ISBL0) float32 100.0 200.0 300.0 ... 9.75e+04 1e+05
  * lat_0                (lat_0) float32 90.0 89.0 88.0 ... -88.0 -89.0 -90.0
  * lon_0                (lon_0) float32 0.0 1.0 2.0 3.0 ... 357.0 358.0 359.0
Dimensions without coordinates: lv_SIGL5, lv_SPDL9, lv_DBLL11
Data variables: (12/98)
    TMP_P0_L1_GLL0       (lat_0, lon_0) float32 ...
    TMP_P0_L6_GLL0       (lat_0, lon_0) float32 ...
    TMP_P0_L7_GLL0       (lat_0, lon_0) float32 ...
    TMP_P0_L100_GLL0     (lv_ISBL0, lat_0, lon_0) float32 ...
    TMP_P0_L102_GLL0     (lv_AMSL1, lat_0, lon_0) float32 ...
    TMP_P0_L103_GLL0     (lv_HTGL2, lat_0, lon_0) float32 ...
    ...                   ...
    lv_DBLL11_l1         (lv_DBLL11) float32 ...
    lv_DBLL11_l0         (lv_DBLL11) float32 ...
    lv_SPDL9_l1          (lv_SPDL9) float32 ...
    lv_SPDL9_l0          (lv_SPDL9) float32 ...
    lv_SIGL5_l1          (lv_SIGL5) float32 ...
    lv_SIGL5_l0          (lv_SIGL5) float32 ...
&lt;xarray.DataArray &#39;TMP_P0_L1_GLL0&#39; (lat_0: 181, lon_0: 360)&gt;
array([[273.23535, 273.23535, 273.23535, ..., 273.23535, 273.23535, 273.23535],
       [273.13535, 273.13535, 273.13535, ..., 273.13535, 273.13535, 273.13535],
       [273.13535, 273.13535, 273.13535, ..., 273.03537, 273.03537, 273.13535],
       ...,
       [219.43535, 219.43535, 219.53535, ..., 219.83536, 219.73535, 219.53535],
       [218.63536, 218.63536, 218.63536, ..., 218.63536, 218.63536, 218.73535],
       [219.93535, 219.93535, 219.93535, ..., 219.93535, 219.93535, 219.93535]],
      dtype=float32)
Coordinates:
  * lat_0    (lat_0) float32 90.0 89.0 88.0 87.0 ... -87.0 -88.0 -89.0 -90.0
  * lon_0    (lon_0) float32 0.0 1.0 2.0 3.0 4.0 ... 356.0 357.0 358.0 359.0
Attributes:
    center:                                         US National Weather Servi...
    production_status:                              Operational products
    long_name:                                      Temperature
    units:                                          K
    grid_type:                                      Latitude/longitude
    parameter_discipline_and_category:              Meteorological products, ...
    parameter_template_discipline_category_number:  [0 0 0 0]
    level_type:                                     Ground or water surface
    level:                                          [0.]
    forecast_time:                                  [0]
    forecast_time_units:                            hours
    initial_time:                                   06/01/2019 (18:00)
</code></pre>
<h3 id="6-4-2-使用cfgrib"><a href="#6-4-2-使用cfgrib" class="headerlink" title="6.4.2  使用cfgrib"></a>6.4.2  使用cfgrib</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 6.4.2  使用cfgrib读取GRIB文件</span></span><br><span class="line"><span class="keyword">import</span> xarray <span class="keyword">as</span> xr</span><br><span class="line"><span class="comment"># 将文件路径改为自己的</span></span><br><span class="line">dataset = xr.open_dataset(<span class="string">&#x27;/home/mw/input/pythonbook9857/fnl_201906011800.grib2&#x27;</span>, </span><br><span class="line">                      engine=<span class="string">&#x27;cfgrib&#x27;</span>,</span><br><span class="line">                      backend_kwargs=&#123;</span><br><span class="line">                         <span class="string">&#x27;filter_by_keys&#x27;</span>: &#123;</span><br><span class="line">                            <span class="string">&#x27;typeOfLevel&#x27;</span>: <span class="string">&#x27;isobaricInhPa&#x27;</span></span><br><span class="line">                         &#125;</span><br><span class="line">                      &#125;</span><br><span class="line">                     )</span><br><span class="line"><span class="built_in">print</span>(dataset)</span><br><span class="line"><span class="built_in">print</span>(dataset[<span class="string">&#x27;u&#x27;</span>])</span><br></pre></td></tr></table></figure>

<pre><code>skipping variable: paramId==260131 shortName=&#39;o3mr&#39;
Traceback (most recent call last):
  File &quot;/opt/conda/lib/python3.7/site-packages/cfgrib/dataset.py&quot;, line 660, in build_dataset_components
    dict_merge(variables, coord_vars)
  File &quot;/opt/conda/lib/python3.7/site-packages/cfgrib/dataset.py&quot;, line 593, in dict_merge
    &quot;key=%r value=%r new_value=%r&quot; % (key, master[key], value)
cfgrib.dataset.DatasetBuildError: key present and new value is different: key=&#39;isobaricInhPa&#39; value=Variable(dimensions=(&#39;isobaricInhPa&#39;,), data=array([1000.,  975.,  950.,  925.,  900.,  850.,  800.,  750.,  700.,
        650.,  600.,  550.,  500.,  450.,  400.,  350.,  300.,  250.,
        200.,  150.,  100.,   70.,   50.,   30.,   20.,   10.,    7.,
          5.,    3.,    2.,    1.])) new_value=Variable(dimensions=(&#39;isobaricInhPa&#39;,), data=array([400., 350., 300., 250., 200., 150., 100.,  70.,  50.,  30.,  20.,
        10.,   7.,   5.,   3.,   2.,   1.]))
skipping variable: paramId==3041 shortName=&#39;absv&#39;
Traceback (most recent call last):
  File &quot;/opt/conda/lib/python3.7/site-packages/cfgrib/dataset.py&quot;, line 660, in build_dataset_components
    dict_merge(variables, coord_vars)
  File &quot;/opt/conda/lib/python3.7/site-packages/cfgrib/dataset.py&quot;, line 593, in dict_merge
    &quot;key=%r value=%r new_value=%r&quot; % (key, master[key], value)
cfgrib.dataset.DatasetBuildError: key present and new value is different: key=&#39;isobaricInhPa&#39; value=Variable(dimensions=(&#39;isobaricInhPa&#39;,), data=array([1000.,  975.,  950.,  925.,  900.,  850.,  800.,  750.,  700.,
        650.,  600.,  550.,  500.,  450.,  400.,  350.,  300.,  250.,
        200.,  150.,  100.,   70.,   50.,   30.,   20.,   10.,    7.,
          5.,    3.,    2.,    1.])) new_value=Variable(dimensions=(&#39;isobaricInhPa&#39;,), data=array([1000.,  975.,  950.,  925.,  900.,  850.,  800.,  750.,  700.,
        650.,  600.,  550.,  500.,  450.,  400.,  350.,  300.,  250.,
        200.,  150.,  100.,   70.,   50.,   30.,   20.,   10.]))
skipping variable: paramId==135 shortName=&#39;w&#39;
Traceback (most recent call last):
  File &quot;/opt/conda/lib/python3.7/site-packages/cfgrib/dataset.py&quot;, line 660, in build_dataset_components
    dict_merge(variables, coord_vars)
  File &quot;/opt/conda/lib/python3.7/site-packages/cfgrib/dataset.py&quot;, line 593, in dict_merge
    &quot;key=%r value=%r new_value=%r&quot; % (key, master[key], value)
cfgrib.dataset.DatasetBuildError: key present and new value is different: key=&#39;isobaricInhPa&#39; value=Variable(dimensions=(&#39;isobaricInhPa&#39;,), data=array([1000.,  975.,  950.,  925.,  900.,  850.,  800.,  750.,  700.,
        650.,  600.,  550.,  500.,  450.,  400.,  350.,  300.,  250.,
        200.,  150.,  100.,   70.,   50.,   30.,   20.,   10.,    7.,
          5.,    3.,    2.,    1.])) new_value=Variable(dimensions=(&#39;isobaricInhPa&#39;,), data=array([1000.,  975.,  950.,  925.,  900.,  850.,  800.,  750.,  700.,
        650.,  600.,  550.,  500.,  450.,  400.,  350.,  300.,  250.,
        200.,  150.,  100.]))
skipping variable: paramId==260018 shortName=&#39;clwmr&#39;
Traceback (most recent call last):
  File &quot;/opt/conda/lib/python3.7/site-packages/cfgrib/dataset.py&quot;, line 660, in build_dataset_components
    dict_merge(variables, coord_vars)
  File &quot;/opt/conda/lib/python3.7/site-packages/cfgrib/dataset.py&quot;, line 593, in dict_merge
    &quot;key=%r value=%r new_value=%r&quot; % (key, master[key], value)
cfgrib.dataset.DatasetBuildError: key present and new value is different: key=&#39;isobaricInhPa&#39; value=Variable(dimensions=(&#39;isobaricInhPa&#39;,), data=array([1000.,  975.,  950.,  925.,  900.,  850.,  800.,  750.,  700.,
        650.,  600.,  550.,  500.,  450.,  400.,  350.,  300.,  250.,
        200.,  150.,  100.,   70.,   50.,   30.,   20.,   10.,    7.,
          5.,    3.,    2.,    1.])) new_value=Variable(dimensions=(&#39;isobaricInhPa&#39;,), data=array([1000.,  975.,  950.,  925.,  900.,  850.,  800.,  750.,  700.,
        650.,  600.,  550.,  500.,  450.,  400.,  350.,  300.,  250.,
        200.,  150.,  100.]))
skipping variable: paramId==260080 shortName=&#39;5wavh&#39;
Traceback (most recent call last):
  File &quot;/opt/conda/lib/python3.7/site-packages/cfgrib/dataset.py&quot;, line 660, in build_dataset_components
    dict_merge(variables, coord_vars)
  File &quot;/opt/conda/lib/python3.7/site-packages/cfgrib/dataset.py&quot;, line 593, in dict_merge
    &quot;key=%r value=%r new_value=%r&quot; % (key, master[key], value)
cfgrib.dataset.DatasetBuildError: key present and new value is different: key=&#39;isobaricInhPa&#39; value=Variable(dimensions=(&#39;isobaricInhPa&#39;,), data=array([1000.,  975.,  950.,  925.,  900.,  850.,  800.,  750.,  700.,
        650.,  600.,  550.,  500.,  450.,  400.,  350.,  300.,  250.,
        200.,  150.,  100.,   70.,   50.,   30.,   20.,   10.,    7.,
          5.,    3.,    2.,    1.])) new_value=Variable(dimensions=(), data=500.0)


&lt;xarray.Dataset&gt;
Dimensions:        (isobaricInhPa: 31, latitude: 181, longitude: 360)
Coordinates:
    time           datetime64[ns] ...
    step           timedelta64[ns] ...
  * isobaricInhPa  (isobaricInhPa) float64 1e+03 975.0 950.0 ... 3.0 2.0 1.0
  * latitude       (latitude) float64 90.0 89.0 88.0 87.0 ... -88.0 -89.0 -90.0
  * longitude      (longitude) float64 0.0 1.0 2.0 3.0 ... 357.0 358.0 359.0
    valid_time     datetime64[ns] ...
Data variables:
    gh             (isobaricInhPa, latitude, longitude) float32 ...
    t              (isobaricInhPa, latitude, longitude) float32 ...
    r              (isobaricInhPa, latitude, longitude) float32 ...
    u              (isobaricInhPa, latitude, longitude) float32 ...
    v              (isobaricInhPa, latitude, longitude) float32 ...
Attributes:
    GRIB_edition:            2
    GRIB_centre:             kwbc
    GRIB_centreDescription:  US National Weather Service - NCEP 
    GRIB_subCentre:          0
    Conventions:             CF-1.7
    institution:             US National Weather Service - NCEP 
    history:                 2023-03-02T09:18 GRIB to CDM+CF via cfgrib-0.9.9...
&lt;xarray.DataArray &#39;u&#39; (isobaricInhPa: 31, latitude: 181, longitude: 360)&gt;
[2019960 values with dtype=float32]
Coordinates:
    time           datetime64[ns] ...
    step           timedelta64[ns] ...
  * isobaricInhPa  (isobaricInhPa) float64 1e+03 975.0 950.0 ... 3.0 2.0 1.0
  * latitude       (latitude) float64 90.0 89.0 88.0 87.0 ... -88.0 -89.0 -90.0
  * longitude      (longitude) float64 0.0 1.0 2.0 3.0 ... 357.0 358.0 359.0
    valid_time     datetime64[ns] ...
Attributes: (12/29)
    GRIB_paramId:                             131
    GRIB_dataType:                            fc
    GRIB_numberOfPoints:                      65160
    GRIB_typeOfLevel:                         isobaricInhPa
    GRIB_stepUnits:                           1
    GRIB_stepType:                            instant
    ...                                       ...
    GRIB_name:                                U component of wind
    GRIB_shortName:                           u
    GRIB_units:                               m s**-1
    long_name:                                U component of wind
    units:                                    m s**-1
    standard_name:                            eastward_wind
</code></pre>
<h2 id="6-5-GrADS二进制文件"><a href="#6-5-GrADS二进制文件" class="headerlink" title="6.5  GrADS二进制文件"></a>6.5  GrADS二进制文件</h2><h3 id="6-5-1-站点数据"><a href="#6-5-1-站点数据" class="headerlink" title="6.5.1  站点数据"></a>6.5.1  站点数据</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定义如下读取函数</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">grads_sta</span>(<span class="params">path_file, n_sta, n_time</span>):</span><br><span class="line">    dt = np.dtype([(<span class="string">&#x27;sta&#x27;</span>, <span class="string">&#x27;S8&#x27;</span>), (<span class="string">&#x27;lat&#x27;</span>, <span class="string">&#x27;f4&#x27;</span>), (<span class="string">&#x27;lon&#x27;</span>, <span class="string">&#x27;f4&#x27;</span>), </span><br><span class="line">                   (<span class="string">&#x27;time&#x27;</span>, <span class="string">&#x27;f4&#x27;</span>), (<span class="string">&#x27;nlev&#x27;</span>, <span class="string">&#x27;i4&#x27;</span>), (<span class="string">&#x27;nflag&#x27;</span>, <span class="string">&#x27;i4&#x27;</span>),</span><br><span class="line">                   (<span class="string">&#x27;var&#x27;</span>, <span class="string">&#x27;f4&#x27;</span>)])</span><br><span class="line">    df_group = []</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(path_file, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> fid:</span><br><span class="line">         <span class="keyword">for</span> t <span class="keyword">in</span> <span class="built_in">range</span>(n_time):</span><br><span class="line">               data_raw = np.frombuffer(fid.read(n_sta * <span class="number">32</span>), dtype=dt)</span><br><span class="line">               fid.read(<span class="number">28</span>)</span><br><span class="line">               df = pd.DataFrame(data_raw)         </span><br><span class="line">               <span class="keyword">try</span>:</span><br><span class="line">                   df[<span class="string">&#x27;sta&#x27;</span>] = [x.decode() <span class="keyword">for</span> x <span class="keyword">in</span> df[<span class="string">&#x27;sta&#x27;</span>]]</span><br><span class="line">               <span class="keyword">except</span>:</span><br><span class="line">                   <span class="keyword">pass</span></span><br><span class="line">               df_group.append(df)</span><br><span class="line">    <span class="keyword">return</span> df_group</span><br><span class="line"><span class="comment"># 读取示例文件，可参考.ctl描述文件</span></span><br><span class="line">dat = grads_sta(<span class="string">&#x27;/home/mw/input/pythonbook9857/r160.grd&#x27;</span>, <span class="number">160</span>, <span class="number">1</span>) <span class="comment"># 将文件路径改为自己的</span></span><br><span class="line"><span class="built_in">print</span>(dat)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(dat))</span><br></pre></td></tr></table></figure>

<pre><code>[                sta        lat         lon  time  nlev  nflag       var
0    b&#39;\x01       &#39;  51.720001  126.650002   0.0     1      1  0.098331
1    b&#39;\x02       &#39;  48.770000  121.919998   0.0     1      1 -0.167619
2    b&#39;\x03       &#39;  49.220001  119.750000   0.0     1      1 -0.064597
3    b&#39;\x04       &#39;  50.450001  121.699997   0.0     1      1 -0.046360
4    b&#39;\x05       &#39;  49.169998  125.230003   0.0     1      1  0.017577
..              ...        ...         ...   ...   ...    ...       ...
155  b&#39;\x9c       &#39;  47.730000   88.080002   0.0     1      1 -0.036620
156  b&#39;\x9d       &#39;  46.730000   83.000000   0.0     1      1  0.071207
157  b&#39;\x9e       &#39;  44.430000   84.660004   0.0     1      1 -0.205051
158  b&#39;\x9f       &#39;  43.950001   81.330002   0.0     1      1  0.170275
159  b&#39;\xa0       &#39;  43.779999   87.620003   0.0     1      1 -0.103539

[160 rows x 7 columns]]
&lt;class &#39;list&#39;&gt;
</code></pre>
<h3 id="6-5-2-栅格数据"><a href="#6-5-2-栅格数据" class="headerlink" title="6.5.2  栅格数据"></a>6.5.2  栅格数据</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定义如下读取函数</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> xarray <span class="keyword">as</span> xr</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">grads_grid</span>(<span class="params">path_file, nx, ny, nt,</span></span><br><span class="line"><span class="params">             lon_0, lon_step, lat_0, lat_step,</span></span><br><span class="line"><span class="params">             t_0, t_freq, var_list, z_list</span>):</span><br><span class="line">   data_raw = np.fromfile(path_file, dtype=np.float32)</span><br><span class="line">   n_var = <span class="built_in">len</span>(var_list)</span><br><span class="line">   nz = <span class="built_in">len</span>(z_list)</span><br><span class="line">   data_raw = data_raw.reshape((nt, n_var, nz, ny, nx))</span><br><span class="line">   time_list = pd.date_range(t_0, periods=nt, freq=t_freq)</span><br><span class="line">   lon = np.arange(lon_0, lon_0 + lon_step * nx, lon_step)</span><br><span class="line">   lat = np.arange(lat_0, lat_0 + lat_step * ny, lat_step)</span><br><span class="line">   data = xr.DataArray(data_raw,</span><br><span class="line">                    coords=[time_list, var_list, z_list, lat, lon],</span><br><span class="line">                    dims=[<span class="string">&#x27;time&#x27;</span>, <span class="string">&#x27;var&#x27;</span>, <span class="string">&#x27;level&#x27;</span>, <span class="string">&#x27;lat&#x27;</span>, <span class="string">&#x27;lon&#x27;</span>]</span><br><span class="line">                   ).to_dataset(<span class="string">&#x27;var&#x27;</span>)</span><br><span class="line">   <span class="keyword">return</span> data</span><br><span class="line"><span class="comment"># 读取示例文件，可参考.ctl描述文件</span></span><br><span class="line">dataset = grads_grid(<span class="string">&#x27;/home/mw/input/pythonbook9857/hgt500.grd&#x27;</span>,</span><br><span class="line">                  nx=<span class="number">144</span>, ny=<span class="number">73</span>, nt=<span class="number">732</span>,</span><br><span class="line">                  lon_0=<span class="number">0</span>, lon_step=<span class="number">2.5</span>, lat_0=-<span class="number">90</span>, lat_step=<span class="number">2.5</span>,</span><br><span class="line">                  t_0=<span class="string">&#x27;1948-01-01&#x27;</span>, t_freq=<span class="string">&#x27;1M&#x27;</span>, var_list=[<span class="string">&#x27;hgt&#x27;</span>],</span><br><span class="line">                  z_list=[<span class="number">500</span>])</span><br><span class="line"><span class="built_in">print</span>(dataset)</span><br></pre></td></tr></table></figure>

<pre><code>&lt;xarray.Dataset&gt;
Dimensions:  (time: 732, level: 1, lat: 73, lon: 144)
Coordinates:
  * time     (time) datetime64[ns] 1948-01-31 1948-02-29 ... 2008-12-31
  * level    (level) int64 500
  * lat      (lat) float64 -90.0 -87.5 -85.0 -82.5 -80.0 ... 82.5 85.0 87.5 90.0
  * lon      (lon) float64 0.0 2.5 5.0 7.5 10.0 ... 350.0 352.5 355.0 357.5
Data variables:
    hgt      (time, level, lat, lon) float32 5.189e+03 5.189e+03 ... 5.075e+03
</code></pre>
<h2 id="6-6-WRF-ARW输出文件"><a href="#6-6-WRF-ARW输出文件" class="headerlink" title="6.6  WRF-ARW输出文件"></a>6.6  WRF-ARW输出文件</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 读取WRF-ARW输出文件</span></span><br><span class="line"><span class="keyword">import</span> xarray <span class="keyword">as</span> xr</span><br><span class="line"><span class="keyword">import</span> wrf</span><br><span class="line"><span class="keyword">from</span> netCDF4 <span class="keyword">import</span> Dataset</span><br><span class="line"><span class="comment"># 将文件路径改为自己的</span></span><br><span class="line">ncfile = Dataset(<span class="string">&#x27;/home/mw/input/pythonbook9857/wrfout_d01_2017-08-10_000000.nc&#x27;</span>)</span><br><span class="line">p = wrf.getvar(ncfile,  <span class="string">&#x27;pressure&#x27;</span>, timeidx=wrf.ALL_TIMES)   <span class="comment"># 对于getvar()函数，可以指定timeidx参数的值为整数以选择提取时次，例如timeidx=0</span></span><br><span class="line">rh = wrf.getvar(ncfile,  <span class="string">&#x27;rh&#x27;</span>, timeidx=wrf.ALL_TIMES) <span class="comment"># timeidx=wrf.ALL_TIMES表明提取全部时次</span></span><br><span class="line"><span class="built_in">print</span>(rh)</span><br><span class="line"><span class="comment"># 将数据插值到等压面</span></span><br><span class="line">rh_500 = wrf.interplevel(rh, p, <span class="number">500</span>) <span class="comment"># interplevel()函数支持同时插值到多个等压面</span></span><br><span class="line">rh_850_to_500 = wrf.interplevel(rh, p, [<span class="number">850</span>, <span class="number">700</span>, <span class="number">500</span>])</span><br><span class="line"><span class="built_in">print</span>(rh_850_to_500)</span><br></pre></td></tr></table></figure>

<pre><code>&lt;xarray.DataArray &#39;rh&#39; (Time: 5, bottom_top: 29, south_north: 49, west_east: 79)&gt;
array([[[[87.765434 , 85.98064  , 84.91124  , ..., 81.3592   ,
          79.81483  , 81.41704  ],
         [87.995636 , 86.22767  , 85.25411  , ..., 83.49108  ,
          81.253586 , 81.55239  ],
         [88.70185  , 87.21322  , 86.30212  , ..., 84.36489  ,
          83.808624 , 83.382866 ],
         ...,
         [43.890274 , 45.305763 , 46.74152  , ..., 79.794525 ,
          79.27631  , 78.8375   ],
         [39.819405 , 41.26361  , 42.63604  , ..., 79.73092  ,
          79.23843  , 78.76903  ],
         [37.56467  , 38.025745 , 39.262104 , ..., 79.73279  ,
          79.23924  , 78.71969  ]],

        [[89.051445 , 86.849625 , 85.17071  , ..., 79.81156  ,
          78.14068  , 79.16232  ],
         [89.22471  , 87.07232  , 85.47679  , ..., 81.908    ,
          80.53091  , 80.28641  ],
         [89.795204 , 87.968445 , 86.57346  , ..., 83.796936 ,
          82.867424 , 82.598114 ],
...
         [ 4.049299 ,  4.0986323,  4.12636  , ...,  6.4341807,
           6.5087857,  6.608485 ],
         [ 3.9992058,  4.052754 ,  4.0801926, ...,  6.392681 ,
           6.4727077,  6.563373 ],
         [ 3.947622 ,  3.9738657,  4.002276 , ...,  6.363432 ,
           6.4367847,  6.513951 ]],

        [[ 4.21838  ,  4.2060227,  4.201893 , ...,  5.0465074,
           5.0882134,  5.14203  ],
         [ 4.2712355,  4.2646527,  4.2615657, ...,  5.06661  ,
           5.1020627,  5.126723 ],
         [ 4.3191833,  4.324505 ,  4.3139987, ...,  5.089982 ,
           5.105507 ,  5.109809 ],
         ...,
         [ 3.166993 ,  3.1939094,  3.2173321, ...,  4.870332 ,
           4.891847 ,  4.9187264],
         [ 3.1322336,  3.1641045,  3.1914012, ...,  4.8407125,
           4.8697286,  4.8977094],
         [ 3.100257 ,  3.123251 ,  3.1545112, ...,  4.8102155,
           4.8391423,  4.8720045]]]], dtype=float32)
Coordinates:
    XLONG    (south_north, west_east) float32 113.2 113.3 113.4 ... 121.3 121.4
    XLAT     (south_north, west_east) float32 29.68 29.68 29.68 ... 33.99 33.99
    XTIME    (Time) float32 0.0 180.0 360.0 540.0 720.0
  * Time     (Time) datetime64[ns] 2017-08-10 ... 2017-08-10T12:00:00
Dimensions without coordinates: bottom_top, south_north, west_east
Attributes:
    FieldType:    104
    MemoryOrder:  XYZ
    description:  relative humidity
    units:        %
    stagger:      
    coordinates:  XLONG XLAT XTIME
    projection:   LambertConformal(stand_lon=117.19999694824219, moad_cen_lat...
&lt;xarray.DataArray &#39;rh_interp&#39; (Time: 5, level: 3, south_north: 49, west_east: 79)&gt;
array([[[[ 49.581455 ,  49.90141  ,  49.964336 , ...,  93.02744  ,
           92.50517  ,  91.436905 ],
         [ 49.854908 ,  50.216183 ,  50.33729  , ...,  94.29466  ,
           93.958336 ,  92.881165 ],
         [ 50.29943  ,  50.652588 ,  50.81059  , ...,  94.8869   ,
           94.64059  ,  94.331085 ],
         ...,
         [ 43.85136  ,  44.185024 ,  44.534695 , ...,  65.72999  ,
           66.07933  ,  66.988106 ],
         [ 43.501328 ,  43.93895  ,  44.335472 , ...,  66.38105  ,
           66.68885  ,  67.59361  ],
         [ 43.071743 ,  43.59577  ,  44.11645  , ...,  67.04757  ,
           67.32303  ,  68.26489  ]],

        [[ 59.510532 ,  58.794968 ,  58.20066  , ...,  88.38223  ,
           89.8404   ,  90.4845   ],
         [ 60.2473   ,  59.721775 ,  59.27535  , ...,  88.13034  ,
           89.4728   ,  90.00002  ],
         [ 60.890114 ,  60.67282  ,  60.48124  , ...,  87.15515  ,
           88.844986 ,  89.848656 ],
...
         [ 32.703304 ,  32.478714 ,  32.44395  , ...,  50.050068 ,
           50.41752  ,  50.632175 ],
         [ 33.32784  ,  33.011208 ,  32.852413 , ...,  48.91975  ,
           49.255787 ,  49.405983 ],
         [ 34.13029  ,  33.958523 ,  33.643333 , ...,  47.629578 ,
           47.947124 ,  48.399437 ]],

        [[ 24.025608 ,  23.000294 ,  21.980774 , ...,  16.391787 ,
           17.90786  ,  19.738607 ],
         [ 20.825268 ,  20.007761 ,  19.12427  , ...,  12.906076 ,
           14.448949 ,  16.162752 ],
         [ 18.05197  ,  17.35045  ,  16.605772 , ...,  12.18835  ,
           12.27763  ,  14.094156 ],
         ...,
         [  4.564085 ,   4.439832 ,   4.360229 , ...,  18.472599 ,
           19.609535 ,  19.641474 ],
         [  4.6399007,   4.5138626,   4.4195275, ...,  18.654158 ,
           19.900602 ,  20.3621   ],
         [  4.7261467,   4.597047 ,   4.4673424, ...,  18.454733 ,
           19.761063 ,  20.774572 ]]]], dtype=float32)
Coordinates:
    XLONG    (south_north, west_east) float32 113.2 113.3 113.4 ... 121.3 121.4
    XLAT     (south_north, west_east) float32 29.68 29.68 29.68 ... 33.99 33.99
    XTIME    (Time) float32 0.0 180.0 360.0 540.0 720.0
  * Time     (Time) datetime64[ns] 2017-08-10 ... 2017-08-10T12:00:00
  * level    (level) int64 850 700 500
Dimensions without coordinates: south_north, west_east
Attributes:
    FieldType:      104
    units:          %
    stagger:        
    coordinates:    XLONG XLAT XTIME
    projection:     LambertConformal(stand_lon=117.19999694824219, moad_cen_l...
    missing_value:  9.969209968386869e+36
    _FillValue:     9.969209968386869e+36
    vert_units:     hPa
</code></pre>
<h2 id="6-7-雷达基数据文件"><a href="#6-7-雷达基数据文件" class="headerlink" title="6.7  雷达基数据文件"></a>6.7  雷达基数据文件</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> cinrad</span><br><span class="line">f = cinrad.io.CinradReader(<span class="string">&#x27;/home/mw/input/pythonbook9857/RADA_CHN_DOR_L2_O-Z9551-SA-CAP-20200708032300.bin.bz2&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(f.available_product(<span class="number">0</span>))</span><br><span class="line"><span class="comment"># 读取反射率</span></span><br><span class="line">tilt_number = <span class="number">0</span></span><br><span class="line">data_radius = <span class="number">230</span></span><br><span class="line">r = f.get_data(tilt_number, data_radius, <span class="string">&#x27;REF&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(r)</span><br></pre></td></tr></table></figure>

<pre><code>[&#39;REF&#39;, &#39;VEL&#39;, &#39;SW&#39;, &#39;azimuth&#39;, &#39;RF&#39;]
&lt;xarray.Dataset&gt;
Dimensions:    (azimuth: 366, distance: 230)
Coordinates:
  * azimuth    (azimuth) float64 1.38 1.397 1.415 1.432 ... 1.349 1.366 1.383
  * distance   (distance) float64 1.0 2.0 3.0 4.0 ... 227.0 228.0 229.0 230.0
Data variables:
    REF        (azimuth, distance) float64 nan -8.5 2.0 2.0 ... nan nan nan nan
    longitude  (azimuth, distance) float64 117.3 117.3 117.3 ... 119.7 119.7
    latitude   (azimuth, distance) float64 31.87 31.87 31.87 ... 32.25 32.25
    height     (azimuth, distance) float64 0.1764 0.1873 0.1983 ... 5.709 5.747
Attributes:
    elevation:        0.615234375
    range:            230
    scan_time:        2020-07-08 03:23:11.811000
    site_code:        Z9551
    site_name:        合肥
    site_longitude:   117.25777777777778
    site_latitude:    31.866944444444446
    tangential_reso:  1.0
    nyquist_vel:      8.52
    task:             VCP21
</code></pre>
<h2 id="6-8-CIMISS的使用"><a href="#6-8-CIMISS的使用" class="headerlink" title="6.8  CIMISS的使用"></a>6.8  CIMISS的使用</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> cimiss</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="comment"># host 不带http前缀，通常为zero-ice服务的纯IP地址</span></span><br><span class="line">client = cimiss.Query(user_id=<span class="string">&#x27;myuserid&#x27;</span>, password=<span class="string">&#x27;mypasswd&#x27;</span>, host=<span class="string">&#x27;myhost&#x27;</span>)  <span class="comment"># 请修改为你的账号、密码、IP地址</span></span><br><span class="line">resp_array_2d = client.array_2d(</span><br><span class="line">   interface_id=<span class="string">&quot;getSurfEleByTime&quot;</span>,</span><br><span class="line">   params=&#123;</span><br><span class="line">      <span class="string">&quot;dataCode&quot;</span>: <span class="string">&quot;SURF_CHN_MUL_HOR&quot;</span>,</span><br><span class="line">      <span class="string">&quot;elements&quot;</span>: <span class="string">&quot;Station_ID_C,PRE_1h,PRS&quot;</span>,</span><br><span class="line">      <span class="string">&quot;times&quot;</span>: <span class="string">&quot;20181224000000&quot;</span>,</span><br><span class="line">      <span class="string">&quot;orderby&quot;</span>: <span class="string">&quot;Station_ID_C:ASC&quot;</span>,</span><br><span class="line">      <span class="string">&quot;limitCnt&quot;</span>: <span class="string">&quot;3&quot;</span>,</span><br><span class="line">   &#125;,</span><br><span class="line">   dtypes=&#123;<span class="string">&#x27;PRE_1h&#x27;</span>: np.<span class="built_in">float</span>, <span class="string">&#x27;PRS&#x27;</span>: np.<span class="built_in">float</span>&#125;</span><br><span class="line">)</span><br><span class="line"><span class="built_in">print</span>(resp_array_2d)</span><br></pre></td></tr></table></figure>
<script src="https://utteranc.es/client.js"
        repo="Nuist666/blog_comment"
        issue-term="python气象信息系统工程 第六章"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python-%E6%B0%94%E8%B1%A1%E4%BF%A1%E6%81%AF%E7%B3%BB%E7%BB%9F%E5%B7%A5%E7%A8%8B/" rel="tag">python,气象信息系统工程</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/%E5%B0%8F%E4%B9%A6%E5%8C%A0-python/">/小书匠/python</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
      
    
  </div>
  
</article>







  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/page/8/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="page-number" href="/page/8/">8</a><span class="page-number current">9</span><a class="page-number" href="/page/10/">10</a><a class="page-number" href="/page/11/">11</a><span class="space">&hellip;</span><a class="page-number" href="/page/15/">15</a><a class="extend next" rel="next" href="/page/10/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
      <div class="footer-left">
        &copy; 2024 Nuist666
      </div>
        <div class="footer-right">
          <a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/preccrep/hexo-theme-jelly" target="_blank">Jelly</a>
        </div>
    </div>
  </div>
</footer>
    </div>
    
  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">



<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: false,
		animate: true,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>

<script src="/js/main.js"></script>




  </div>
</body>
</html>