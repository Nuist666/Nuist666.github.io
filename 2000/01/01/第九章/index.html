<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>python气象信息系统工程 第九章 | Nuist666的个人博客</title>

  <!-- keywords -->
  

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="第9章 基本绘图类型与气象绘图9.1 折线图9.1.1 基本折线图12345678910111213141516171819import pandas as pdimport matplotlib.pyplot as pltimport numpy as np#读取数据ao &#x3D; pd.read_csv(&quot;&#x2F;home&#x2F;mw&#x2F;input&#x2F;pythonbook9857&#x2F;AO.txt&quot;">
<meta property="og:type" content="article">
<meta property="og:title" content="python气象信息系统工程 第九章">
<meta property="og:url" content="https://nuist666.github.io/2000/01/01/%E7%AC%AC%E4%B9%9D%E7%AB%A0/index.html">
<meta property="og:site_name" content="Nuist666的个人博客">
<meta property="og:description" content="第9章 基本绘图类型与气象绘图9.1 折线图9.1.1 基本折线图12345678910111213141516171819import pandas as pdimport matplotlib.pyplot as pltimport numpy as np#读取数据ao &#x3D; pd.read_csv(&quot;&#x2F;home&#x2F;mw&#x2F;input&#x2F;pythonbook9857&#x2F;AO.txt&quot;">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.kesci.com/upload/rt/007D9BDBF34A4FAC985D4A19150C944E/rpaviw4zd7.png">
<meta property="og:image" content="https://cdn.kesci.com/upload/rt/BFE2ABDA23A64B048D152018B47D9EA1/rpaviwes7o.png">
<meta property="og:image" content="https://cdn.kesci.com/upload/rt/1B56F02ECE274140805A108D4A8E58B3/rpaviwtcq.png">
<meta property="og:image" content="https://cdn.kesci.com/upload/rt/C5BBD34C3272422F95EB160077FAF3A9/rpavixh8wa.png">
<meta property="og:image" content="https://cdn.kesci.com/upload/rt/A2C6178E45A8442081D83665555370C9/rpaviz2bt4.png">
<meta property="og:image" content="https://cdn.kesci.com/upload/rt/E1EE60EAE2204E0183767B39C33B415A/rpaviznobd.png">
<meta property="og:image" content="https://cdn.kesci.com/upload/rt/81A16A298C614F4485B439D13A8404BA/rpaviz8xjl.png">
<meta property="og:image" content="https://cdn.kesci.com/upload/rt/1C93B81B383B40C48B3F0F091C9C2927/rpavj0al4s.png">
<meta property="og:image" content="https://cdn.kesci.com/upload/rt/BF204CF2415B4BC6B417DBDEC7BD2F48/rpavj0tjod.png">
<meta property="og:image" content="https://cdn.kesci.com/upload/rt/514C49B4201A42BFAF669D37BE738C40/rpavj03dcg.png">
<meta property="og:image" content="https://cdn.kesci.com/upload/rt/0B4088473BA445BE8DD741CDE2F86D7F/rpavj0p0k9.png">
<meta property="og:image" content="https://cdn.kesci.com/upload/rt/3096792C73A940238AAB0418BD89FA94/rpavj17o51.png">
<meta property="og:image" content="https://cdn.kesci.com/upload/rt/9896D419836B47FD822E83D0633402D4/rpavj2lf5u.png">
<meta property="og:image" content="https://cdn.kesci.com/upload/rt/937DF59A49A440A6A96E807AB5D9DEE9/rpavj3nfr3.png">
<meta property="og:image" content="https://cdn.kesci.com/upload/rt/6E420A264DE04AF38B82A622099C39A1/rpavj8xfz3.png">
<meta property="og:image" content="https://cdn.kesci.com/upload/rt/7D95DD331CAC402783018CA3C64ED893/rpavj91f06.png">
<meta property="og:image" content="https://cdn.kesci.com/upload/rt/1A6B6BBFCBA84C658FB51FFC511B159A/rpavjbm29n.png">
<meta property="og:image" content="https://cdn.kesci.com/upload/rt/1BF0218CC6C74A96A105C1931A5BB2A3/rpavjcgav2.png">
<meta property="og:image" content="https://cdn.kesci.com/upload/rt/FD5C1EF2AA7F4B3185451EBD419367BC/rpavjm9f9t.png">
<meta property="og:image" content="https://cdn.kesci.com/upload/rt/B516128783154EB88AB470D77DC7C827/rpavjm5mi0.png">
<meta property="og:image" content="https://cdn.kesci.com/upload/rt/1DC9F8E9520449BC86E66547DF64105F/rpavjqvjdn.png">
<meta property="og:image" content="https://cdn.kesci.com/upload/rt/54995A7C93274110A934EA57E9FA4B20/rpavjq1vfh.png">
<meta property="og:image" content="https://cdn.kesci.com/upload/rt/7944862F31E84FFA81D993B496F00B0B/rpavjtv1b7.png">
<meta property="og:image" content="https://cdn.kesci.com/upload/rt/DE659CBF04354BB4AE03B0CE22D257C1/rpavjtdguu.png">
<meta property="og:image" content="https://cdn.kesci.com/upload/rt/0F160E6F5736404CA78EBE4424CEEA41/rpavjtpf0n.png">
<meta property="og:image" content="https://cdn.kesci.com/upload/rt/31E3F8F2C21D4E3491E3575DD238BE7E/rpavmj1b7k.png">
<meta property="og:image" content="https://cdn.kesci.com/upload/rt/0150910F15BC4AC587675C5760D4024C/rpavmw9ohh.png">
<meta property="article:published_time" content="1999-12-31T16:09:00.000Z">
<meta property="article:modified_time" content="1999-12-31T16:09:00.000Z">
<meta property="article:author" content="Nuist666">
<meta property="article:tag" content="python,气象信息系统工程">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.kesci.com/upload/rt/007D9BDBF34A4FAC985D4A19150C944E/rpaviw4zd7.png">
  
    <link rel="alternative" href="/atom.xml" title="Nuist666的个人博客" type="application/atom+xml">
  
  
    <link rel="icon" href="/img/favicon.ico">
  
  
<link rel="stylesheet" href="/css/style.css">

  
  

  
<script src="//cdn.bootcss.com/require.js/2.3.2/require.min.js"></script>

  
<script src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script>


  
<meta name="generator" content="Hexo 7.1.1"></head>
<body>
  <div id="container">
    <div id="particles-js"></div>
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
				<img lazy-src="/img/avatar.png" class="js-avatar">
			
		</a>

		<hgroup>
			<h1 class="header-author"><a href="/">Nuist666</a></h1>
		</hgroup>

		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">Home</a></li>
				        
							<li><a href="/archives">Archives</a></li>
				        
						</ul>
					</nav>
					<nav class="half-header-menu">
						<a class="hide">Home</a>
						<a>Tags</a>
						<a>Links</a>
						<a>About</a>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/Nuist666" title="github">github</a>
					        
								<a class="mail" target="_blank" href="mailto:202183290043@gmail.com" title="mail">mail</a>
					        
								<a class="weibo" target="_blank" href="https://weibo.com/u/5586096129" title="weibo">weibo</a>
					        
								<a class="twitter" target="_blank" href="https://twitter.com/nuist_666" title="twitter">twitter</a>
					        
						</div>
						<!-- music -->
						
							<!-- <div style="position: absolute; bottom: 120px; left: auto; width: 85%;"> -->
							<div style="position: absolute; left: auto; width: 85%;">
								<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=220 height=86 src="//music.163.com/outchain/player?type=2&id=28411862&auto=1&height=66"></iframe>
							</div>
						
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/Overflow-Mirai-LLOneBot-OneBot/" style="font-size: 10px;">Overflow,Mirai,LLOneBot,OneBot</a> <a href="/tags/python-%E6%B0%94%E8%B1%A1%E4%BF%A1%E6%81%AF%E7%B3%BB%E7%BB%9F%E5%B7%A5%E7%A8%8B/" style="font-size: 20px;">python,气象信息系统工程</a> <a href="/tags/%E5%8D%8E%E4%B8%BA%E4%BA%91-%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2-Hexo/" style="font-size: 10px;">华为云,个人博客,Hexo</a> <a href="/tags/%E6%A8%A1%E6%9D%BF-%E5%B0%8F%E4%B9%A6%E5%8C%A0-%E4%B8%89%E5%B3%B0%E7%9C%9F%E7%99%BD-%E6%96%B0%E5%BB%BA/" style="font-size: 10px;">模板,小书匠,三峰真白,新建</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="https://qm.qq.com/q/HrJvHGMzek">qq</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="https://space.bilibili.com/3546647772531174">bilibili</a>
			        
			        </div>
				</section>
				

				
				
				<section class="switch-part switch-part4">
				
					<div id="js-aboutme">I&#39;m a student in NUIST.</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide"></h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="/img/avatar.png" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author"></h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">Home</a></li>
		        
					<li><a href="/archives">Archives</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/Nuist666" title="github">github</a>
			        
						<a class="mail" target="_blank" href="mailto:202183290043@gmail.com" title="mail">mail</a>
			        
						<a class="weibo" target="_blank" href="https://weibo.com/u/5586096129" title="weibo">weibo</a>
			        
						<a class="twitter" target="_blank" href="https://twitter.com/nuist_666" title="twitter">twitter</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap"><article id="post-第九章" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2000/01/01/%E7%AC%AC%E4%B9%9D%E7%AB%A0/" class="article-date">
  	<time datetime="1999-12-31T16:09:00.000Z" itemprop="datePublished">2000-01-01</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      python气象信息系统工程 第九章
      
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
	<div class="article-tag tagcloud">
		<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python-%E6%B0%94%E8%B1%A1%E4%BF%A1%E6%81%AF%E7%B3%BB%E7%BB%9F%E5%B7%A5%E7%A8%8B/" rel="tag">python,气象信息系统工程</a></li></ul>
	</div>

        
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/%E5%B0%8F%E4%B9%A6%E5%8C%A0-python/">/小书匠/python</a>
	</div>


        
        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="第9章-基本绘图类型与气象绘图"><a href="#第9章-基本绘图类型与气象绘图" class="headerlink" title="第9章 基本绘图类型与气象绘图"></a>第9章 基本绘图类型与气象绘图</h1><h2 id="9-1-折线图"><a href="#9-1-折线图" class="headerlink" title="9.1 折线图"></a>9.1 折线图</h2><h3 id="9-1-1-基本折线图"><a href="#9-1-1-基本折线图" class="headerlink" title="9.1.1 基本折线图"></a>9.1.1 基本折线图</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="comment">#读取数据</span></span><br><span class="line">ao = pd.read_csv(<span class="string">&quot;/home/mw/input/pythonbook9857/AO.txt&quot;</span>,sep=<span class="string">&#x27;\s+&#x27;</span>,header=<span class="literal">None</span>, names=[<span class="string">&#x27;year&#x27;</span>,<span class="string">&#x27;month&#x27;</span>,<span class="string">&#x27;AO&#x27;</span>])  </span><br><span class="line">ao_jan = ao[ao.month==<span class="number">1</span>]</span><br><span class="line"><span class="comment">#创建Figure</span></span><br><span class="line">fig = plt.figure(figsize=(<span class="number">10</span>, <span class="number">8</span>))</span><br><span class="line"><span class="comment">#创建Axes</span></span><br><span class="line">ax1 = fig.add_subplot(<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>)</span><br><span class="line"><span class="comment">#绘制折线图</span></span><br><span class="line">ax1.plot(np.arange(<span class="number">1950</span>,<span class="number">2020</span>,<span class="number">1</span>),ao_jan.AO, <span class="string">&#x27;ko-&#x27;</span>)</span><br><span class="line"><span class="comment">#添加图题</span></span><br><span class="line">ax1.set_title(<span class="string">&#x27;1950-2019 January AO Index&#x27;</span>)</span><br><span class="line"><span class="comment">#添加y=0水平参考线</span></span><br><span class="line">ax1.axhline(<span class="number">0</span>,ls=<span class="string">&#x27;:&#x27;</span>,c=<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line"><span class="comment">#添加x=1990垂直参考线</span></span><br><span class="line">ax1.axvline(<span class="number">1990</span>,ls=<span class="string">&#x27;--&#x27;</span>,c=<span class="string">&#x27;g&#x27;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


<img src="https://cdn.kesci.com/upload/rt/007D9BDBF34A4FAC985D4A19150C944E/rpaviw4zd7.png">


<h3 id="9-1-2-多折线图"><a href="#9-1-2-多折线图" class="headerlink" title="9.1.2  多折线图"></a>9.1.2  多折线图</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">ao = pd.read_csv(<span class="string">&quot;/home/mw/input/pythonbook9857/AO.txt&quot;</span>,sep=<span class="string">&#x27;\s+&#x27;</span>,header=<span class="literal">None</span>, names=[<span class="string">&#x27;year&#x27;</span>,<span class="string">&#x27;month&#x27;</span>,<span class="string">&#x27;AO&#x27;</span>])  </span><br><span class="line">ao_jan = ao[ao.month==<span class="number">1</span>]</span><br><span class="line">ao_feb = ao[ao.month==<span class="number">2</span>]</span><br><span class="line">fig = plt.figure(figsize=(<span class="number">10</span>, <span class="number">8</span>))</span><br><span class="line">ax1 = fig.add_subplot(<span class="number">2</span>,<span class="number">1</span>,<span class="number">1</span>)</span><br><span class="line"><span class="comment">#绘制第一个序列</span></span><br><span class="line">ax1.plot(np.arange(<span class="number">1950</span>,<span class="number">2020</span>,<span class="number">1</span>),ao_jan.AO,<span class="string">&#x27;ko-&#x27;</span>,label=<span class="string">&#x27;Jan&#x27;</span>)</span><br><span class="line"><span class="comment">#绘制第二个序列</span></span><br><span class="line">ax1.plot(np.arange(<span class="number">1950</span>,<span class="number">2020</span>,<span class="number">1</span>),ao_feb.AO,<span class="string">&#x27;rs-&#x27;</span>,label=<span class="string">&#x27;Feb&#x27;</span>)</span><br><span class="line">ax1.set_title(<span class="string">&#x27;1950-2019 AO Index&#x27;</span>)</span><br><span class="line"><span class="comment">#添加图例</span></span><br><span class="line">ax1.legend()</span><br><span class="line">plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<img src="https://cdn.kesci.com/upload/rt/BFE2ABDA23A64B048D152018B47D9EA1/rpaviwes7o.png">


<h3 id="9-1-3-多y轴折线图"><a href="#9-1-3-多y轴折线图" class="headerlink" title="9.1.3 多y轴折线图"></a>9.1.3 多y轴折线图</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="comment">#读取数据</span></span><br><span class="line">ao = pd.read_csv(<span class="string">&quot;/home/mw/input/pythonbook9857/AO.txt&quot;</span>,sep=<span class="string">&#x27;\s+&#x27;</span>,header=<span class="literal">None</span>, names=[<span class="string">&#x27;year&#x27;</span>,<span class="string">&#x27;month&#x27;</span>,<span class="string">&#x27;AO&#x27;</span>])  </span><br><span class="line">ao_jan = ao[ao.month==<span class="number">1</span>]</span><br><span class="line">ao_feb = ao[ao.month==<span class="number">2</span>]</span><br><span class="line"><span class="comment">#创建Figure</span></span><br><span class="line">fig = plt.figure()</span><br><span class="line"><span class="comment">#绘制单y轴折线图</span></span><br><span class="line">ax1 = fig.add_subplot(<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>)</span><br><span class="line">ax1.plot(np.arange(<span class="number">1950</span>,<span class="number">2020</span>,<span class="number">1</span>),ao_jan.AO,<span class="string">&#x27;ko-&#x27;</span>,label=<span class="string">&#x27;Jan&#x27;</span>)</span><br><span class="line">ax1.set_ylabel(<span class="string">&#x27;January&#x27;</span>,c=<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">ax1.set_title(<span class="string">&#x27;1950-2019 AO Index&#x27;</span>)</span><br><span class="line"><span class="comment">#创建第二个y轴</span></span><br><span class="line">ax2 = ax1.twinx()  </span><br><span class="line">ax2.plot(np.arange(<span class="number">1950</span>,<span class="number">2020</span>,<span class="number">1</span>),ao_feb.AO,<span class="string">&#x27;rs-&#x27;</span>,label=<span class="string">&#x27;Feb&#x27;</span>)</span><br><span class="line">ax2.set_ylim(-<span class="number">4</span>,<span class="number">4</span>)</span><br><span class="line">ax2.set_ylabel(<span class="string">&#x27;February&#x27;</span>,c=<span class="string">&#x27;k&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>




<pre><code>Text(0, 0.5, &#39;February&#39;)
</code></pre>
<img src="https://cdn.kesci.com/upload/rt/1B56F02ECE274140805A108D4A8E58B3/rpaviwtcq.png">



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> mpl_toolkits.axisartist.parasite_axes <span class="keyword">import</span> HostAxes, ParasiteAxes</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="comment">#读取数据</span></span><br><span class="line">ao = pd.read_csv(<span class="string">&quot;/home/mw/input/pythonbook9857/AO.txt&quot;</span>,sep=<span class="string">&#x27;\s+&#x27;</span>,header=<span class="literal">None</span>, names=[<span class="string">&#x27;year&#x27;</span>,<span class="string">&#x27;month&#x27;</span>,<span class="string">&#x27;AO&#x27;</span>])  </span><br><span class="line">ao_dec = ao[ao.month==<span class="number">12</span>]</span><br><span class="line">ao_jan = ao[ao.month==<span class="number">1</span>]</span><br><span class="line">ao_feb = ao[ao.month==<span class="number">2</span>]</span><br><span class="line">ao_djf = (ao_jan.AO.values+ao_feb.AO.values+ao_dec.AO.values)/<span class="number">3</span></span><br><span class="line"><span class="comment">#创建Figure</span></span><br><span class="line">fig = plt.figure() </span><br><span class="line"><span class="comment">#创建主轴</span></span><br><span class="line">ax = HostAxes(fig, [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0.9</span>, <span class="number">0.9</span>])  <span class="comment">#[left, bottom, weight, height]</span></span><br><span class="line"><span class="comment">#创建共享x轴的其他y轴</span></span><br><span class="line">ax1 = ParasiteAxes(ax, sharex=ax)</span><br><span class="line">ax2 = ParasiteAxes(ax, sharex=ax)</span><br><span class="line">ax3 = ParasiteAxes(ax, sharex=ax)</span><br><span class="line">ax.parasites.append(ax1)</span><br><span class="line">ax.parasites.append(ax2)</span><br><span class="line">ax.parasites.append(ax3)</span><br><span class="line"><span class="comment">#将主轴的右轴隐藏，同时开始设置第二个轴的可见性</span></span><br><span class="line">ax.axis[<span class="string">&#x27;right&#x27;</span>].set_visible(<span class="literal">False</span>)</span><br><span class="line">ax1.axis[<span class="string">&#x27;right&#x27;</span>].set_visible(<span class="literal">True</span>)</span><br><span class="line">ax1.axis[<span class="string">&#x27;right&#x27;</span>].major_ticklabels.set_visible(<span class="literal">True</span>)</span><br><span class="line">ax1.axis[<span class="string">&#x27;right&#x27;</span>].label.set_visible(<span class="literal">True</span>)</span><br><span class="line"><span class="comment">#设置各轴的标签</span></span><br><span class="line">ax.set_ylabel(<span class="string">&#x27;DJF&#x27;</span>)</span><br><span class="line">ax.set_xlabel(<span class="string">&#x27;year&#x27;</span>)</span><br><span class="line">ax1.set_ylabel(<span class="string">&#x27;Dec&#x27;</span>)</span><br><span class="line">ax2.set_ylabel(<span class="string">&#x27;Jan&#x27;</span>)</span><br><span class="line">ax3.set_ylabel(<span class="string">&#x27;Feb&#x27;</span>)</span><br><span class="line"><span class="comment">#设置第三个和第四个y轴的位置</span></span><br><span class="line">axisline2 = ax2.get_grid_helper().new_fixed_axis</span><br><span class="line">axisline3 = ax3.get_grid_helper().new_fixed_axis</span><br><span class="line">ax2.axis[<span class="string">&#x27;right2&#x27;</span>] = axisline2(loc=<span class="string">&#x27;right&#x27;</span>, axes=ax2, offset=(<span class="number">40</span>,<span class="number">0</span>))</span><br><span class="line">ax3.axis[<span class="string">&#x27;right3&#x27;</span>] = axisline3(loc=<span class="string">&#x27;right&#x27;</span>, axes=ax3, offset=(<span class="number">80</span>,<span class="number">0</span>))</span><br><span class="line"><span class="comment">#将设置好的主轴的Axes放在Figure上</span></span><br><span class="line">fig.add_axes(ax)</span><br><span class="line"><span class="comment">#绘制折线</span></span><br><span class="line">ax.plot(np.arange(<span class="number">1950</span>,<span class="number">2020</span>,<span class="number">1</span>), ao_djf, label=<span class="string">&quot;DJF&quot;</span>, color=<span class="string">&#x27;black&#x27;</span>)</span><br><span class="line">ax1.plot(np.arange(<span class="number">1950</span>,<span class="number">2020</span>,<span class="number">1</span>), ao_dec.AO, label=<span class="string">&quot;Dec&quot;</span>, color=<span class="string">&#x27;red&#x27;</span>)</span><br><span class="line">ax2.plot(np.arange(<span class="number">1950</span>,<span class="number">2020</span>,<span class="number">1</span>), ao_jan.AO, label=<span class="string">&quot;Jan&quot;</span>, color=<span class="string">&#x27;green&#x27;</span>)</span><br><span class="line">ax3.plot(np.arange(<span class="number">1950</span>,<span class="number">2020</span>,<span class="number">1</span>), ao_feb.AO, label=<span class="string">&quot;Feb&quot;</span>, color=<span class="string">&#x27;orange&#x27;</span>)</span><br><span class="line">ax1.set_ylim(-<span class="number">4</span>,<span class="number">4</span>)</span><br><span class="line">ax2.set_ylim(-<span class="number">5</span>,<span class="number">5</span>)</span><br><span class="line">ax3.set_ylim(-<span class="number">6</span>,<span class="number">6</span>)</span><br><span class="line">ax.legend()</span><br><span class="line"><span class="comment">#设置各个轴及其刻度的颜色</span></span><br><span class="line">ax1.axis[<span class="string">&#x27;right&#x27;</span>].major_ticks.set_color(<span class="string">&#x27;red&#x27;</span>)</span><br><span class="line">ax2.axis[<span class="string">&#x27;right2&#x27;</span>].major_ticks.set_color(<span class="string">&#x27;green&#x27;</span>)</span><br><span class="line">ax3.axis[<span class="string">&#x27;right3&#x27;</span>].major_ticks.set_color(<span class="string">&#x27;blue&#x27;</span>)</span><br><span class="line">ax1.axis[<span class="string">&#x27;right&#x27;</span>].major_ticklabels.set_color(<span class="string">&#x27;red&#x27;</span>)</span><br><span class="line">ax2.axis[<span class="string">&#x27;right2&#x27;</span>].major_ticklabels.set_color(<span class="string">&#x27;green&#x27;</span>)</span><br><span class="line">ax3.axis[<span class="string">&#x27;right3&#x27;</span>].major_ticklabels.set_color(<span class="string">&#x27;blue&#x27;</span>)</span><br><span class="line">ax1.axis[<span class="string">&#x27;right&#x27;</span>].line.set_color(<span class="string">&#x27;red&#x27;</span>)</span><br><span class="line">ax2.axis[<span class="string">&#x27;right2&#x27;</span>].line.set_color(<span class="string">&#x27;green&#x27;</span>)</span><br><span class="line">ax3.axis[<span class="string">&#x27;right3&#x27;</span>].line.set_color(<span class="string">&#x27;blue&#x27;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


<img src="https://cdn.kesci.com/upload/rt/C5BBD34C3272422F95EB160077FAF3A9/rpavixh8wa.png">


<h3 id="9-1-4-非等比坐标轴图"><a href="#9-1-4-非等比坐标轴图" class="headerlink" title="9.1.4  非等比坐标轴图"></a>9.1.4  非等比坐标轴图</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> xarray <span class="keyword">as</span> xr</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> cartopy.crs <span class="keyword">as</span> ccrs</span><br><span class="line"><span class="keyword">import</span> cartopy.feature <span class="keyword">as</span> cfeature</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> matplotlib.ticker <span class="keyword">as</span> ticker</span><br><span class="line"><span class="comment">#读取数据</span></span><br><span class="line">f = xr.open_dataset(<span class="string">&#x27;/home/mw/input/pythonbook9857/data.nc&#x27;</span>)</span><br><span class="line">t = f[<span class="string">&#x27;air&#x27;</span>].loc[<span class="string">&#x27;2005-07-01&#x27;</span>,:,<span class="number">45</span>,<span class="number">120</span>]</span><br><span class="line">lev = t.level</span><br><span class="line"><span class="comment">#创建Figure</span></span><br><span class="line">fig = plt.figure(figsize=(<span class="number">15</span>,<span class="number">5</span>))</span><br><span class="line"><span class="comment">#设置为log</span></span><br><span class="line">ax1 = fig.add_subplot(<span class="number">1</span>,<span class="number">3</span>,<span class="number">1</span>)</span><br><span class="line">ax1.plot(t,lev)</span><br><span class="line">ax1.set_ylim(<span class="number">1000</span>,<span class="number">100</span>)</span><br><span class="line">ax1.set_yscale(<span class="string">&#x27;log&#x27;</span>)</span><br><span class="line">ax1.set_title(<span class="string">&#x27;log&#x27;</span>)</span><br><span class="line">ax1.set_yticks([<span class="number">1000</span>,<span class="number">850</span>,<span class="number">700</span>,<span class="number">500</span>,<span class="number">300</span>,<span class="number">200</span>,<span class="number">100</span>])</span><br><span class="line">ax1.set_yticklabels([<span class="number">1000</span>,<span class="number">850</span>,<span class="number">700</span>,<span class="number">500</span>,<span class="number">300</span>,<span class="number">200</span>,<span class="number">100</span>])</span><br><span class="line"><span class="comment">#隐藏次坐标刻度</span></span><br><span class="line">ax1.yaxis.set_minor_formatter(ticker.NullFormatter())</span><br><span class="line"><span class="comment">#设置为symlog</span></span><br><span class="line">ax2 = fig.add_subplot(<span class="number">1</span>,<span class="number">3</span>,<span class="number">2</span>)</span><br><span class="line">ax2.plot(t,lev)</span><br><span class="line">ax2.set_ylim(<span class="number">1000</span>,<span class="number">100</span>)</span><br><span class="line">ax2.set_yscale(<span class="string">&#x27;symlog&#x27;</span>)</span><br><span class="line">ax2.set_title(<span class="string">&#x27;symlog&#x27;</span>)</span><br><span class="line">ax2.set_yticks([<span class="number">1000</span>,<span class="number">850</span>,<span class="number">700</span>,<span class="number">500</span>,<span class="number">300</span>,<span class="number">200</span>,<span class="number">100</span>])</span><br><span class="line">ax2.set_yticklabels([<span class="number">1000</span>,<span class="number">850</span>,<span class="number">700</span>,<span class="number">500</span>,<span class="number">300</span>,<span class="number">200</span>,<span class="number">100</span>])</span><br><span class="line"><span class="comment">#设置为linear</span></span><br><span class="line">ax3 = fig.add_subplot(<span class="number">1</span>,<span class="number">3</span>,<span class="number">3</span>)</span><br><span class="line">ax3.plot(t,lev)</span><br><span class="line">ax3.invert_yaxis()</span><br><span class="line">ax3.set_yscale(<span class="string">&#x27;linear&#x27;</span>)</span><br><span class="line">ax3.set_title(<span class="string">&#x27;linear&#x27;</span>)</span><br><span class="line">ax3.set_yticks([<span class="number">1000</span>,<span class="number">850</span>,<span class="number">700</span>,<span class="number">500</span>,<span class="number">300</span>,<span class="number">200</span>,<span class="number">100</span>])</span><br><span class="line">ax3.set_yticklabels([<span class="number">1000</span>,<span class="number">850</span>,<span class="number">700</span>,<span class="number">500</span>,<span class="number">300</span>,<span class="number">200</span>,<span class="number">100</span>])</span><br><span class="line">plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<pre><code>Warning: ecCodes 2.21.0 or higher is recommended. You are running version 2.14.1
</code></pre>
<img src="https://cdn.kesci.com/upload/rt/A2C6178E45A8442081D83665555370C9/rpaviz2bt4.png">


<h3 id="9-2-1-基础散点图"><a href="#9-2-1-基础散点图" class="headerlink" title="9.2.1  基础散点图"></a>9.2.1  基础散点图</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">rng = np.random.RandomState(<span class="number">0</span>).rand(<span class="number">5</span>)</span><br><span class="line">markers = [<span class="string">&#x27;o&#x27;</span>,<span class="string">&#x27;+&#x27;</span>,<span class="string">&#x27;*&#x27;</span>,<span class="string">&#x27;s&#x27;</span>,<span class="string">&#x27;&lt;&#x27;</span>]</span><br><span class="line">labels = [<span class="string">&#x27;CNRM-CM3&#x27;</span>,<span class="string">&#x27;GFDL-CM2.0&#x27;</span>,<span class="string">&#x27;GISS-AOM&#x27;</span>,<span class="string">&#x27;MIROC3.2&#x27;</span>,<span class="string">&#x27;CCSM3&#x27;</span>,]</span><br><span class="line"><span class="comment">#绘制散点图</span></span><br><span class="line">fig = plt.figure()</span><br><span class="line">ax1 = fig.add_subplot(<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>)</span><br><span class="line"><span class="comment">#通过循环，每次绘制一种标记的散点，循环5次</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">    ax1.scatter(rng,rng,marker=markers[i],label=labels[i])</span><br><span class="line">ax1.legend()</span><br><span class="line">plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<img src="https://cdn.kesci.com/upload/rt/E1EE60EAE2204E0183767B39C33B415A/rpaviznobd.png">


<h2 id="9-2-散点图"><a href="#9-2-散点图" class="headerlink" title="9.2 散点图"></a>9.2 散点图</h2><h3 id="9-2-2-带有地图投影的散点图"><a href="#9-2-2-带有地图投影的散点图" class="headerlink" title="9.2.2  带有地图投影的散点图"></a>9.2.2  带有地图投影的散点图</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> cartopy.crs <span class="keyword">as</span> ccrs</span><br><span class="line"><span class="keyword">import</span> cartopy.feature <span class="keyword">as</span> cfeature</span><br><span class="line"><span class="keyword">import</span> cartopy.mpl.ticker <span class="keyword">as</span> cticker</span><br><span class="line"><span class="keyword">import</span> cartopy.io.shapereader <span class="keyword">as</span> shpreader</span><br><span class="line">data = pd.read_csv(<span class="string">&quot;/home/mw/input/pythonbook9857/825station.txt&quot;</span>,sep=<span class="string">&#x27;\s+&#x27;</span>,header=<span class="literal">None</span>, names=[<span class="string">&#x27;stat&#x27;</span>,<span class="string">&#x27;lat&#x27;</span>,<span class="string">&#x27;lon&#x27;</span>,<span class="string">&#x27;high&#x27;</span>])</span><br><span class="line">fig = plt.figure(figsize=(<span class="number">10</span>, <span class="number">8</span>))</span><br><span class="line">ax1 = fig.add_subplot(<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,projection = ccrs.PlateCarree(central_longitude=<span class="number">105</span>) )</span><br><span class="line"><span class="comment">#设置图形范围及刻度</span></span><br><span class="line">ax1.set_extent([<span class="number">70</span>,<span class="number">110</span>,<span class="number">30</span>,<span class="number">60</span>], crs=ccrs.PlateCarree())</span><br><span class="line">ax1.set_xticks(np.arange(<span class="number">70</span>,<span class="number">120</span>,<span class="number">10</span>), crs=ccrs.PlateCarree())</span><br><span class="line">ax1.set_yticks(np.arange(<span class="number">30</span>,<span class="number">70</span>,<span class="number">10</span>), crs=ccrs.PlateCarree())</span><br><span class="line">ax1.xaxis.set_major_formatter(cticker.LongitudeFormatter())</span><br><span class="line">ax1.yaxis.set_major_formatter(cticker.LatitudeFormatter())</span><br><span class="line"><span class="comment">#绘制站点的三维分布图</span></span><br><span class="line">s = ax1.scatter(data.lon,data.lat,s = <span class="number">5</span>,c = data.high,cmap=<span class="string">&#x27;jet&#x27;</span>,transform=ccrs.PlateCarree())</span><br><span class="line"><span class="comment">#添加色标，fraction参数用于设置色标缩放比例</span></span><br><span class="line">fig.colorbar(s,ax=ax1,fraction=<span class="number">0.034</span>)</span><br><span class="line"><span class="comment">#添加海岸线等特征</span></span><br><span class="line"><span class="comment"># ax1.add_feature(cfeature.COASTLINE.with_scale(&#x27;50m&#x27;))</span></span><br><span class="line"><span class="comment"># china = shpreader.Reader(&#x27;/data/home/zenggang/yxy/shp/bou2_4l.dbf&#x27;).geometries()</span></span><br><span class="line"><span class="comment"># ax1.add_geometries(china, ccrs.PlateCarree(),facecolor=&#x27;none&#x27;, edgecolor=&#x27;black&#x27;,zorder = 1)</span></span><br><span class="line">plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<img src="https://cdn.kesci.com/upload/rt/81A16A298C614F4485B439D13A8404BA/rpaviz8xjl.png">


<h2 id="9-3-柱状图"><a href="#9-3-柱状图" class="headerlink" title="9.3  柱状图"></a>9.3  柱状图</h2><h3 id="9-3-1-单变量柱状图"><a href="#9-3-1-单变量柱状图" class="headerlink" title="9.3.1  单变量柱状图"></a>9.3.1  单变量柱状图</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="comment">#读取数据</span></span><br><span class="line">ao = pd.read_csv(<span class="string">&quot;/home/mw/input/pythonbook9857/AO.txt&quot;</span>,sep=<span class="string">&#x27;\s+&#x27;</span>,header=<span class="literal">None</span>, names=[<span class="string">&#x27;year&#x27;</span>,<span class="string">&#x27;month&#x27;</span>,<span class="string">&#x27;AO&#x27;</span>])  </span><br><span class="line">ao_jan = ao[ao.month==<span class="number">1</span>]</span><br><span class="line"><span class="comment">#创建Figure及Axes</span></span><br><span class="line">fig = plt.figure(figsize=(<span class="number">10</span>, <span class="number">8</span>))</span><br><span class="line">ax1 = fig.add_subplot(<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>)</span><br><span class="line">ax1.set_title(<span class="string">&#x27;1950-2019 January AO Index&#x27;</span>)</span><br><span class="line"><span class="comment">#绘制单变量柱状图</span></span><br><span class="line">ax1.bar(np.arange(<span class="number">1950</span>,<span class="number">2020</span>,<span class="number">1</span>),ao_jan.AO)</span><br><span class="line"><span class="comment">#添加0值参考线</span></span><br><span class="line">ax1.axhline(<span class="number">0</span>,c=<span class="string">&#x27;k&#x27;</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<img src="https://cdn.kesci.com/upload/rt/1C93B81B383B40C48B3F0F091C9C2927/rpavj0al4s.png">



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="comment">#读取数据</span></span><br><span class="line">ao = pd.read_csv(<span class="string">&quot;/home/mw/input/pythonbook9857/AO.txt&quot;</span>,sep=<span class="string">&#x27;\s+&#x27;</span>,header=<span class="literal">None</span>, names=[<span class="string">&#x27;year&#x27;</span>,<span class="string">&#x27;month&#x27;</span>,<span class="string">&#x27;AO&#x27;</span>])  </span><br><span class="line">ao_jan = ao[ao.month==<span class="number">1</span>]</span><br><span class="line"><span class="comment">#创建颜色数组</span></span><br><span class="line">colors = np.zeros(ao_jan.AO.shape,dtype=np.<span class="built_in">str</span>)</span><br><span class="line">colors[ao_jan.AO&gt;=<span class="number">0</span>] = <span class="string">&#x27;red&#x27;</span></span><br><span class="line">colors[ao_jan.AO&lt;<span class="number">0</span>] = <span class="string">&#x27;blue&#x27;</span></span><br><span class="line"><span class="comment">#创建Figure及Axes</span></span><br><span class="line">fig = plt.figure(figsize=(<span class="number">10</span>, <span class="number">8</span>))</span><br><span class="line">ax1 = fig.add_subplot(<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>)</span><br><span class="line">ax1.set_title(<span class="string">&#x27;1950-2019 January AO Index&#x27;</span>)</span><br><span class="line"><span class="comment">#绘制单变量柱状图</span></span><br><span class="line">ax1.bar(np.arange(<span class="number">1950</span>,<span class="number">2020</span>,<span class="number">1</span>),ao_jan.AO,color=colors)</span><br><span class="line"><span class="comment">#添加0值参考线</span></span><br><span class="line">ax1.axhline(<span class="number">0</span>,c=<span class="string">&#x27;k&#x27;</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<pre><code>/opt/conda/lib/python3.7/site-packages/ipykernel_launcher.py:7: DeprecationWarning: `np.str` is a deprecated alias for the builtin `str`. To silence this warning, use `str` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.str_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  import sys
</code></pre>
<img src="https://cdn.kesci.com/upload/rt/BF204CF2415B4BC6B417DBDEC7BD2F48/rpavj0tjod.png">


<h3 id="9-3-2-多变量柱状图"><a href="#9-3-2-多变量柱状图" class="headerlink" title="9.3.2  多变量柱状图"></a>9.3.2  多变量柱状图</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="comment">#数据读取</span></span><br><span class="line">ao = pd.read_csv(<span class="string">&quot;/home/mw/input/pythonbook9857/AO.txt&quot;</span>,sep=<span class="string">&#x27;\s+&#x27;</span>,header=<span class="literal">None</span>, names=[<span class="string">&#x27;year&#x27;</span>,<span class="string">&#x27;month&#x27;</span>,<span class="string">&#x27;AO&#x27;</span>])  </span><br><span class="line">ao_dec = ao[ao.month==<span class="number">12</span>]</span><br><span class="line">ao_jan = ao[ao.month==<span class="number">1</span>]</span><br><span class="line">ao_feb = ao[ao.month==<span class="number">2</span>]</span><br><span class="line"><span class="comment">#创建Figure及Axes</span></span><br><span class="line">fig = plt.figure(figsize=(<span class="number">10</span>, <span class="number">8</span>))</span><br><span class="line">ax1 = fig.add_subplot(<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>)</span><br><span class="line">ax1.set_title(<span class="string">&#x27;2000—2019 DJF AO Index&#x27;</span>)</span><br><span class="line"><span class="comment">#绘制柱状图，ao_dec.AO[50:]表明从2000年开始绘制</span></span><br><span class="line">ax1.bar(np.arange(<span class="number">2000</span>,<span class="number">2020</span>,<span class="number">1</span>)-<span class="number">0.25</span>, ao_dec.AO[<span class="number">50</span>:], width=<span class="number">0.25</span>, color=<span class="string">&#x27;r&#x27;</span>, label=<span class="string">&#x27;Dec&#x27;</span>)</span><br><span class="line">ax1.bar(np.arange(<span class="number">2000</span>,<span class="number">2020</span>,<span class="number">1</span>),ao_jan.AO[<span class="number">50</span>:],width=<span class="number">0.25</span>,color=<span class="string">&#x27;b&#x27;</span>,label=<span class="string">&#x27;Jan&#x27;</span>)</span><br><span class="line">ax1.bar(np.arange(<span class="number">2000</span>,<span class="number">2020</span>,<span class="number">1</span>)+<span class="number">0.25</span>,ao_feb.AO[<span class="number">50</span>:],width=<span class="number">0.25</span>,color=<span class="string">&#x27;g&#x27;</span>,label=<span class="string">&#x27;Feb&#x27;</span>)</span><br><span class="line"><span class="comment">#添加0值参考线</span></span><br><span class="line">ax1.axhline(<span class="number">0</span>,c=<span class="string">&#x27;k&#x27;</span>)</span><br><span class="line">ax1.legend()</span><br><span class="line"><span class="comment">#由于多变量柱状图对应的x轴的刻度不一定为整数，因此我们指定x轴刻度以避免小数出现</span></span><br><span class="line">ax1.set_xticks([<span class="number">2000</span>,<span class="number">2005</span>,<span class="number">2010</span>,<span class="number">2015</span>,<span class="number">2020</span>])</span><br><span class="line">plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<img src="https://cdn.kesci.com/upload/rt/514C49B4201A42BFAF669D37BE738C40/rpavj03dcg.png">



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="comment">#生成数据</span></span><br><span class="line">labels = [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>, <span class="string">&#x27;D&#x27;</span>]</span><br><span class="line">v1 = np.array([<span class="number">20</span>, <span class="number">35</span>, <span class="number">30</span>, <span class="number">35</span>])</span><br><span class="line">v2 = np.array([<span class="number">25</span>, <span class="number">32</span>, <span class="number">34</span>, <span class="number">20</span>])</span><br><span class="line">v3 = np.array([<span class="number">11</span>, <span class="number">14</span>, <span class="number">20</span>, <span class="number">18</span>])</span><br><span class="line">v1_std = np.array([<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">1</span>])</span><br><span class="line">v2_std = np.array([<span class="number">3</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line">v3_std = np.array([<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">1</span>])</span><br><span class="line">width = <span class="number">0.35</span></span><br><span class="line">fig = plt.figure(figsize=(<span class="number">10</span>, <span class="number">8</span>))</span><br><span class="line">ax1 = fig.add_subplot(<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>)</span><br><span class="line"><span class="comment">#绘制垂直堆叠的多变量柱状图</span></span><br><span class="line">ax1.bar(labels, v1, width, yerr=v1_std, label=<span class="string">&#x27;v1&#x27;</span>)</span><br><span class="line">ax1.bar(labels, v2, width, yerr=v2_std, bottom=v1,label=<span class="string">&#x27;v2&#x27;</span>)</span><br><span class="line">ax1.bar(labels, v3, width, yerr=v3_std, bottom=v2+v1,label=<span class="string">&#x27;v3&#x27;</span>)</span><br><span class="line">ax1.legend()</span><br><span class="line">plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<img src="https://cdn.kesci.com/upload/rt/0B4088473BA445BE8DD741CDE2F86D7F/rpavj0p0k9.png">


<h2 id="9-4-箱线图"><a href="#9-4-箱线图" class="headerlink" title="9.4  箱线图"></a>9.4  箱线图</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="comment">#生成数据</span></span><br><span class="line">data=[np.random.normal(<span class="number">0</span>,std,<span class="number">100</span>) <span class="keyword">for</span> std <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">4</span>)]</span><br><span class="line"><span class="comment">#绘制箱线图</span></span><br><span class="line">fig = plt.figure(figsize=(<span class="number">10</span>, <span class="number">8</span>))</span><br><span class="line">ax1 = fig.add_subplot(<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>)</span><br><span class="line">ax1.boxplot(data,vert=<span class="literal">True</span>,whis=<span class="number">1.2</span>,patch_artist=<span class="literal">True</span>,boxprops=&#123;<span class="string">&#x27;color&#x27;</span>:<span class="string">&#x27;black&#x27;</span>,<span class="string">&#x27;facecolor&#x27;</span>:<span class="string">&#x27;red&#x27;</span>&#125;)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<img src="https://cdn.kesci.com/upload/rt/3096792C73A940238AAB0418BD89FA94/rpavj17o51.png">


<h2 id="9-5-等值线图"><a href="#9-5-等值线图" class="headerlink" title="9.5  等值线图"></a>9.5  等值线图</h2><h3 id="9-5-1-基本等值线图"><a href="#9-5-1-基本等值线图" class="headerlink" title="9.5.1  基本等值线图"></a>9.5.1  基本等值线图</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="comment">#生成数据</span></span><br><span class="line">x = np.arange(-<span class="number">10</span>,<span class="number">10</span>,<span class="number">0.01</span>)</span><br><span class="line">y = np.arange(-<span class="number">10</span>,<span class="number">10</span>,<span class="number">0.01</span>)</span><br><span class="line">x_grid,y_grid = np.meshgrid(x,y)</span><br><span class="line">z = x_grid**<span class="number">2</span>+y_grid**<span class="number">2</span></span><br><span class="line"><span class="comment">#创建Figure及Axes</span></span><br><span class="line">fig = plt.figure(figsize=(<span class="number">10</span>, <span class="number">8</span>))</span><br><span class="line">ax1 = fig.add_subplot(<span class="number">2</span>,<span class="number">2</span>,<span class="number">1</span>)</span><br><span class="line">ax1.contour(x,y,z)</span><br><span class="line">ax1.set_title(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">ax2 = fig.add_subplot(<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>)</span><br><span class="line">ax2.contour(x,y,z,linestyles=<span class="string">&#x27;:&#x27;</span>)</span><br><span class="line">ax2.set_title(<span class="string">&#x27;b&#x27;</span>)</span><br><span class="line">ax3 = fig.add_subplot(<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>)</span><br><span class="line">ax3.contour(x,y,z,levels=np.arange(<span class="number">60</span>,<span class="number">150</span>,<span class="number">30</span>),linewidths=<span class="number">5</span>)</span><br><span class="line">ax3.set_title(<span class="string">&#x27;c&#x27;</span>)</span><br><span class="line">ax4 = fig.add_subplot(<span class="number">2</span>,<span class="number">2</span>,<span class="number">4</span>)</span><br><span class="line">contour = ax4.contour(x,y,z,levels=np.arange(<span class="number">60</span>,<span class="number">150</span>,<span class="number">30</span>))</span><br><span class="line">ax4.clabel(contour,fontsize=<span class="number">10</span>,colors=<span class="string">&#x27;k&#x27;</span>)</span><br><span class="line">ax4.set_title(<span class="string">&#x27;d&#x27;</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<img src="https://cdn.kesci.com/upload/rt/9896D419836B47FD822E83D0633402D4/rpavj2lf5u.png">



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> xarray <span class="keyword">as</span> xr</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> cartopy.crs <span class="keyword">as</span> ccrs</span><br><span class="line"><span class="keyword">import</span> cartopy.feature <span class="keyword">as</span> cfeature</span><br><span class="line"><span class="keyword">import</span> cartopy.mpl.ticker <span class="keyword">as</span> cticker</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="comment">#读取数据</span></span><br><span class="line">f = xr.open_dataset(<span class="string">&#x27;/home/mw/input/pythonbook9857/data.nc&#x27;</span>)</span><br><span class="line">z = f[<span class="string">&#x27;hgt&#x27;</span>].loc[<span class="string">&#x27;2005-01-01&#x27;</span>:<span class="string">&#x27;2005-12-01&#x27;</span>,<span class="number">500</span>,:,<span class="number">120</span>]</span><br><span class="line">time = z.time</span><br><span class="line">lat = z.lat</span><br><span class="line"><span class="comment">#创建Figure</span></span><br><span class="line">fig = plt.figure(figsize=(<span class="number">16</span>, <span class="number">13</span>))</span><br><span class="line"><span class="comment">#绘制500hPa位势高度场</span></span><br><span class="line">ax1 = fig.add_subplot(<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>)</span><br><span class="line"><span class="comment">#绘制等值线</span></span><br><span class="line">q1 = ax1.contour(<span class="built_in">range</span>(time.shape[<span class="number">0</span>]), lat, z.T)</span><br><span class="line"><span class="comment">#设置y轴为对数坐标轴，并设置相关标签</span></span><br><span class="line">ax1.set_xticks(np.arange(<span class="number">0</span>,<span class="number">12</span>,<span class="number">1</span>))</span><br><span class="line">ax1.set_yticks(np.arange(-<span class="number">90</span>,<span class="number">120</span>,<span class="number">30</span>))</span><br><span class="line">ax1.yaxis.set_major_formatter(cticker.LatitudeFormatter())</span><br><span class="line"><span class="comment">#设置x轴标签</span></span><br><span class="line">ax1.set_xlim(<span class="number">0</span>,<span class="number">11</span>)</span><br><span class="line">ax1.set_xticks(np.arange(<span class="number">0</span>,<span class="number">12</span>,<span class="number">1</span>))</span><br><span class="line">ax1.set_xticklabels(pd.date_range(start=<span class="string">&#x27;2005-01&#x27;</span>,periods=<span class="number">12</span>,freq=<span class="string">&#x27;M&#x27;</span>).date )</span><br><span class="line"><span class="comment">#添加图题</span></span><br><span class="line">ax1.set_title(<span class="string">&#x27;2005 500hPa Z&#x27;</span>,loc=<span class="string">&#x27;center&#x27;</span>,fontsize=<span class="number">18</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<img src="https://cdn.kesci.com/upload/rt/937DF59A49A440A6A96E807AB5D9DEE9/rpavj3nfr3.png">


<h3 id="9-5-2-带有地图投影的等值线图"><a href="#9-5-2-带有地图投影的等值线图" class="headerlink" title="9.5.2  带有地图投影的等值线图"></a>9.5.2  带有地图投影的等值线图</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> xarray <span class="keyword">as</span> xr</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> cartopy.crs <span class="keyword">as</span> ccrs</span><br><span class="line"><span class="keyword">import</span> cartopy.feature <span class="keyword">as</span> cfeature</span><br><span class="line"><span class="keyword">import</span> cartopy.mpl.ticker <span class="keyword">as</span> cticker</span><br><span class="line"><span class="comment">#读取数据</span></span><br><span class="line">f = xr.open_dataset(<span class="string">&#x27;/home/mw/input/pythonbook9857/data.nc&#x27;</span>)</span><br><span class="line">z = f[<span class="string">&#x27;hgt&#x27;</span>].loc[<span class="string">&#x27;2005-07-01&#x27;</span>,<span class="number">500</span>,:,:]</span><br><span class="line">t = f[<span class="string">&#x27;air&#x27;</span>].loc[<span class="string">&#x27;2005-07-01&#x27;</span>,<span class="number">700</span>,:,:]</span><br><span class="line">lat = f[<span class="string">&#x27;lat&#x27;</span>]</span><br><span class="line">lon = f[<span class="string">&#x27;lon&#x27;</span>]</span><br><span class="line"><span class="comment">#创建Figure</span></span><br><span class="line">fig = plt.figure(figsize=(<span class="number">15</span>, <span class="number">12</span>))</span><br><span class="line"><span class="comment">#绘制500hPa位势高度场</span></span><br><span class="line">ax1 = fig.add_subplot(<span class="number">1</span>,<span class="number">2</span>,<span class="number">1</span>, projection=ccrs.PlateCarree())</span><br><span class="line"><span class="comment">#设置ax1的范围</span></span><br><span class="line">ax1.set_extent([<span class="number">60</span>,<span class="number">180</span>,<span class="number">0</span>,<span class="number">90</span>])</span><br><span class="line"><span class="comment">#为ax1添加海岸线</span></span><br><span class="line"><span class="comment">#ax1.coastlines()</span></span><br><span class="line"><span class="comment">#为ax1添加地理经纬度标签及刻度</span></span><br><span class="line">ax1.set_xticks(np.arange(<span class="number">60</span>,<span class="number">210</span>,<span class="number">30</span>), crs=ccrs.PlateCarree())</span><br><span class="line">ax1.set_yticks(np.arange(<span class="number">0</span>,<span class="number">90</span>,<span class="number">30</span>), crs=ccrs.PlateCarree())</span><br><span class="line">ax1.xaxis.set_major_formatter(cticker.LongitudeFormatter())</span><br><span class="line">ax1.yaxis.set_major_formatter(cticker.LatitudeFormatter())</span><br><span class="line"><span class="comment">#从5000到5800每间隔80绘制一条黑色的等值线</span></span><br><span class="line">c1 = ax1.contour(lon, lat, z,levels=np.arange(<span class="number">5000</span>,<span class="number">5880</span>,<span class="number">80</span>), colors=<span class="string">&#x27;k&#x27;</span>,transform=ccrs.PlateCarree())</span><br><span class="line"><span class="comment">#为c1添加数值标签，标签格式为整型</span></span><br><span class="line">ax1.clabel(c1, fmt=<span class="string">&#x27;%d&#x27;</span>, fontsize=<span class="number">14.5</span>,inline=<span class="literal">True</span>)</span><br><span class="line"><span class="comment">#单独绘制加粗并且用虚线表示的5880副高特征线</span></span><br><span class="line">c2 = ax1.contour(lon, lat, z,levels = [<span class="number">5880</span>],colors=<span class="string">&#x27;k&#x27;</span>,transform=ccrs.PlateCarree(),linewidths=<span class="number">3</span>,linestyles=<span class="string">&#x27;--&#x27;</span>)</span><br><span class="line"><span class="comment">#为c2添加数值标签，标签格式为浮点型（保留一位小数）</span></span><br><span class="line">ax1.clabel(c2, fmt=<span class="string">&#x27;%d&#x27;</span>, fontsize=<span class="number">14.5</span>,inline=<span class="literal">True</span>)</span><br><span class="line"><span class="comment">#添加图题</span></span><br><span class="line">ax1.set_title(<span class="string">&#x27;July 2005 500hPa Z&#x27;</span>,loc=<span class="string">&#x27;center&#x27;</span>,fontsize=<span class="number">18</span>)</span><br><span class="line">ax1.set_title(<span class="string">&#x27;unit: gpm&#x27;</span>,loc=<span class="string">&#x27;right&#x27;</span>,fontsize=<span class="number">18</span>)</span><br><span class="line"><span class="comment">#绘制700hPa温度场</span></span><br><span class="line">ax2 = fig.add_subplot(<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>, projection=ccrs.PlateCarree())</span><br><span class="line">ax2.set_extent([<span class="number">60</span>,<span class="number">180</span>,<span class="number">0</span>,<span class="number">90</span>])</span><br><span class="line"><span class="comment">#ax2.coastlines()</span></span><br><span class="line">ax2.set_xticks(np.arange(<span class="number">60</span>,<span class="number">210</span>,<span class="number">30</span>), crs=ccrs.PlateCarree())</span><br><span class="line">ax2.set_yticks(np.arange(<span class="number">0</span>,<span class="number">90</span>,<span class="number">30</span>), crs=ccrs.PlateCarree())</span><br><span class="line">ax2.xaxis.set_major_formatter(cticker.LongitudeFormatter())</span><br><span class="line">ax2.yaxis.set_major_formatter(cticker.LatitudeFormatter())</span><br><span class="line">c3 = ax2.contour(lon, lat, t, levels=np.arange(-<span class="number">30</span>,<span class="number">33</span>,<span class="number">3</span>),colors=<span class="string">&#x27;k&#x27;</span>,transform=ccrs.PlateCarree())</span><br><span class="line">ax2.clabel(c3, fmt=<span class="string">&#x27;%.1f&#x27;</span>, fontsize=<span class="number">14.5</span>,inline=<span class="literal">True</span>)</span><br><span class="line">ax2.set_title(<span class="string">&#x27;July 2005 700hPa T&#x27;</span>,loc=<span class="string">&#x27;center&#x27;</span>,fontsize=<span class="number">18</span>)</span><br><span class="line">ax2.set_title(<span class="string">&#x27;unit: $^\circ$C&#x27;</span>,loc=<span class="string">&#x27;right&#x27;</span>,fontsize=<span class="number">18</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<img src="https://cdn.kesci.com/upload/rt/6E420A264DE04AF38B82A622099C39A1/rpavj8xfz3.png">


<h3 id="9-5-3-垂直剖面等值线图"><a href="#9-5-3-垂直剖面等值线图" class="headerlink" title="9.5.3  垂直剖面等值线图"></a>9.5.3  垂直剖面等值线图</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> xarray <span class="keyword">as</span> xr</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> cartopy.crs <span class="keyword">as</span> ccrs</span><br><span class="line"><span class="keyword">import</span> cartopy.feature <span class="keyword">as</span> cfeature</span><br><span class="line"><span class="keyword">import</span> cartopy.mpl.ticker <span class="keyword">as</span> cticker</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="comment">#读取数据</span></span><br><span class="line">f = xr.open_dataset(<span class="string">&#x27;/home/mw/input/pythonbook9857/data.nc&#x27;</span>)</span><br><span class="line">t = f[<span class="string">&#x27;air&#x27;</span>].loc[<span class="string">&#x27;2005-07-01&#x27;</span>,:,:,<span class="number">80</span>:<span class="number">150</span>].mean(<span class="string">&#x27;lon&#x27;</span>)</span><br><span class="line">lev = t.level</span><br><span class="line">lat = t.lat</span><br><span class="line"><span class="comment">#创建Figure</span></span><br><span class="line">fig = plt.figure(figsize=(<span class="number">10</span>, <span class="number">8</span>))</span><br><span class="line"><span class="comment">#绘制500hPa位势高度场</span></span><br><span class="line">ax1 = fig.add_subplot(<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>)</span><br><span class="line"><span class="comment">#绘制温度场垂直剖面</span></span><br><span class="line">c1 = ax1.contour(lat, lev, t,colors=<span class="string">&#x27;k&#x27;</span>)</span><br><span class="line">ax1.clabel(c1, fmt=<span class="string">&#x27;%d&#x27;</span>, fontsize=<span class="number">14.5</span>,inline=<span class="literal">True</span>)</span><br><span class="line"><span class="comment">#设置y轴为对数坐标轴，并设置相关标签</span></span><br><span class="line">ax1.set_yscale(<span class="string">&#x27;symlog&#x27;</span>)</span><br><span class="line">ax1.set_xticks(np.arange(<span class="number">0</span>,<span class="number">12</span>,<span class="number">1</span>))</span><br><span class="line">ax1.set_yticks([<span class="number">1000</span>,<span class="number">850</span>,<span class="number">700</span>,<span class="number">500</span>,<span class="number">300</span>,<span class="number">200</span>,<span class="number">100</span>])</span><br><span class="line">ax1.set_yticklabels([<span class="number">1000</span>,<span class="number">850</span>,<span class="number">700</span>,<span class="number">500</span>,<span class="number">300</span>,<span class="number">200</span>,<span class="number">100</span>])</span><br><span class="line">ax1.set_ylim(<span class="number">1000</span>,<span class="number">100</span>)</span><br><span class="line"><span class="comment">#为ax1的x轴添加地理经纬度标签及刻度</span></span><br><span class="line">ax1.set_xticks(np.arange(-<span class="number">90</span>,<span class="number">120</span>,<span class="number">30</span>))</span><br><span class="line">ax1.xaxis.set_major_formatter(cticker.LongitudeFormatter())</span><br><span class="line"><span class="comment">#添加图题</span></span><br><span class="line">ax1.set_title(<span class="string">&#x27;July 2005 T&#x27;</span>,loc=<span class="string">&#x27;center&#x27;</span>,fontsize=<span class="number">18</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>




<pre><code>Text(0.5, 1.0, &#39;July 2005 T&#39;)
</code></pre>
<img src="https://cdn.kesci.com/upload/rt/7D95DD331CAC402783018CA3C64ED893/rpavj91f06.png">


<h2 id="9-6-填色图"><a href="#9-6-填色图" class="headerlink" title="9.6  填色图"></a>9.6  填色图</h2><h3 id="9-6-1-contourf"><a href="#9-6-1-contourf" class="headerlink" title="9.6.1  contourf()"></a>9.6.1  contourf()</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="comment">#生成数据</span></span><br><span class="line">x = np.arange(-<span class="number">10</span>,<span class="number">10</span>,<span class="number">0.01</span>)</span><br><span class="line">y = np.arange(-<span class="number">10</span>,<span class="number">10</span>,<span class="number">0.01</span>)</span><br><span class="line">x_grid,y_grid = np.meshgrid(x,y)</span><br><span class="line">z = x_grid**<span class="number">2</span>+y_grid**<span class="number">2</span></span><br><span class="line"><span class="comment">#创建Figure及Axes</span></span><br><span class="line">fig1 = plt.figure(figsize=(<span class="number">10</span>, <span class="number">8</span>))</span><br><span class="line"><span class="comment">#基础填色图</span></span><br><span class="line">ax1 = fig1.add_subplot(<span class="number">2</span>,<span class="number">2</span>,<span class="number">1</span>)</span><br><span class="line">ca = ax1.contourf(x,y,z)</span><br><span class="line">ax1.set_title(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">fig1.colorbar(ca,ax=ax1)</span><br><span class="line"><span class="comment">#填充等值线图</span></span><br><span class="line">ax2 = fig1.add_subplot(<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>)</span><br><span class="line">cb1 = ax2.contour(x,y,z,colors=<span class="string">&quot;k&quot;</span>)</span><br><span class="line">cb2 = ax2.contourf(x,y,z,hatches=[<span class="string">&#x27;.&#x27;</span>,<span class="string">&#x27;,,&#x27;</span>,<span class="string">&#x27;-&#x27;</span>, <span class="string">&#x27;/&#x27;</span>, <span class="string">&#x27;\\&#x27;</span>, <span class="string">&#x27;//&#x27;</span>],colors=<span class="string">&quot;none&quot;</span>)</span><br><span class="line">ax2.set_title(<span class="string">&#x27;b&#x27;</span>)</span><br><span class="line">fig1.colorbar(ca,ax=ax2)</span><br><span class="line"><span class="comment">#特定level值的填色图1</span></span><br><span class="line">ax3 = fig1.add_subplot(<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>)</span><br><span class="line">cc = ax3.contourf(x,y,z,levels=np.arange(<span class="number">60</span>,<span class="number">150</span>,<span class="number">30</span>))</span><br><span class="line">ax3.set_title(<span class="string">&#x27;c&#x27;</span>)</span><br><span class="line">fig1.colorbar(cc,ax=ax3)</span><br><span class="line"><span class="comment">#特定level值的填色图2</span></span><br><span class="line">ax4 = fig1.add_subplot(<span class="number">2</span>,<span class="number">2</span>,<span class="number">4</span>)</span><br><span class="line">cd = contour = ax4.contourf(x,y,z,levels=np.arange(<span class="number">60</span>,<span class="number">150</span>,<span class="number">30</span>),extend=<span class="string">&#x27;both&#x27;</span>)</span><br><span class="line">ax4.set_title(<span class="string">&#x27;d&#x27;</span>)</span><br><span class="line">fig1.colorbar(cd,ax=ax4)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<pre><code>/opt/conda/lib/python3.7/site-packages/ipykernel_launcher.py:18: MatplotlibDeprecationWarning: hatch must consist of a string of &quot;*+-./OX\ox|&quot; or None, but found the following invalid values &quot;,&quot;. Passing invalid values is deprecated since 3.4 and will become an error in 3.7.
</code></pre>
<img src="https://cdn.kesci.com/upload/rt/1A6B6BBFCBA84C658FB51FFC511B159A/rpavjbm29n.png">



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> xarray <span class="keyword">as</span> xr</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> cartopy.crs <span class="keyword">as</span> ccrs</span><br><span class="line"><span class="keyword">import</span> cartopy.feature <span class="keyword">as</span> cfeature</span><br><span class="line"><span class="keyword">import</span> cartopy.mpl.ticker <span class="keyword">as</span> cticker</span><br><span class="line"><span class="comment">#读取数据</span></span><br><span class="line">f = xr.open_dataset(<span class="string">&#x27;/home/mw/input/pythonbook9857/data.nc&#x27;</span>)</span><br><span class="line">z = f[<span class="string">&#x27;hgt&#x27;</span>].loc[<span class="string">&#x27;2005-07-01&#x27;</span>,<span class="number">500</span>,:,:]</span><br><span class="line">t = f[<span class="string">&#x27;air&#x27;</span>].loc[<span class="string">&#x27;2005-07-01&#x27;</span>,<span class="number">700</span>,:,:]</span><br><span class="line">lat = f[<span class="string">&#x27;lat&#x27;</span>]</span><br><span class="line">lon = f[<span class="string">&#x27;lon&#x27;</span>]</span><br><span class="line"><span class="comment">#创建Figure</span></span><br><span class="line">fig = plt.figure(figsize=(<span class="number">15</span>, <span class="number">12</span>))</span><br><span class="line"><span class="comment">#绘制500hPa位势高度场</span></span><br><span class="line">ax1 = fig.add_subplot(<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>, projection=ccrs.PlateCarree())</span><br><span class="line"><span class="comment">#设置ax1的范围</span></span><br><span class="line">ax1.set_extent([<span class="number">60</span>,<span class="number">180</span>,<span class="number">0</span>,<span class="number">90</span>])</span><br><span class="line"><span class="comment">#为ax1添加海岸线</span></span><br><span class="line"><span class="comment">#ax1.coastlines()</span></span><br><span class="line"><span class="comment">#为ax1添加地理经纬度标签及刻度</span></span><br><span class="line">ax1.set_xticks(np.arange(<span class="number">60</span>,<span class="number">210</span>,<span class="number">30</span>), crs=ccrs.PlateCarree())</span><br><span class="line">ax1.set_yticks(np.arange(<span class="number">0</span>,<span class="number">90</span>,<span class="number">30</span>), crs=ccrs.PlateCarree())</span><br><span class="line">ax1.xaxis.set_major_formatter(cticker.LongitudeFormatter())</span><br><span class="line">ax1.yaxis.set_major_formatter(cticker.LatitudeFormatter())</span><br><span class="line"><span class="comment">#将700hPa温度场绘制为填色等值线图</span></span><br><span class="line">c1 = ax1.contourf(lon, lat, t,levels=np.arange(-<span class="number">21</span>,<span class="number">22</span>,<span class="number">1</span>),extend=<span class="string">&#x27;both&#x27;</span>,cmap=<span class="string">&#x27;bwr&#x27;</span>,zorder=<span class="number">1</span>,transform=ccrs.PlateCarree())</span><br><span class="line"><span class="comment">#把温度大于(小于)10(-10)℃的区域覆盖上阴影，100(-100)可以换为更大或更小的数，只是用于表明区间</span></span><br><span class="line">c2 = ax1.contourf(lon, lat, t,levels=[-<span class="number">100</span>,-<span class="number">10</span>,<span class="number">10</span>,<span class="number">100</span>],hatches=[<span class="string">&#x27;//&#x27;</span>, <span class="literal">None</span>,<span class="string">&#x27;//&#x27;</span>],zorder=<span class="number">2</span>,colors=<span class="string">&#x27;none&#x27;</span>,transform=ccrs.PlateCarree())</span><br><span class="line"><span class="comment">#从5000到5880每间隔80绘制一条黑色的等值线</span></span><br><span class="line">c3 = ax1.contour(lon, lat, z,levels=np.arange(<span class="number">5000</span>,<span class="number">5880</span>,<span class="number">80</span>), colors=<span class="string">&#x27;k&#x27;</span>,zorder=<span class="number">3</span>,transform=ccrs.PlateCarree())</span><br><span class="line"><span class="comment">#为c1添加数值标签，标签格式为整型</span></span><br><span class="line">ax1.clabel(c3, fmt=<span class="string">&#x27;%d&#x27;</span>, fontsize=<span class="number">14.5</span>,inline=<span class="literal">True</span>)</span><br><span class="line"><span class="comment">#单独绘制加粗并且用虚线表示的5880副高特征线</span></span><br><span class="line">c4 = ax1.contour(lon, lat, z,levels = [<span class="number">5880</span>],colors=<span class="string">&#x27;k&#x27;</span>,zorder=<span class="number">4</span>,transform=ccrs.PlateCarree(),linewidths=<span class="number">3</span>,linestyles=<span class="string">&#x27;--&#x27;</span>)</span><br><span class="line"><span class="comment">#为c2添加数值标签，标签格式为浮点型（保留一位小数）</span></span><br><span class="line">ax1.clabel(c4, fmt=<span class="string">&#x27;%d&#x27;</span>, fontsize=<span class="number">14.5</span>,inline=<span class="literal">True</span>)</span><br><span class="line"><span class="comment">#添加图题</span></span><br><span class="line">ax1.set_title(<span class="string">&#x27;July 2005 500hPa Z&amp;T&#x27;</span>,loc=<span class="string">&#x27;center&#x27;</span>,fontsize=<span class="number">18</span>)</span><br><span class="line"><span class="comment">#添加色标</span></span><br><span class="line">fig.colorbar(c1,ax=ax1,fraction=<span class="number">0.032</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<img src="https://cdn.kesci.com/upload/rt/1BF0218CC6C74A96A105C1931A5BB2A3/rpavjcgav2.png">


<h3 id="9-6-2-pcolor"><a href="#9-6-2-pcolor" class="headerlink" title="9.6.2  pcolor()"></a>9.6.2  pcolor()</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> xarray <span class="keyword">as</span> xr</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> cartopy.crs <span class="keyword">as</span> ccrs</span><br><span class="line"><span class="keyword">import</span> cartopy.feature <span class="keyword">as</span> cfeature</span><br><span class="line"><span class="comment">#读取数据</span></span><br><span class="line">f = xr.open_dataset(<span class="string">&#x27;/home/mw/input/pythonbook9857/data.nc&#x27;</span>)</span><br><span class="line">z = f[<span class="string">&#x27;hgt&#x27;</span>].loc[<span class="string">&#x27;2005-07-01&#x27;</span>,<span class="number">500</span>,:,:]</span><br><span class="line">t = f[<span class="string">&#x27;air&#x27;</span>].loc[<span class="string">&#x27;2005-07-01&#x27;</span>,<span class="number">700</span>,:,:]</span><br><span class="line">lat = f[<span class="string">&#x27;lat&#x27;</span>]</span><br><span class="line">lon = f[<span class="string">&#x27;lon&#x27;</span>]</span><br><span class="line"><span class="comment">#创建Figure</span></span><br><span class="line">fig = plt.figure(figsize=(<span class="number">15</span>, <span class="number">12</span>))</span><br><span class="line"><span class="comment">#绘制500hPa位势高度场</span></span><br><span class="line">ax1 = fig.add_subplot(<span class="number">2</span>,<span class="number">2</span>,<span class="number">1</span>, projection=ccrs.PlateCarree())</span><br><span class="line"><span class="comment">#设置ax1的范围</span></span><br><span class="line">ax1.set_extent([<span class="number">60</span>,<span class="number">180</span>,<span class="number">0</span>,<span class="number">90</span>])</span><br><span class="line"><span class="comment">#为ax1添加海岸线</span></span><br><span class="line"><span class="comment">#ax1.coastlines()</span></span><br><span class="line"><span class="comment">#为ax1添加地理经纬度标签及刻度</span></span><br><span class="line">ax1.set_xticks(np.arange(<span class="number">60</span>,<span class="number">210</span>,<span class="number">30</span>), crs=ccrs.PlateCarree())</span><br><span class="line">ax1.set_yticks(np.arange(<span class="number">0</span>,<span class="number">90</span>,<span class="number">30</span>), crs=ccrs.PlateCarree())</span><br><span class="line">ax1.xaxis.set_major_formatter(cticker.LongitudeFormatter())</span><br><span class="line">ax1.yaxis.set_major_formatter(cticker.LatitudeFormatter())</span><br><span class="line"><span class="comment">#将700hPa温度场绘制为填色等值线图</span></span><br><span class="line">c1 = ax1.pcolor(lon, lat, t,vmin=-<span class="number">20</span>, vmax=<span class="number">20</span>,cmap=<span class="string">&#x27;bwr&#x27;</span>,zorder=<span class="number">1</span>,transform=ccrs.PlateCarree())</span><br><span class="line"><span class="comment">#添加图题</span></span><br><span class="line">ax1.set_title(<span class="string">&#x27;(a) July 2005 500hPa T&#x27;</span>,loc=<span class="string">&#x27;center&#x27;</span>,fontsize=<span class="number">18</span>)</span><br><span class="line"><span class="comment">#添加色标</span></span><br><span class="line">fig.colorbar(c1,ax=ax1,fraction=<span class="number">0.032</span>)</span><br><span class="line"><span class="comment">#ax2</span></span><br><span class="line">ax2 = fig.add_subplot(<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>, projection=ccrs.PlateCarree())</span><br><span class="line"><span class="comment">#设置ax2的范围</span></span><br><span class="line">ax2.set_extent([<span class="number">60</span>,<span class="number">180</span>,<span class="number">0</span>,<span class="number">90</span>])</span><br><span class="line"><span class="comment">#为ax2添加海岸线</span></span><br><span class="line"><span class="comment">#ax2.coastlines()</span></span><br><span class="line"><span class="comment">#为ax2添加地理经纬度标签及刻度</span></span><br><span class="line">ax2.set_xticks(np.arange(<span class="number">60</span>,<span class="number">210</span>,<span class="number">30</span>), crs=ccrs.PlateCarree())</span><br><span class="line">ax2.set_yticks(np.arange(<span class="number">0</span>,<span class="number">90</span>,<span class="number">30</span>), crs=ccrs.PlateCarree())</span><br><span class="line">ax2.xaxis.set_major_formatter(cticker.LongitudeFormatter())</span><br><span class="line">ax2.yaxis.set_major_formatter(cticker.LatitudeFormatter())</span><br><span class="line"><span class="comment">#将700hPa温度场绘制为填色等值线图</span></span><br><span class="line">c2 = ax2.pcolor(lon, lat, t, vmin=-<span class="number">20</span>, vmax=<span class="number">20</span>, cmap=<span class="string">&#x27;bwr&#x27;</span>, zorder=<span class="number">1</span>, edgecolors=<span class="string">&#x27;k&#x27;</span>, transform=ccrs.PlateCarree())</span><br><span class="line"><span class="comment">#添加图题</span></span><br><span class="line">ax2.set_title(<span class="string">&#x27;(b) July 2005 500hPa T&#x27;</span>,loc=<span class="string">&#x27;center&#x27;</span>,fontsize=<span class="number">18</span>)</span><br><span class="line"><span class="comment">#添加色标</span></span><br><span class="line">fig.colorbar(c2,ax=ax2,fraction=<span class="number">0.032</span>)</span><br><span class="line"><span class="comment">#创建一个t_copy数组并将大于15的数据设置为缺测</span></span><br><span class="line">t_copy = t.values.copy()</span><br><span class="line">t_copy[t_copy&gt;<span class="number">15</span>] = np.nan</span><br><span class="line"><span class="comment">#ax3</span></span><br><span class="line">ax3 = fig.add_subplot(<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>, projection=ccrs.PlateCarree())</span><br><span class="line"><span class="comment">#设置ax3的范围</span></span><br><span class="line">ax3.set_extent([<span class="number">60</span>,<span class="number">180</span>,<span class="number">0</span>,<span class="number">90</span>])</span><br><span class="line"><span class="comment">#为ax3添加海岸线</span></span><br><span class="line"><span class="comment">#ax3.coastlines()</span></span><br><span class="line"><span class="comment">#为ax3添加地理经纬度标签及刻度</span></span><br><span class="line">ax3.set_xticks(np.arange(<span class="number">60</span>,<span class="number">210</span>,<span class="number">30</span>), crs=ccrs.PlateCarree())</span><br><span class="line">ax3.set_yticks(np.arange(<span class="number">0</span>,<span class="number">90</span>,<span class="number">30</span>), crs=ccrs.PlateCarree())</span><br><span class="line">ax3.xaxis.set_major_formatter(cticker.LongitudeFormatter())</span><br><span class="line">ax3.yaxis.set_major_formatter(cticker.LatitudeFormatter())</span><br><span class="line"><span class="comment">#将700hPa温度场绘制为填色等值线图</span></span><br><span class="line">c3 = ax3.contourf(lon, lat, t_copy,levels=np.arange(-<span class="number">21</span>,<span class="number">22</span>,<span class="number">1</span>), extend=<span class="string">&#x27;both&#x27;</span>, cmap=<span class="string">&#x27;bwr&#x27;</span>, zorder=<span class="number">1</span>, transform=ccrs.PlateCarree())</span><br><span class="line"><span class="comment">#添加图题</span></span><br><span class="line">ax3.set_title(<span class="string">&#x27;(c) July 2005 500hPa T&#x27;</span>,loc=<span class="string">&#x27;center&#x27;</span>,fontsize=<span class="number">18</span>)</span><br><span class="line"><span class="comment">#添加色标</span></span><br><span class="line">fig.colorbar(c3,ax=ax3,fraction=<span class="number">0.032</span>)</span><br><span class="line"><span class="comment">#ax4</span></span><br><span class="line">ax4 = fig.add_subplot(<span class="number">2</span>,<span class="number">2</span>,<span class="number">4</span>, projection=ccrs.PlateCarree())</span><br><span class="line"><span class="comment">#设置ax4的范围</span></span><br><span class="line">ax4.set_extent([<span class="number">60</span>,<span class="number">180</span>,<span class="number">0</span>,<span class="number">90</span>])</span><br><span class="line"><span class="comment">#为ax4添加海岸线</span></span><br><span class="line"><span class="comment">#ax4.coastlines()</span></span><br><span class="line"><span class="comment">#为ax4添加地理经纬度标签及刻度</span></span><br><span class="line">ax4.set_xticks(np.arange(<span class="number">60</span>,<span class="number">210</span>,<span class="number">30</span>), crs=ccrs.PlateCarree())</span><br><span class="line">ax4.set_yticks(np.arange(<span class="number">0</span>,<span class="number">90</span>,<span class="number">30</span>), crs=ccrs.PlateCarree())</span><br><span class="line">ax4.xaxis.set_major_formatter(cticker.LongitudeFormatter())</span><br><span class="line">ax4.yaxis.set_major_formatter(cticker.LatitudeFormatter())</span><br><span class="line"><span class="comment">#将700hPa温度场绘制为填色等值线图</span></span><br><span class="line">c4 = ax4.pcolor(lon, lat, t_copy,vmin=-<span class="number">20</span>, vmax=<span class="number">20</span>,cmap=<span class="string">&#x27;bwr&#x27;</span>,zorder=<span class="number">1</span>,edgecolors=<span class="string">&#x27;k&#x27;</span>,transform=ccrs.PlateCarree())</span><br><span class="line"><span class="comment">#添加图题</span></span><br><span class="line">ax4.set_title(<span class="string">&#x27;(d) July 2005 500hPa T&#x27;</span>,loc=<span class="string">&#x27;center&#x27;</span>,fontsize=<span class="number">18</span>)</span><br><span class="line"><span class="comment">#添加色标</span></span><br><span class="line">fig.colorbar(c4,ax=ax4,fraction=<span class="number">0.032</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<img src="https://cdn.kesci.com/upload/rt/FD5C1EF2AA7F4B3185451EBD419367BC/rpavjm9f9t.png">


<h2 id="9-7-轨迹绘制（以台风路径的绘制为例）"><a href="#9-7-轨迹绘制（以台风路径的绘制为例）" class="headerlink" title="9.7  轨迹绘制（以台风路径的绘制为例）"></a>9.7  轨迹绘制（以台风路径的绘制为例）</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> pathlib <span class="keyword">import</span> Path</span><br><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> <span class="type">List</span></span><br><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> <span class="type">Union</span></span><br><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> <span class="type">Tuple</span></span><br><span class="line"><span class="keyword">from</span> matplotlib.collections <span class="keyword">import</span> LineCollection</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> cartopy.crs <span class="keyword">as</span> ccrs</span><br><span class="line"><span class="keyword">import</span> cartopy.feature <span class="keyword">as</span> cfeature</span><br><span class="line"><span class="comment">#读取CMA热带气旋最佳路径数据集</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">reader</span>(<span class="params"></span></span><br><span class="line"><span class="params">   typhoon_txt: os.PathLike, code: <span class="type">Union</span>[<span class="built_in">str</span>, <span class="built_in">int</span>]</span></span><br><span class="line"><span class="params"></span>) -&gt; <span class="type">Tuple</span>[<span class="type">List</span>[<span class="built_in">str</span>], pd.DataFrame]:</span><br><span class="line">   typhoon_txt = Path(typhoon_txt)</span><br><span class="line">   <span class="keyword">if</span> <span class="built_in">isinstance</span>(code, <span class="built_in">int</span>):</span><br><span class="line">      code = <span class="string">&quot;&#123;:04&#125;&quot;</span>.<span class="built_in">format</span>(code)</span><br><span class="line">   <span class="keyword">with</span> <span class="built_in">open</span>(typhoon_txt, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> txt_handle:</span><br><span class="line">      <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">         header = txt_handle.readline().split()</span><br><span class="line">         <span class="keyword">if</span> <span class="keyword">not</span> header:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">f&quot;没有在文件里找到编号为<span class="subst">&#123;code&#125;</span>的台风的数据&quot;</span>)</span><br><span class="line">         <span class="keyword">if</span> header[<span class="number">4</span>].strip() == code:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">         [txt_handle.readline() <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">int</span>(header[<span class="number">2</span>]))]</span><br><span class="line">      data_path = pd.read_table(</span><br><span class="line">         txt_handle,</span><br><span class="line">         sep=<span class="string">r&quot;\s+&quot;</span>,</span><br><span class="line">         header=<span class="literal">None</span>,</span><br><span class="line">         names=[<span class="string">&quot;TIME&quot;</span>, <span class="string">&quot;I&quot;</span>, <span class="string">&quot;LAT&quot;</span>, <span class="string">&quot;LONG&quot;</span>, <span class="string">&quot;PRES&quot;</span>, <span class="string">&quot;WND&quot;</span>, <span class="string">&quot;OWD&quot;</span>],</span><br><span class="line">         nrows=<span class="built_in">int</span>(header[<span class="number">2</span>]),</span><br><span class="line">         dtype=&#123;</span><br><span class="line">            <span class="string">&quot;I&quot;</span>: np.<span class="built_in">int</span>,</span><br><span class="line">            <span class="string">&quot;LAT&quot;</span>: np.float32,</span><br><span class="line">            <span class="string">&quot;LONG&quot;</span>: np.float32,</span><br><span class="line">            <span class="string">&quot;PRES&quot;</span>: np.float32,</span><br><span class="line">            <span class="string">&quot;WND&quot;</span>: np.float32,</span><br><span class="line">            <span class="string">&quot;OWD&quot;</span>: np.float32,</span><br><span class="line">         &#125;,</span><br><span class="line">         parse_dates=<span class="literal">True</span>,</span><br><span class="line">         date_parser=<span class="keyword">lambda</span> x: pd.to_datetime(x, <span class="built_in">format</span>=<span class="string">f&quot;%Y%m%d%H&quot;</span>),</span><br><span class="line">         index_col=<span class="string">&quot;TIME&quot;</span>,</span><br><span class="line">      )</span><br><span class="line">      data_path[<span class="string">&quot;LAT&quot;</span>] = data_path[<span class="string">&quot;LAT&quot;</span>] / <span class="number">10</span></span><br><span class="line">      data_path[<span class="string">&quot;LONG&quot;</span>] = data_path[<span class="string">&quot;LONG&quot;</span>] / <span class="number">10</span></span><br><span class="line">      <span class="keyword">return</span> header, data_path</span><br><span class="line"><span class="comment">#读取0608号台风的数据（数据为超6小时的占风相关信息）</span></span><br><span class="line">head, dat = reader(<span class="string">r&quot;/home/mw/input/pythonbook9857/CH2006BST.txt&quot;</span>,<span class="string">&#x27;0608&#x27;</span>)</span><br><span class="line">lat = dat.LAT</span><br><span class="line">lon = dat.LONG</span><br><span class="line">level = dat.I</span><br><span class="line">pressure = dat.PRES</span><br><span class="line"><span class="comment">#创建Figure</span></span><br><span class="line">fig = plt.figure(figsize=(<span class="number">15</span>, <span class="number">12</span>))</span><br><span class="line"><span class="comment">#绘制台风路径</span></span><br><span class="line">ax1 = fig.add_subplot(<span class="number">1</span>,<span class="number">2</span>,<span class="number">1</span>, projection=ccrs.PlateCarree())</span><br><span class="line"><span class="comment">#设置ax1的范围</span></span><br><span class="line">ax1.set_extent([<span class="number">100</span>,<span class="number">160</span>,-<span class="number">10</span>,<span class="number">40</span>])</span><br><span class="line"><span class="comment">#为ax1添加海岸线</span></span><br><span class="line"><span class="comment">#ax1.coastlines()</span></span><br><span class="line"><span class="comment">#ax1.add_feature(cfeature.LAND) #添加大陆特征</span></span><br><span class="line"><span class="comment">#为ax1添加地理经纬度标签及刻度</span></span><br><span class="line">ax1.set_xticks(np.arange(<span class="number">100</span>,<span class="number">170</span>,<span class="number">10</span>), crs=ccrs.PlateCarree())</span><br><span class="line">ax1.set_yticks(np.arange(-<span class="number">10</span>,<span class="number">50</span>,<span class="number">10</span>), crs=ccrs.PlateCarree())</span><br><span class="line">ax1.xaxis.set_major_formatter(cticker.LongitudeFormatter())</span><br><span class="line">ax1.yaxis.set_major_formatter(cticker.LatitudeFormatter())</span><br><span class="line"><span class="comment">#绘制台风路径，并将标记逐6小时坐标点及其对应的台风强度</span></span><br><span class="line">ax1.plot(lon,lat,linewidth=<span class="number">2</span>)</span><br><span class="line">s1 = ax1.scatter(lon,lat,c=pressure,s=(level+<span class="number">1</span>)*<span class="number">13</span>,cmap=<span class="string">&#x27;Reds_r&#x27;</span>,vmax=<span class="number">1050</span>,vmin=<span class="number">900</span>,alpha=<span class="number">1</span>)</span><br><span class="line">fig.colorbar(s1,ax=ax1,fraction=<span class="number">0.04</span>)</span><br><span class="line"><span class="comment">#绘制台风路径</span></span><br><span class="line">ax2 = fig.add_subplot(<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>, projection=ccrs.PlateCarree())</span><br><span class="line"><span class="comment">#设置ax2的范围</span></span><br><span class="line">ax2.set_extent([<span class="number">100</span>,<span class="number">160</span>,-<span class="number">10</span>,<span class="number">40</span>])</span><br><span class="line"><span class="comment">#为ax2添加海岸线</span></span><br><span class="line"><span class="comment">#ax2.coastlines()</span></span><br><span class="line"><span class="comment">#ax2.add_feature(cfeature.LAND) #添加大陆特征</span></span><br><span class="line"><span class="comment">#为ax2添加地理经纬度标签及刻度</span></span><br><span class="line">ax2.set_xticks(np.arange(<span class="number">100</span>,<span class="number">170</span>,<span class="number">10</span>), crs=ccrs.PlateCarree())</span><br><span class="line">ax2.set_yticks(np.arange(-<span class="number">10</span>,<span class="number">50</span>,<span class="number">10</span>), crs=ccrs.PlateCarree())</span><br><span class="line">ax2.xaxis.set_major_formatter(cticker.LongitudeFormatter())</span><br><span class="line">ax2.yaxis.set_major_formatter(cticker.LatitudeFormatter())</span><br><span class="line"><span class="comment">#将经纬度数据存入同一数组</span></span><br><span class="line">points = np.array([lon, lat]).T.reshape(-<span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line">segments = np.concatenate([points[:-<span class="number">1</span>], points[<span class="number">1</span>:]], axis=<span class="number">1</span>)</span><br><span class="line"><span class="comment">#设置色标的标准化范围(即将Z维度的数据对应为颜色数组，Z维度指dat.WND[-1])</span></span><br><span class="line">norm = plt.Normalize(<span class="number">0</span>, <span class="number">80</span>)</span><br><span class="line"><span class="comment">#设置颜色线条</span></span><br><span class="line">lc = LineCollection(segments, cmap=<span class="string">&#x27;jet&#x27;</span>, norm=norm,transform=ccrs.PlateCarree())</span><br><span class="line">lc.set_array(dat.WND[:-<span class="number">1</span>])</span><br><span class="line"><span class="comment">#绘制线条</span></span><br><span class="line">line = ax2.add_collection(lc)   </span><br><span class="line">fig.colorbar(lc,ax=ax2,fraction=<span class="number">0.04</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<pre><code>/opt/conda/lib/python3.7/site-packages/ipykernel_launcher.py:34: DeprecationWarning: `np.int` is a deprecated alias for the builtin `int`. To silence this warning, use `int` by itself. Doing this will not modify any behavior and is safe. When replacing `np.int`, you may wish to use e.g. `np.int64` or `np.int32` to specify the precision. If you wish to review your current use, check the release note link for additional information.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
</code></pre>
<img src="https://cdn.kesci.com/upload/rt/B516128783154EB88AB470D77DC7C827/rpavjm5mi0.png">


<h2 id="9-8-流线图"><a href="#9-8-流线图" class="headerlink" title="9.8  流线图"></a>9.8  流线图</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> xarray <span class="keyword">as</span> xr</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> matplotlib.gridspec <span class="keyword">as</span> gridspec</span><br><span class="line"><span class="comment">#读取数据</span></span><br><span class="line">f = xr.open_dataset(<span class="string">&#x27;/home/mw/input/pythonbook9857/data.nc&#x27;</span>)</span><br><span class="line">u = f[<span class="string">&#x27;uwnd&#x27;</span>].loc[<span class="string">&#x27;2005-07-01&#x27;</span>,<span class="number">500</span>,:,:].values</span><br><span class="line">v = f[<span class="string">&#x27;vwnd&#x27;</span>].loc[<span class="string">&#x27;2005-07-01&#x27;</span>,<span class="number">500</span>,:,:].values</span><br><span class="line">lat = f[<span class="string">&#x27;lat&#x27;</span>]</span><br><span class="line">lon = f[<span class="string">&#x27;lon&#x27;</span>]</span><br><span class="line"><span class="comment">#创建Figure</span></span><br><span class="line">fig = plt.figure(figsize=(<span class="number">16</span>, <span class="number">13</span>))</span><br><span class="line"><span class="comment">#绘制500hPa位势高度场</span></span><br><span class="line">ax1 = fig.add_subplot(<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>, projection=ccrs.PlateCarree())</span><br><span class="line"><span class="comment">#设置ax1的范围</span></span><br><span class="line">ax1.set_extent([<span class="number">80</span>,<span class="number">140</span>,<span class="number">0</span>,<span class="number">40</span>])</span><br><span class="line"><span class="comment">#为ax1添加海岸线</span></span><br><span class="line"><span class="comment">#ax1.coastlines()</span></span><br><span class="line"><span class="comment">#为ax1添加地理经纬度标签及刻度</span></span><br><span class="line">ax1.set_xticks(np.arange(<span class="number">80</span>,<span class="number">160</span>,<span class="number">20</span>), crs=ccrs.PlateCarree())</span><br><span class="line">ax1.set_yticks(np.arange(<span class="number">0</span>,<span class="number">60</span>,<span class="number">20</span>), crs=ccrs.PlateCarree())</span><br><span class="line">ax1.xaxis.set_major_formatter(cticker.LongitudeFormatter())</span><br><span class="line">ax1.yaxis.set_major_formatter(cticker.LatitudeFormatter())</span><br><span class="line"><span class="comment">#绘制500hPa风矢量流线图</span></span><br><span class="line">q1 = ax1.streamplot(lon, lat, u, v,density=[<span class="number">1</span>, <span class="number">5</span>],transform=ccrs.PlateCarree())</span><br><span class="line">plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<img src="https://cdn.kesci.com/upload/rt/1DC9F8E9520449BC86E66547DF64105F/rpavjqvjdn.png">


<h2 id="9-9-矢量箭头图"><a href="#9-9-矢量箭头图" class="headerlink" title="9.9  矢量箭头图"></a>9.9  矢量箭头图</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">fig = plt.figure(figsize=(<span class="number">15</span>, <span class="number">3</span>))</span><br><span class="line">ax1 = fig.add_subplot(<span class="number">1</span>,<span class="number">2</span>,<span class="number">1</span>)</span><br><span class="line"><span class="comment"># 默认</span></span><br><span class="line">q1 = ax1.quiver(<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line"><span class="comment"># scale：缩放比例，值越大，箭头越短</span></span><br><span class="line">q2 = ax1.quiver(<span class="number">0.1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, scale=<span class="number">15</span>)</span><br><span class="line"><span class="comment"># width：主轴宽度</span></span><br><span class="line">q3 = ax1.quiver(<span class="number">0.2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, width=<span class="number">0.05</span>)</span><br><span class="line"><span class="comment"># headwidth：矢量符号箭头头部的宽度</span></span><br><span class="line">q4 = ax1.quiver(<span class="number">0.3</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, headwidth=<span class="number">8</span>)</span><br><span class="line"><span class="comment"># headlength：矢量符号箭头头部的长度，从头部到尾部</span></span><br><span class="line">q5 = ax1.quiver(<span class="number">0.4</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, headlength=<span class="number">8</span>)</span><br><span class="line"><span class="comment"># headaxislength 矢量符号箭头的头部到矢量符号轴和箭头的交接处的长度</span></span><br><span class="line">q6 = ax1.quiver(<span class="number">0.5</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, headwidth=<span class="number">8</span>, headlength=<span class="number">8</span>, headaxislength=<span class="number">2</span>)</span><br><span class="line"><span class="comment"># minlength 最小箭头长度，当矢量长度小于此值时，矢量将被替换为正六边形</span></span><br><span class="line">q7 = ax1.quiver(<span class="number">0.65</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, headwidth=<span class="number">4</span>, headlength=<span class="number">4</span>, minlength=<span class="number">10</span>)</span><br><span class="line">ax1.set_axis_off()</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<img src="https://cdn.kesci.com/upload/rt/54995A7C93274110A934EA57E9FA4B20/rpavjq1vfh.png">



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> xarray <span class="keyword">as</span> xr</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> cartopy.crs <span class="keyword">as</span> ccrs</span><br><span class="line"><span class="keyword">import</span> cartopy.feature <span class="keyword">as</span> cfeature</span><br><span class="line"><span class="comment">#读取数据</span></span><br><span class="line">f = xr.open_dataset(<span class="string">&#x27;/home/mw/input/pythonbook9857/data.nc&#x27;</span>)</span><br><span class="line">u = f[<span class="string">&#x27;uwnd&#x27;</span>].loc[<span class="string">&#x27;2005-07-01&#x27;</span>,<span class="number">500</span>,:,:].values</span><br><span class="line">v = f[<span class="string">&#x27;vwnd&#x27;</span>].loc[<span class="string">&#x27;2005-07-01&#x27;</span>,<span class="number">500</span>,:,:].values</span><br><span class="line">lat = f[<span class="string">&#x27;lat&#x27;</span>]</span><br><span class="line">lon = f[<span class="string">&#x27;lon&#x27;</span>]</span><br><span class="line"><span class="comment">#创建Figure</span></span><br><span class="line">fig = plt.figure(figsize=(<span class="number">16</span>, <span class="number">13</span>))</span><br><span class="line"><span class="comment">#绘制500hPa位势高度场</span></span><br><span class="line">ax1 = fig.add_subplot(<span class="number">1</span>,<span class="number">2</span>,<span class="number">1</span>, projection=ccrs.Mercator())</span><br><span class="line"><span class="comment">#设置ax1的范围</span></span><br><span class="line">ax1.set_extent([<span class="number">80</span>,<span class="number">140</span>,<span class="number">0</span>,<span class="number">40</span>])</span><br><span class="line"><span class="comment">#为ax1添加海岸线</span></span><br><span class="line">ax1.coastlines()</span><br><span class="line"><span class="comment">#为ax1添加地理经纬度标签及刻度</span></span><br><span class="line">ax1.set_xticks(np.arange(<span class="number">80</span>,<span class="number">160</span>,<span class="number">20</span>), crs=ccrs.PlateCarree())</span><br><span class="line">ax1.set_yticks(np.arange(<span class="number">0</span>,<span class="number">60</span>,<span class="number">20</span>), crs=ccrs.PlateCarree())</span><br><span class="line">ax1.xaxis.set_major_formatter(cticker.LongitudeFormatter())</span><br><span class="line">ax1.yaxis.set_major_formatter(cticker.LatitudeFormatter())</span><br><span class="line"><span class="comment">#绘制500hPa水平风场</span></span><br><span class="line">q1 = ax1.quiver(lon, lat, u,v,scale=<span class="number">200</span>,transform=ccrs.PlateCarree())</span><br><span class="line"><span class="comment">#添加参考矢量</span></span><br><span class="line">ax1.quiverkey(q1,<span class="number">0.9</span>,<span class="number">1.01</span>,U=<span class="number">30</span>,label=<span class="string">&#x27;30m/s&#x27;</span>)</span><br><span class="line"><span class="comment">#添加图题</span></span><br><span class="line">ax1.set_title(<span class="string">&#x27;(a) July 2005 500hPa UV&#x27;</span>,loc=<span class="string">&#x27;center&#x27;</span>,fontsize=<span class="number">18</span>)</span><br><span class="line"><span class="comment">#绘制ax2</span></span><br><span class="line">ax2 = fig.add_subplot(<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>, projection=ccrs.Mercator())</span><br><span class="line"><span class="comment">#设置ax2的范围</span></span><br><span class="line">ax2.set_extent([<span class="number">80</span>,<span class="number">140</span>,<span class="number">0</span>,<span class="number">40</span>])</span><br><span class="line"><span class="comment">#为ax2添加海岸线</span></span><br><span class="line">ax2.coastlines()</span><br><span class="line"><span class="comment">#为ax2添加地理经纬度标签及刻度</span></span><br><span class="line">ax2.set_xticks(np.arange(<span class="number">80</span>,<span class="number">160</span>,<span class="number">20</span>), crs=ccrs.PlateCarree())</span><br><span class="line">ax2.set_yticks(np.arange(<span class="number">0</span>,<span class="number">60</span>,<span class="number">20</span>), crs=ccrs.PlateCarree())</span><br><span class="line">ax2.xaxis.set_major_formatter(cticker.LongitudeFormatter())</span><br><span class="line">ax2.yaxis.set_major_formatter(cticker.LatitudeFormatter())</span><br><span class="line"><span class="comment">#绘制500hPa水平风场，[::2,::2]表示每隔两个栅格绘制一次，避免箭头过于密集</span></span><br><span class="line">q1 = ax2.quiver(lon[::<span class="number">2</span>], lat[::<span class="number">2</span>], u[::<span class="number">2</span>,::<span class="number">2</span>], v[::<span class="number">2</span>,::<span class="number">2</span>], scale=<span class="number">200</span>, transform=ccrs.PlateCarree())</span><br><span class="line"><span class="comment">#添加参考矢量</span></span><br><span class="line">ax1.quiverkey(q1,<span class="number">0.9</span>,<span class="number">1.01</span>,U=<span class="number">30</span>,label=<span class="string">&#x27;30m/s&#x27;</span>)</span><br><span class="line"><span class="comment">#添加图题</span></span><br><span class="line">ax2.set_title(<span class="string">&#x27;(b) July 2005 500hPa UV&#x27;</span>,loc=<span class="string">&#x27;center&#x27;</span>,fontsize=<span class="number">18</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<pre><code>/opt/conda/lib/python3.7/site-packages/cartopy/io/__init__.py:260: DownloadWarning: Downloading: https://naciscdn.org/naturalearth/50m/physical/ne_50m_coastline.zip
  warnings.warn(&#39;Downloading: &#123;&#125;&#39;.format(url), DownloadWarning)
</code></pre>
<img src="https://cdn.kesci.com/upload/rt/7944862F31E84FFA81D993B496F00B0B/rpavjtv1b7.png">



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> xarray <span class="keyword">as</span> xr</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> cartopy.crs <span class="keyword">as</span> ccrs</span><br><span class="line"><span class="keyword">import</span> cartopy.feature <span class="keyword">as</span> cfeature</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="comment">#读取数据</span></span><br><span class="line">f = xr.open_dataset(<span class="string">&#x27;/home/mw/input/pythonbook9857/data.nc&#x27;</span>)</span><br><span class="line">u = f[<span class="string">&#x27;uwnd&#x27;</span>].loc[<span class="string">&#x27;2005-01-01&#x27;</span>:<span class="string">&#x27;2005-12-01&#x27;</span>,:,<span class="number">35</span>,<span class="number">120</span>]</span><br><span class="line">w = f[<span class="string">&#x27;omega&#x27;</span>].loc[<span class="string">&#x27;2005-01-01&#x27;</span>:<span class="string">&#x27;2005-12-01&#x27;</span>,:,<span class="number">35</span>,<span class="number">120</span>]</span><br><span class="line">time = u.time</span><br><span class="line">lev = u.level</span><br><span class="line"><span class="comment">#创建Figure</span></span><br><span class="line">fig = plt.figure(figsize=(<span class="number">16</span>, <span class="number">13</span>))</span><br><span class="line"><span class="comment">#绘制500hPa位势高度场</span></span><br><span class="line">ax1 = fig.add_subplot(<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>)</span><br><span class="line"><span class="comment">#绘制500hPa水平风场</span></span><br><span class="line">q1 = ax1.quiver(<span class="built_in">range</span>(time.shape[<span class="number">0</span>]), lev, u,w*<span class="number">200</span>,pivot=<span class="string">&#x27;mid&#x27;</span>)</span><br><span class="line"><span class="comment">#添加参考矢量</span></span><br><span class="line">ax1.quiverkey(q1,<span class="number">0.9</span>,<span class="number">1.01</span>,U=<span class="number">30</span>,label=<span class="string">&#x27;30m/s&#x27;</span>)</span><br><span class="line"><span class="comment">#设置y轴为对数坐标轴，并设置相关标签</span></span><br><span class="line">ax1.set_yscale(<span class="string">&#x27;symlog&#x27;</span>)</span><br><span class="line">ax1.set_xticks(np.arange(<span class="number">0</span>,<span class="number">12</span>,<span class="number">1</span>))</span><br><span class="line">ax1.set_yticks([<span class="number">1000</span>,<span class="number">850</span>,<span class="number">700</span>,<span class="number">500</span>,<span class="number">300</span>,<span class="number">200</span>,<span class="number">100</span>])</span><br><span class="line">ax1.set_yticklabels([<span class="number">1000</span>,<span class="number">850</span>,<span class="number">700</span>,<span class="number">500</span>,<span class="number">300</span>,<span class="number">200</span>,<span class="number">100</span>])</span><br><span class="line">ax1.set_ylim(<span class="number">1050</span>,<span class="number">90</span>)</span><br><span class="line"><span class="comment">#设置x轴标签</span></span><br><span class="line">ax1.set_xlim(-<span class="number">1</span>,<span class="number">12</span>)</span><br><span class="line">ax1.set_xticks(np.arange(<span class="number">0</span>,<span class="number">12</span>,<span class="number">1</span>))</span><br><span class="line">ax1.set_xticklabels(pd.date_range(start=<span class="string">&#x27;2005-01&#x27;</span>,periods=<span class="number">12</span>,freq=<span class="string">&#x27;M&#x27;</span>).date )</span><br><span class="line"><span class="comment">#添加图题</span></span><br><span class="line">ax1.set_title(<span class="string">&#x27;2005 U&amp;OMEGA&#x27;</span>,loc=<span class="string">&#x27;center&#x27;</span>,fontsize=<span class="number">18</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<img src="https://cdn.kesci.com/upload/rt/DE659CBF04354BB4AE03B0CE22D257C1/rpavjtdguu.png">


<h2 id="9-10-风向杆图"><a href="#9-10-风向杆图" class="headerlink" title="9.10  风向杆图"></a>9.10  风向杆图</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> xarray <span class="keyword">as</span> xr</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> cartopy.crs <span class="keyword">as</span> ccrs</span><br><span class="line"><span class="keyword">import</span> cartopy.feature <span class="keyword">as</span> cfeature</span><br><span class="line"><span class="keyword">import</span> cartopy.mpl.ticker <span class="keyword">as</span> cticker</span><br><span class="line"><span class="comment">#读取数据</span></span><br><span class="line">f = xr.open_dataset(<span class="string">&#x27;/home/mw/input/pythonbook9857/data.nc&#x27;</span>)</span><br><span class="line">u = f[<span class="string">&#x27;uwnd&#x27;</span>].loc[<span class="string">&#x27;2005-07-01&#x27;</span>,<span class="number">500</span>,:,:].values</span><br><span class="line">v = f[<span class="string">&#x27;vwnd&#x27;</span>].loc[<span class="string">&#x27;2005-07-01&#x27;</span>,<span class="number">500</span>,:,:].values</span><br><span class="line">lat = f[<span class="string">&#x27;lat&#x27;</span>]</span><br><span class="line">lon = f[<span class="string">&#x27;lon&#x27;</span>]</span><br><span class="line"><span class="comment">#创建Figure</span></span><br><span class="line">fig = plt.figure(figsize=(<span class="number">16</span>, <span class="number">13</span>))</span><br><span class="line"><span class="comment">#绘制500hPa位势高度场</span></span><br><span class="line">ax1 = fig.add_subplot(<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>, projection=ccrs.Mercator())</span><br><span class="line"><span class="comment">#设置ax1的范围</span></span><br><span class="line">ax1.set_extent([<span class="number">80</span>,<span class="number">140</span>,<span class="number">0</span>,<span class="number">40</span>])</span><br><span class="line"><span class="comment">#为ax1添加海岸线</span></span><br><span class="line"><span class="comment">#ax1.coastlines()</span></span><br><span class="line"><span class="comment">#为ax1添加地理经纬度标签及刻度</span></span><br><span class="line">ax1.set_xticks(np.arange(<span class="number">80</span>,<span class="number">160</span>,<span class="number">20</span>), crs=ccrs.PlateCarree())</span><br><span class="line">ax1.set_yticks(np.arange(<span class="number">0</span>,<span class="number">60</span>,<span class="number">20</span>), crs=ccrs.PlateCarree())</span><br><span class="line">ax1.xaxis.set_major_formatter(cticker.LongitudeFormatter())</span><br><span class="line">ax1.yaxis.set_major_formatter(cticker.LatitudeFormatter())</span><br><span class="line"><span class="comment">#绘制500hPa水平风场</span></span><br><span class="line"><span class="comment">#Matplotlib原始的风向杆等级划分不适用于国内标准，所以需要额外指定符合标准的风向杆等级</span></span><br><span class="line">barb_increments = &#123;<span class="string">&#x27;half&#x27;</span>: <span class="number">2</span>, <span class="string">&#x27;full&#x27;</span>: <span class="number">4</span>, <span class="string">&#x27;flag&#x27;</span>: <span class="number">20</span>&#125;</span><br><span class="line">q1 = ax1.barbs(lon, lat, u,v,barb_increments=barb_increments,transform=ccrs.PlateCarree())</span><br><span class="line"><span class="comment">#添加图题</span></span><br><span class="line">ax1.set_title(<span class="string">&#x27;(a) July 2005 500hPa Wind&#x27;</span>,loc=<span class="string">&#x27;center&#x27;</span>,fontsize=<span class="number">18</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<img src="https://cdn.kesci.com/upload/rt/0F160E6F5736404CA78EBE4424CEEA41/rpavjtpf0n.png">


<h2 id="9-11-探空图"><a href="#9-11-探空图" class="headerlink" title="9.11  探空图"></a>9.11  探空图</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="comment"># MetPy中用于绘制探空图的类</span></span><br><span class="line"><span class="keyword">from</span> metpy.plots <span class="keyword">import</span> SkewT</span><br><span class="line"><span class="keyword">from</span> metpy.units <span class="keyword">import</span> units</span><br><span class="line"><span class="keyword">from</span> metpy.calc <span class="keyword">import</span> lcl</span><br><span class="line"><span class="keyword">from</span> metpy.calc <span class="keyword">import</span> parcel_profile</span><br><span class="line"><span class="comment"># 探空数据，原始的np.ndarray数组需要带上单位，转换为带单位的数据</span></span><br><span class="line"><span class="comment"># 气压层</span></span><br><span class="line">p = np.array([<span class="number">1000</span>, <span class="number">925</span>, <span class="number">850</span>, <span class="number">700</span>, <span class="number">600</span>, <span class="number">500</span>, <span class="number">450</span>, <span class="number">400</span>, <span class="number">300</span>, <span class="number">250</span>]) * units.hPa</span><br><span class="line"><span class="comment"># 气压层对应温度</span></span><br><span class="line">t = np.array([<span class="number">4</span>, <span class="number">8</span>, <span class="number">3</span>, -<span class="number">11</span>, -<span class="number">21</span>, -<span class="number">26</span>, -<span class="number">33</span>, -<span class="number">38</span>, -<span class="number">55</span>, -<span class="number">60</span>]) * units.degC</span><br><span class="line"><span class="comment"># 气压层对应露点</span></span><br><span class="line">td = np.array([-<span class="number">8</span>, -<span class="number">9</span>, -<span class="number">14</span>, -<span class="number">18</span>, -<span class="number">25</span>, -<span class="number">34</span>, -<span class="number">38</span>, -<span class="number">43</span>, -<span class="number">61</span>, -<span class="number">67</span>]) * units.degC</span><br><span class="line"><span class="comment"># 气压层对应风的U分量</span></span><br><span class="line">u = np.array([-<span class="number">0.39</span>, <span class="number">0.11</span>, <span class="number">3.1</span>, <span class="number">10.7</span>, <span class="number">16.61</span>, <span class="number">24.0</span>, <span class="number">20.31</span>, <span class="number">33.43</span>, <span class="number">49.32</span>, <span class="number">59.21</span>]) * units(<span class="string">&#x27;m/s&#x27;</span>)</span><br><span class="line"><span class="comment"># 气压层对应风的V分量</span></span><br><span class="line">v = np.array([-<span class="number">0.57</span>, -<span class="number">0.75</span>, -<span class="number">1.09</span>, -<span class="number">0.79</span>, -<span class="number">0.48</span>, -<span class="number">0.04</span>, -<span class="number">0.26</span>, <span class="number">0.96</span>, <span class="number">2.87</span>, <span class="number">4.14</span>]) * units(<span class="string">&#x27;m/s&#x27;</span>)</span><br><span class="line"><span class="comment"># 计算气块绝热抬升参数</span></span><br><span class="line">prof = parcel_profile(p, t[<span class="number">0</span>], td[<span class="number">0</span>]).to(<span class="string">&#x27;degC&#x27;</span>)</span><br><span class="line"><span class="comment"># 用最底层气压(这里是1000hPa)、温度和露点，计算抬升凝结高度对应的气压和温度</span></span><br><span class="line">lcl_pressure, lcl_temperature = lcl(p[<span class="number">0</span>], t[<span class="number">0</span>], td[<span class="number">0</span>])</span><br><span class="line">fig = plt.figure(figsize=(<span class="number">8</span>, <span class="number">7</span>))</span><br><span class="line"><span class="comment"># 用于绘制探空图的绘图实例</span></span><br><span class="line">skew = SkewT(fig)</span><br><span class="line"><span class="comment"># 绘制气块绝热抬升路径</span></span><br><span class="line">skew.plot(p, prof, <span class="string">&#x27;k&#x27;</span>)</span><br><span class="line"><span class="comment"># 在图上标出抬升凝结高度和对应温度所在的点</span></span><br><span class="line">skew.plot(lcl_pressure, lcl_temperature, <span class="string">&#x27;ko&#x27;</span>, markerfacecolor=<span class="string">&#x27;black&#x27;</span>)</span><br><span class="line"><span class="comment"># 绘制CIN阴影部分</span></span><br><span class="line">skew.shade_cin(p, t, prof)</span><br><span class="line"><span class="comment"># 绘制CAPE阴影部分</span></span><br><span class="line">skew.shade_cape(p, t, prof)</span><br><span class="line"><span class="comment"># 绘制0℃等温线</span></span><br><span class="line">skew.ax.axvline(<span class="number">0</span>, color=<span class="string">&#x27;c&#x27;</span>, linestyle=<span class="string">&#x27;--&#x27;</span>, linewidth=<span class="number">1</span>)</span><br><span class="line"><span class="comment"># 环境温度垂直廓线</span></span><br><span class="line">skew.plot(p, t, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line"><span class="comment"># 环境露点垂直廓线</span></span><br><span class="line">skew.plot(p, td, <span class="string">&#x27;g&#x27;</span>)</span><br><span class="line"><span class="comment"># 高度层对应水平风场(原始风向杆等级划分不适用于国内标准)</span></span><br><span class="line">barb_increments = &#123;<span class="string">&#x27;half&#x27;</span>: <span class="number">2</span>, <span class="string">&#x27;full&#x27;</span>: <span class="number">4</span>, <span class="string">&#x27;flag&#x27;</span>: <span class="number">20</span>&#125;</span><br><span class="line">skew.plot_barbs(p, u, v, barb_increments=barb_increments)</span><br><span class="line"><span class="comment"># 绘制干绝热线</span></span><br><span class="line">skew.plot_dry_adiabats(t0=np.arange(<span class="number">233</span>, <span class="number">533</span>, <span class="number">10</span>) * units.K, alpha=<span class="number">0.5</span>, color=<span class="string">&#x27;orangered&#x27;</span>, linewidth=<span class="number">0.7</span>)</span><br><span class="line"><span class="comment"># 绘制湿绝热线</span></span><br><span class="line">skew.plot_moist_adiabats(t0=np.arange(<span class="number">233</span>, <span class="number">400</span>, <span class="number">5</span>) * units.K, alpha=<span class="number">0.5</span>, color=<span class="string">&#x27;tab:green&#x27;</span>, linewidth=<span class="number">0.7</span>)</span><br><span class="line"><span class="comment"># 绘制混合比线</span></span><br><span class="line">skew.plot_mixing_lines(pressure=np.arange(<span class="number">1000</span>, <span class="number">99</span>, -<span class="number">20</span>) * units.hPa, linestyle=<span class="string">&#x27;dotted&#x27;</span>, color=<span class="string">&#x27;tab:blue&#x27;</span>, linewidth=<span class="number">0.7</span>)</span><br><span class="line"><span class="comment">#设置Y轴(高度层)范围</span></span><br><span class="line">skew.ax.set_ylim(<span class="number">1000</span>, <span class="number">250</span>)</span><br><span class="line"><span class="comment">#设置X轴(温度)范围</span></span><br><span class="line">skew.ax.set_xlim(-<span class="number">40</span>, <span class="number">50</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<img src="https://cdn.kesci.com/upload/rt/31E3F8F2C21D4E3491E3575DD238BE7E/rpavmj1b7k.png">


<h2 id="9-12-泰勒图"><a href="#9-12-泰勒图" class="headerlink" title="9.12  泰勒图"></a>9.12  泰勒图</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> matplotlib.projections <span class="keyword">import</span> PolarAxes</span><br><span class="line"><span class="keyword">from</span> mpl_toolkits.axisartist <span class="keyword">import</span> floating_axes</span><br><span class="line"><span class="keyword">from</span> mpl_toolkits.axisartist <span class="keyword">import</span> grid_finder</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="comment">#绘制泰勒图坐标系</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">set_tayloraxes</span>(<span class="params">fig, location</span>):</span><br><span class="line"><span class="comment">#新建极坐标系</span></span><br><span class="line">    trans = PolarAxes.PolarTransform()</span><br><span class="line"><span class="comment">#相关系数轴</span></span><br><span class="line">    r1_locs = np.hstack((np.arange(<span class="number">1</span>,<span class="number">10</span>)/<span class="number">10.0</span>,[<span class="number">0.95</span>,<span class="number">0.99</span>]))</span><br><span class="line">    t1_locs = np.arccos(r1_locs)        </span><br><span class="line">    gl1 = grid_finder.FixedLocator(t1_locs)    </span><br><span class="line">    tf1 = grid_finder.DictFormatter(<span class="built_in">dict</span>(<span class="built_in">zip</span>(t1_locs, <span class="built_in">map</span>(<span class="built_in">str</span>,r1_locs))))</span><br><span class="line"><span class="comment">#标准差轴</span></span><br><span class="line">    r2_locs = np.arange(<span class="number">0</span>,<span class="number">2</span>,<span class="number">0.25</span>)</span><br><span class="line">    r2_labels = [<span class="string">&#x27;0 &#x27;</span>, <span class="string">&#x27;0.25 &#x27;</span>, <span class="string">&#x27;0.50 &#x27;</span>, <span class="string">&#x27;0.75 &#x27;</span>, <span class="string">&#x27;REF &#x27;</span>, <span class="string">&#x27;1.25 &#x27;</span>, <span class="string">&#x27;1.50 &#x27;</span>, <span class="string">&#x27;1.75 &#x27;</span>]</span><br><span class="line">    gl2 = grid_finder.FixedLocator(r2_locs)</span><br><span class="line">    tf2 = grid_finder.DictFormatter(<span class="built_in">dict</span>(<span class="built_in">zip</span>(r2_locs, <span class="built_in">map</span>(<span class="built_in">str</span>,r2_labels))))</span><br><span class="line">    ghelper = floating_axes.GridHelperCurveLinear(trans,extremes=(<span class="number">0</span>,np.pi/<span class="number">2</span>,<span class="number">0</span>,<span class="number">1.75</span>),</span><br><span class="line">                                                  grid_locator1=gl1,tick_formatter1=tf1,</span><br><span class="line">                                                  grid_locator2=gl2,tick_formatter2=tf2)</span><br><span class="line">    ax = floating_axes.FloatingSubplot(fig, location, grid_helper=ghelper)</span><br><span class="line">    fig.add_subplot(ax)</span><br><span class="line"><span class="comment">#设置各个轴的格式</span></span><br><span class="line">    ax.axis[<span class="string">&quot;top&quot;</span>].set_axis_direction(<span class="string">&quot;bottom&quot;</span>)  </span><br><span class="line">    ax.axis[<span class="string">&quot;top&quot;</span>].toggle(ticklabels=<span class="literal">True</span>, label=<span class="literal">True</span>)</span><br><span class="line">    ax.axis[<span class="string">&quot;top&quot;</span>].major_ticklabels.set_axis_direction(<span class="string">&quot;top&quot;</span>)</span><br><span class="line">    ax.axis[<span class="string">&quot;top&quot;</span>].label.set_axis_direction(<span class="string">&quot;top&quot;</span>)</span><br><span class="line">    ax.axis[<span class="string">&quot;top&quot;</span>].label.set_text(<span class="string">&quot;Correlation&quot;</span>)</span><br><span class="line">    ax.axis[<span class="string">&quot;top&quot;</span>].label.set_fontsize(<span class="number">14</span>)</span><br><span class="line">    ax.axis[<span class="string">&quot;left&quot;</span>].set_axis_direction(<span class="string">&quot;bottom&quot;</span>) </span><br><span class="line">    ax.axis[<span class="string">&quot;left&quot;</span>].label.set_text(<span class="string">&quot;Standard deviation&quot;</span>)</span><br><span class="line">    ax.axis[<span class="string">&quot;left&quot;</span>].label.set_fontsize(<span class="number">14</span>)</span><br><span class="line">    ax.axis[<span class="string">&quot;right&quot;</span>].set_axis_direction(<span class="string">&quot;top&quot;</span>)   </span><br><span class="line">    ax.axis[<span class="string">&quot;right&quot;</span>].toggle(ticklabels=<span class="literal">True</span>)</span><br><span class="line">    ax.axis[<span class="string">&quot;right&quot;</span>].major_ticklabels.set_axis_direction(<span class="string">&quot;left&quot;</span>)</span><br><span class="line">    ax.axis[<span class="string">&quot;bottom&quot;</span>].set_visible(<span class="literal">False</span>)         </span><br><span class="line">    ax.grid(<span class="literal">True</span>)</span><br><span class="line">    polar_ax = ax.get_aux_axes(trans)   </span><br><span class="line"></span><br><span class="line">    rs,ts = np.meshgrid(np.linspace(<span class="number">0</span>,<span class="number">1.75</span>,<span class="number">100</span>),</span><br><span class="line">                            np.linspace(<span class="number">0</span>,np.pi/<span class="number">2</span>,<span class="number">100</span>))</span><br><span class="line">    rms = np.sqrt(<span class="number">1</span> + rs**<span class="number">2</span> - <span class="number">2</span>*rs*np.cos(ts))</span><br><span class="line">    CS = polar_ax.contour(ts, rs,rms,colors=<span class="string">&#x27;gray&#x27;</span>,linestyles=<span class="string">&#x27;--&#x27;</span>)</span><br><span class="line">    plt.clabel(CS, inline=<span class="number">1</span>, fontsize=<span class="number">10</span>)</span><br><span class="line">    t = np.linspace(<span class="number">0</span>,np.pi/<span class="number">2</span>)</span><br><span class="line">    r = np.zeros_like(t) + <span class="number">1</span></span><br><span class="line">    polar_ax.plot(t,r,<span class="string">&#x27;k--&#x27;</span>)</span><br><span class="line"><span class="comment">#将垂直轴的REF改为1.00</span></span><br><span class="line">    polar_ax.text(np.pi/<span class="number">2</span>+<span class="number">0.032</span>,<span class="number">1.02</span>, <span class="string">&quot; 1.00&quot;</span>, size=<span class="number">10.3</span>,ha=<span class="string">&quot;right&quot;</span>, va=<span class="string">&quot;top&quot;</span>,</span><br><span class="line">                  bbox=<span class="built_in">dict</span>(boxstyle=<span class="string">&quot;square&quot;</span>,ec=<span class="string">&#x27;w&#x27;</span>,fc=<span class="string">&#x27;w&#x27;</span>))</span><br><span class="line">    <span class="keyword">return</span> polar_ax</span><br><span class="line"><span class="comment">#在泰勒图上绘制数据点</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">plot_taylor</span>(<span class="params">axes, refsample, sample, *args, **kwargs</span>):</span><br><span class="line">    std = np.std(refsample)/np.std(sample)</span><br><span class="line">    corr = np.corrcoef(refsample, sample) </span><br><span class="line">    theta = np.arccos(corr[<span class="number">0</span>,<span class="number">1</span>])</span><br><span class="line">    t,r = theta,std</span><br><span class="line">    d = axes.plot(t,r, *args, **kwargs) </span><br><span class="line">    <span class="keyword">return</span> d</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">x = np.linspace(<span class="number">0</span>,<span class="number">100</span>*np.pi,<span class="number">100</span>)</span><br><span class="line"><span class="comment">#生成观测数据</span></span><br><span class="line">data = np.sin(x)    </span><br><span class="line"><span class="comment">#生成3组与原始数据形状相同的对比数据                 </span></span><br><span class="line">m1 = data + <span class="number">0.4</span>*np.random.randn(<span class="built_in">len</span>(x))   </span><br><span class="line">m2 = <span class="number">0.3</span>*data + <span class="number">0.6</span>*np.random.randn(<span class="built_in">len</span>(x)) </span><br><span class="line">m3 = np.sin(x-np.pi/<span class="number">10</span>)           </span><br><span class="line"><span class="comment">#绘图     </span></span><br><span class="line">fig = plt.figure(figsize=(<span class="number">10</span>,<span class="number">4</span>))</span><br><span class="line">ax1 = set_tayloraxes(fig, <span class="number">121</span>)</span><br><span class="line">d1 = plot_taylor(ax1,data,m1, <span class="string">&#x27;bo&#x27;</span>)</span><br><span class="line">d2 = plot_taylor(ax1,data,m2, <span class="string">&#x27;ro&#x27;</span>)</span><br><span class="line">d3 = plot_taylor(ax1,data,m3, <span class="string">&#x27;go&#x27;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


<img src="https://cdn.kesci.com/upload/rt/0150910F15BC4AC587675C5760D4024C/rpavmw9ohh.png">

<script src="https://utteranc.es/client.js"
        repo="Nuist666/blog_comment"
        issue-term="python气象信息系统工程 第九章"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>
      
    </div>
    
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2000/01/01/%E7%AC%AC%E5%8D%81%E4%B8%80%E7%AB%A0/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">&lt;</strong>
      <div class="article-nav-title">
        
          python气象信息系统工程 第十一章
        
      </div>
    </a>
  
  
    <a href="/2000/01/01/%E7%AC%AC%E5%85%AB%E7%AB%A0/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">python气象信息系统工程 第八章</div>
      <strong class="article-nav-caption">&gt;</strong>
    </a>
  
</nav>

  
</article>






</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
      <div class="footer-left">
        &copy; 2024 Nuist666
      </div>
        <div class="footer-right">
          <a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/preccrep/hexo-theme-jelly" target="_blank">Jelly</a>
        </div>
    </div>
  </div>
</footer>
    </div>
    
  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">



<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: false,
		animate: true,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>

<script src="/js/main.js"></script>




  </div>
</body>
</html>