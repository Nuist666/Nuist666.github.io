<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>python气象信息系统工程 第五章 | Nuist666的个人博客</title>

  <!-- keywords -->
  

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="第5章 栅格数据处理5.1  xarray与气象栅格数据处理5.1.3  数据数组123456# 快速创建数据数组import xarray as xrimport numpy as npdata &#x3D; np.random.rand(4, 3)foo &#x3D; xr.DataArray(data)print(foo)  Warning: ecCodes 2.21.0 or higher is recomm">
<meta property="og:type" content="article">
<meta property="og:title" content="python气象信息系统工程 第五章">
<meta property="og:url" content="https://nuist666.github.io/2000/01/01/%E7%AC%AC%E4%BA%94%E7%AB%A0/index.html">
<meta property="og:site_name" content="Nuist666的个人博客">
<meta property="og:description" content="第5章 栅格数据处理5.1  xarray与气象栅格数据处理5.1.3  数据数组123456# 快速创建数据数组import xarray as xrimport numpy as npdata &#x3D; np.random.rand(4, 3)foo &#x3D; xr.DataArray(data)print(foo)  Warning: ecCodes 2.21.0 or higher is recomm">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="1999-12-31T16:05:00.000Z">
<meta property="article:modified_time" content="1999-12-31T16:05:00.000Z">
<meta property="article:author" content="Nuist666">
<meta property="article:tag" content="python,气象信息系统工程">
<meta name="twitter:card" content="summary">
  
    <link rel="alternative" href="/atom.xml" title="Nuist666的个人博客" type="application/atom+xml">
  
  
    <link rel="icon" href="/img/favicon.ico">
  
  
<link rel="stylesheet" href="/css/style.css">

  
  

  
<script src="//cdn.bootcss.com/require.js/2.3.2/require.min.js"></script>

  
<script src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script>


  
<meta name="generator" content="Hexo 7.1.1"></head>
<body>
  <div id="container">
    <div id="particles-js"></div>
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
				<img lazy-src="/img/avatar.png" class="js-avatar">
			
		</a>

		<hgroup>
			<h1 class="header-author"><a href="/">Nuist666</a></h1>
		</hgroup>

		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">Home</a></li>
				        
							<li><a href="/archives">Archives</a></li>
				        
						</ul>
					</nav>
					<nav class="half-header-menu">
						<a class="hide">Home</a>
						<a>Tags</a>
						<a>Links</a>
						<a>About</a>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/Nuist666" title="github">github</a>
					        
								<a class="mail" target="_blank" href="mailto:yzwangkaicheng@gmail.com" title="mail">mail</a>
					        
								<a class="weibo" target="_blank" href="https://weibo.com/u/5586096129" title="weibo">weibo</a>
					        
								<a class="twitter" target="_blank" href="https://twitter.com/nuist_666" title="twitter">twitter</a>
					        
						</div>
						<!-- music -->
						
							<!-- <div style="position: absolute; bottom: 120px; left: auto; width: 85%;"> -->
							<div style="position: absolute; left: auto; width: 85%;">
								<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=220 height=86 src="//music.163.com/outchain/player?type=2&id=28411862&auto=1&height=66"></iframe>
							</div>
						
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/Overflow-Mirai-LLOneBot-OneBot/" style="font-size: 10px;">Overflow,Mirai,LLOneBot,OneBot</a> <a href="/tags/python-%E6%B0%94%E8%B1%A1%E4%BF%A1%E6%81%AF%E7%B3%BB%E7%BB%9F%E5%B7%A5%E7%A8%8B/" style="font-size: 20px;">python,气象信息系统工程</a> <a href="/tags/%E6%A8%A1%E6%9D%BF-%E5%B0%8F%E4%B9%A6%E5%8C%A0-%E4%B8%89%E5%B3%B0%E7%9C%9F%E7%99%BD-%E6%96%B0%E5%BB%BA/" style="font-size: 10px;">模板,小书匠,三峰真白,新建</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="https://qm.qq.com/q/HrJvHGMzek">qq</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="https://space.bilibili.com/3546647772531174">bilibili</a>
			        
			        </div>
				</section>
				

				
				
				<section class="switch-part switch-part4">
				
					<div id="js-aboutme">I&#39;m a student in NUIST.</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide"></h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="/img/avatar.png" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author"></h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">Home</a></li>
		        
					<li><a href="/archives">Archives</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/Nuist666" title="github">github</a>
			        
						<a class="mail" target="_blank" href="mailto:yzwangkaicheng@gmail.com" title="mail">mail</a>
			        
						<a class="weibo" target="_blank" href="https://weibo.com/u/5586096129" title="weibo">weibo</a>
			        
						<a class="twitter" target="_blank" href="https://twitter.com/nuist_666" title="twitter">twitter</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap"><article id="post-第五章" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2000/01/01/%E7%AC%AC%E4%BA%94%E7%AB%A0/" class="article-date">
  	<time datetime="1999-12-31T16:05:00.000Z" itemprop="datePublished">2000-01-01</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      python气象信息系统工程 第五章
      
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
	<div class="article-tag tagcloud">
		<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python-%E6%B0%94%E8%B1%A1%E4%BF%A1%E6%81%AF%E7%B3%BB%E7%BB%9F%E5%B7%A5%E7%A8%8B/" rel="tag">python,气象信息系统工程</a></li></ul>
	</div>

        
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/%E5%B0%8F%E4%B9%A6%E5%8C%A0-python/">/小书匠/python</a>
	</div>


        
        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="第5章-栅格数据处理"><a href="#第5章-栅格数据处理" class="headerlink" title="第5章 栅格数据处理"></a>第5章 栅格数据处理</h1><h2 id="5-1-xarray与气象栅格数据处理"><a href="#5-1-xarray与气象栅格数据处理" class="headerlink" title="5.1  xarray与气象栅格数据处理"></a>5.1  xarray与气象栅格数据处理</h2><h3 id="5-1-3-数据数组"><a href="#5-1-3-数据数组" class="headerlink" title="5.1.3  数据数组"></a>5.1.3  数据数组</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 快速创建数据数组</span></span><br><span class="line"><span class="keyword">import</span> xarray <span class="keyword">as</span> xr</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">data = np.random.rand(<span class="number">4</span>, <span class="number">3</span>)</span><br><span class="line">foo = xr.DataArray(data)</span><br><span class="line"><span class="built_in">print</span>(foo)</span><br></pre></td></tr></table></figure>

<pre><code>Warning: ecCodes 2.21.0 or higher is recommended. You are running version 2.14.1
&lt;xarray.DataArray (dim_0: 4, dim_1: 3)&gt;
array([[0.67963145, 0.92665821, 0.20340572],
       [0.24031655, 0.25653271, 0.15787638],
       [0.16017296, 0.76027366, 0.01558841],
       [0.51060631, 0.92658865, 0.37249527]])
Dimensions without coordinates: dim_0, dim_1
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建完整数据数组</span></span><br><span class="line"><span class="keyword">import</span> xarray <span class="keyword">as</span> xr</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">data = np.random.rand(<span class="number">4</span>, <span class="number">3</span>)</span><br><span class="line">locs = [<span class="string">&quot;level&quot;</span>, <span class="string">&quot;latitude&quot;</span>, <span class="string">&quot;longitude&quot;</span>]</span><br><span class="line">times = pd.date_range(<span class="string">&quot;2000-01-01&quot;</span>, periods=<span class="number">4</span>)</span><br><span class="line">foo = xr.DataArray(data, coords=[times, locs], dims=[<span class="string">&quot;time&quot;</span>, <span class="string">&quot;space&quot;</span>])</span><br><span class="line"><span class="built_in">print</span>(foo)</span><br></pre></td></tr></table></figure>

<pre><code>&lt;xarray.DataArray (time: 4, space: 3)&gt;
array([[0.80338641, 0.65603237, 0.52567211],
       [0.50568769, 0.59993651, 0.64384544],
       [0.26838498, 0.58854113, 0.3118957 ],
       [0.75973916, 0.37242213, 0.30407391]])
Coordinates:
  * time     (time) datetime64[ns] 2000-01-01 2000-01-02 2000-01-03 2000-01-04
  * space    (space) &lt;U9 &#39;level&#39; &#39;latitude&#39; &#39;longitude&#39;
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># pd.Series、pd.DataFrame以及pd.Panel来创建DataArray</span></span><br><span class="line">df = pd.DataFrame(&#123;<span class="string">&quot;lat&quot;</span>: [<span class="number">0</span>, <span class="number">1</span>], <span class="string">&quot;lon&quot;</span>: [<span class="number">2</span>, <span class="number">3</span>]&#125;, index=[<span class="string">&quot;2000-01-01&quot;</span>, <span class="string">&quot;2000-01-02&quot;</span>])</span><br><span class="line">df.index.name = <span class="string">&quot;time&quot;</span></span><br><span class="line">df.columns.name = <span class="string">&quot;space&quot;</span></span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line">foo = xr.DataArray(df)</span><br><span class="line"><span class="built_in">print</span>(foo)</span><br></pre></td></tr></table></figure>

<pre><code>space       lat  lon
time                
2000-01-01    0    2
2000-01-02    1    3
&lt;xarray.DataArray (time: 2, space: 2)&gt;
array([[0, 2],
       [1, 3]])
Coordinates:
  * time     (time) object &#39;2000-01-01&#39; &#39;2000-01-02&#39;
  * space    (space) object &#39;lat&#39; &#39;lon&#39;
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 以元组组成的列表形式设置coords</span></span><br><span class="line">foo = xr.DataArray(data, coords=[(<span class="string">&quot;time&quot;</span>, times), (<span class="string">&quot;space&quot;</span>, locs)])</span><br><span class="line"><span class="built_in">print</span>(foo)</span><br></pre></td></tr></table></figure>

<pre><code>&lt;xarray.DataArray (time: 4, space: 3)&gt;
array([[0.80338641, 0.65603237, 0.52567211],
       [0.50568769, 0.59993651, 0.64384544],
       [0.26838498, 0.58854113, 0.3118957 ],
       [0.75973916, 0.37242213, 0.30407391]])
Coordinates:
  * time     (time) datetime64[ns] 2000-01-01 2000-01-02 2000-01-03 2000-01-04
  * space    (space) &lt;U9 &#39;level&#39; &#39;latitude&#39; &#39;longitude&#39;
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 以字典形式设置coords</span></span><br><span class="line">foo = xr.DataArray(data,coords=&#123;<span class="string">&quot;time&quot;</span>: times,<span class="string">&quot;space&quot;</span>: locs&#125;,dims=[<span class="string">&quot;time&quot;</span>, <span class="string">&quot;space&quot;</span>])</span><br><span class="line"><span class="built_in">print</span>(foo)</span><br></pre></td></tr></table></figure>

<pre><code>&lt;xarray.DataArray (time: 4, space: 3)&gt;
array([[0.80338641, 0.65603237, 0.52567211],
       [0.50568769, 0.59993651, 0.64384544],
       [0.26838498, 0.58854113, 0.3118957 ],
       [0.75973916, 0.37242213, 0.30407391]])
Coordinates:
  * time     (time) datetime64[ns] 2000-01-01 2000-01-02 2000-01-03 2000-01-04
  * space    (space) &lt;U9 &#39;level&#39; &#39;latitude&#39; &#39;longitude&#39;
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 通过名称或索引数据数组来访问coords</span></span><br><span class="line"><span class="built_in">print</span>(foo.coords[<span class="string">&quot;time&quot;</span>])</span><br><span class="line"><span class="built_in">print</span>(foo[<span class="string">&quot;time&quot;</span>])</span><br></pre></td></tr></table></figure>

<pre><code>&lt;xarray.DataArray &#39;time&#39; (time: 4)&gt;
array([&#39;2000-01-01T00:00:00.000000000&#39;, &#39;2000-01-02T00:00:00.000000000&#39;,
       &#39;2000-01-03T00:00:00.000000000&#39;, &#39;2000-01-04T00:00:00.000000000&#39;],
      dtype=&#39;datetime64[ns]&#39;)
Coordinates:
  * time     (time) datetime64[ns] 2000-01-01 2000-01-02 2000-01-03 2000-01-04
&lt;xarray.DataArray &#39;time&#39; (time: 4)&gt;
array([&#39;2000-01-01T00:00:00.000000000&#39;, &#39;2000-01-02T00:00:00.000000000&#39;,
       &#39;2000-01-03T00:00:00.000000000&#39;, &#39;2000-01-04T00:00:00.000000000&#39;],
      dtype=&#39;datetime64[ns]&#39;)
Coordinates:
  * time     (time) datetime64[ns] 2000-01-01 2000-01-02 2000-01-03 2000-01-04
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用类似字典的语法设置或删除坐标，如重新设置coords</span></span><br><span class="line">foo[<span class="string">&quot;time&quot;</span>] = pd.date_range(<span class="string">&quot;1999-01-01&quot;</span>, periods=<span class="number">4</span>)</span><br><span class="line"><span class="built_in">print</span>(foo)</span><br><span class="line"><span class="keyword">del</span> foo[<span class="string">&quot;time&quot;</span>]</span><br><span class="line"><span class="built_in">print</span>(foo)</span><br></pre></td></tr></table></figure>

<pre><code>&lt;xarray.DataArray (time: 4, space: 3)&gt;
array([[0.80338641, 0.65603237, 0.52567211],
       [0.50568769, 0.59993651, 0.64384544],
       [0.26838498, 0.58854113, 0.3118957 ],
       [0.75973916, 0.37242213, 0.30407391]])
Coordinates:
  * time     (time) datetime64[ns] 1999-01-01 1999-01-02 1999-01-03 1999-01-04
  * space    (space) &lt;U9 &#39;level&#39; &#39;latitude&#39; &#39;longitude&#39;
&lt;xarray.DataArray (time: 4, space: 3)&gt;
array([[0.80338641, 0.65603237, 0.52567211],
       [0.50568769, 0.59993651, 0.64384544],
       [0.26838498, 0.58854113, 0.3118957 ],
       [0.75973916, 0.37242213, 0.30407391]])
Coordinates:
  * space    (space) &lt;U9 &#39;level&#39; &#39;latitude&#39; &#39;longitude&#39;
Dimensions without coordinates: time
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看DataArray的属性</span></span><br><span class="line">data = np.random.rand(<span class="number">4</span>, <span class="number">3</span>)</span><br><span class="line">foo = xr.DataArray(data,coords=&#123;<span class="string">&quot;time&quot;</span>: times,<span class="string">&quot;space&quot;</span>: locs&#125;,dims=[<span class="string">&quot;time&quot;</span>, <span class="string">&quot;space&quot;</span>])</span><br><span class="line"><span class="built_in">print</span>(foo.values)</span><br></pre></td></tr></table></figure>

<pre><code>[[0.02511101 0.39750902 0.60358049]
 [0.95935949 0.49043908 0.17389166]
 [0.58800593 0.65861825 0.61909722]
 [0.80189432 0.57056813 0.97623271]]
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 修改DataArray的values属性</span></span><br><span class="line">data = np.random.rand(<span class="number">4</span>, <span class="number">3</span>)</span><br><span class="line">foo = xr.DataArray(data,coords=&#123;<span class="string">&quot;time&quot;</span>: times,<span class="string">&quot;space&quot;</span>: locs&#125;,dims=[<span class="string">&quot;time&quot;</span>, <span class="string">&quot;space&quot;</span>])</span><br><span class="line"><span class="built_in">print</span>(foo.values)</span><br><span class="line">foo.values = <span class="number">2</span> * foo.values</span><br><span class="line"><span class="built_in">print</span>(foo.values)</span><br></pre></td></tr></table></figure>

<pre><code>[[0.94464301 0.18733999 0.10886215]
 [0.43506913 0.76269183 0.57350526]
 [0.91382268 0.04468623 0.76367773]
 [0.44477094 0.56019484 0.07125937]]
[[1.88928601 0.37467998 0.21772431]
 [0.87013826 1.52538366 1.14701051]
 [1.82764537 0.08937247 1.52735547]
 [0.88954188 1.12038969 0.14251874]]
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 为DataArray补充缺失的属性</span></span><br><span class="line">data = np.random.rand(<span class="number">4</span>, <span class="number">3</span>)</span><br><span class="line">foo = xr.DataArray(data,coords=&#123;<span class="string">&quot;time&quot;</span>: times,<span class="string">&quot;space&quot;</span>: locs&#125;,dims=[<span class="string">&quot;time&quot;</span>, <span class="string">&quot;space&quot;</span>])</span><br><span class="line">foo.name = <span class="string">&quot;foo&quot;</span></span><br><span class="line">foo.attrs[<span class="string">&quot;units&quot;</span>] = <span class="string">&quot;meters&quot;</span></span><br><span class="line"><span class="built_in">print</span>(foo)</span><br></pre></td></tr></table></figure>

<pre><code>&lt;xarray.DataArray &#39;foo&#39; (time: 4, space: 3)&gt;
array([[0.86866017, 0.43983313, 0.11170208],
       [0.13890405, 0.35426694, 0.34257437],
       [0.89854998, 0.2483747 , 0.07325485],
       [0.38812121, 0.73746852, 0.75192879]])
Coordinates:
  * time     (time) datetime64[ns] 2000-01-01 2000-01-02 2000-01-03 2000-01-04
  * space    (space) &lt;U9 &#39;level&#39; &#39;latitude&#39; &#39;longitude&#39;
Attributes:
    units:    meters
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用rename()方法来修改DataArray的名字</span></span><br><span class="line">foo_new = foo.rename(<span class="string">&quot;foo_new&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(foo_new)</span><br></pre></td></tr></table></figure>

<pre><code>&lt;xarray.DataArray &#39;foo_new&#39; (time: 4, space: 3)&gt;
array([[0.86866017, 0.43983313, 0.11170208],
       [0.13890405, 0.35426694, 0.34257437],
       [0.89854998, 0.2483747 , 0.07325485],
       [0.38812121, 0.73746852, 0.75192879]])
Coordinates:
  * time     (time) datetime64[ns] 2000-01-01 2000-01-02 2000-01-03 2000-01-04
  * space    (space) &lt;U9 &#39;level&#39; &#39;latitude&#39; &#39;longitude&#39;
Attributes:
    units:    meters
</code></pre>
<h3 id="5-1-4-数据集"><a href="#5-1-4-数据集" class="headerlink" title="5.1.4  数据集"></a>5.1.4  数据集</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用随机生成的数组来创建数据集</span></span><br><span class="line">temp = <span class="number">15</span> + <span class="number">8</span> * np.random.randn(<span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line">precip = <span class="number">10</span> * np.random.rand(<span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line">lon = [[-<span class="number">99.83</span>, -<span class="number">99.32</span>], [-<span class="number">99.79</span>, -<span class="number">99.23</span>]]</span><br><span class="line">lat = [[<span class="number">42.25</span>, <span class="number">42.21</span>], [<span class="number">42.63</span>, <span class="number">42.59</span>]]</span><br><span class="line">ds = xr.Dataset(&#123;<span class="string">&quot;temperature&quot;</span>: ([<span class="string">&quot;x&quot;</span>, <span class="string">&quot;y&quot;</span>, <span class="string">&quot;time&quot;</span>], temp),</span><br><span class="line">              <span class="string">&quot;precipitation&quot;</span>: ([<span class="string">&quot;x&quot;</span>, <span class="string">&quot;y&quot;</span>, <span class="string">&quot;time&quot;</span>], precip),&#125;,</span><br><span class="line">             coords=&#123;<span class="string">&quot;lon&quot;</span>: ([<span class="string">&quot;x&quot;</span>, <span class="string">&quot;y&quot;</span>], lon),</span><br><span class="line">                    <span class="string">&quot;lat&quot;</span>: ([<span class="string">&quot;x&quot;</span>, <span class="string">&quot;y&quot;</span>], lat),</span><br><span class="line">                    <span class="string">&quot;time&quot;</span>: pd.date_range(<span class="string">&quot;2014-09-06&quot;</span>, periods=<span class="number">3</span>),</span><br><span class="line">                    <span class="string">&quot;reference_time&quot;</span>: pd.Timestamp(<span class="string">&quot;2014-09-05&quot;</span>)&#125; )</span><br><span class="line"><span class="built_in">print</span>(ds)</span><br></pre></td></tr></table></figure>

<pre><code>&lt;xarray.Dataset&gt;
Dimensions:         (x: 2, y: 2, time: 3)
Coordinates:
    lon             (x, y) float64 -99.83 -99.32 -99.79 -99.23
    lat             (x, y) float64 42.25 42.21 42.63 42.59
  * time            (time) datetime64[ns] 2014-09-06 2014-09-07 2014-09-08
    reference_time  datetime64[ns] 2014-09-05
Dimensions without coordinates: x, y
Data variables:
    temperature     (x, y, time) float64 13.74 20.58 19.62 ... 9.004 24.93 17.66
    precipitation   (x, y, time) float64 5.553 1.356 8.003 ... 3.666 6.822 8.288
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 通过传递数据数组来创建数据集</span></span><br><span class="line">data = np.random.rand(<span class="number">4</span>, <span class="number">3</span>)</span><br><span class="line">locs = [<span class="string">&quot;IA&quot;</span>, <span class="string">&quot;IL&quot;</span>, <span class="string">&quot;IN&quot;</span>]</span><br><span class="line">times = pd.date_range(<span class="string">&quot;2000-01-01&quot;</span>, periods=<span class="number">4</span>)</span><br><span class="line">foo = xr.DataArray(data, coords=[times, locs], dims=[<span class="string">&quot;time&quot;</span>, <span class="string">&quot;space&quot;</span>])</span><br><span class="line">ds = xr.Dataset(&#123;<span class="string">&quot;bar&quot;</span>: foo&#125;)</span><br><span class="line"><span class="built_in">print</span>(ds)</span><br></pre></td></tr></table></figure>

<pre><code>&lt;xarray.Dataset&gt;
Dimensions:  (time: 4, space: 3)
Coordinates:
  * time     (time) datetime64[ns] 2000-01-01 2000-01-02 2000-01-03 2000-01-04
  * space    (space) &lt;U2 &#39;IA&#39; &#39;IL&#39; &#39;IN&#39;
Data variables:
    bar      (time, space) float64 0.585 0.456 0.2301 ... 0.5278 0.7906 0.7462
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 通过pandas对象来创建数据集</span></span><br><span class="line">data = np.random.rand(<span class="number">4</span>, <span class="number">3</span>)</span><br><span class="line">locs = [<span class="string">&quot;IA&quot;</span>, <span class="string">&quot;IL&quot;</span>, <span class="string">&quot;IN&quot;</span>]</span><br><span class="line">times = pd.date_range(<span class="string">&quot;2000-01-01&quot;</span>, periods=<span class="number">4</span>)</span><br><span class="line">foo = xr.DataArray(data, coords=[times, locs], dims=[<span class="string">&quot;time&quot;</span>, <span class="string">&quot;space&quot;</span>])</span><br><span class="line">ds = xr.Dataset(&#123;<span class="string">&quot;bar&quot;</span>: foo.to_pandas()&#125;)</span><br><span class="line"><span class="built_in">print</span>(ds)</span><br></pre></td></tr></table></figure>

<pre><code>&lt;xarray.Dataset&gt;
Dimensions:  (time: 4, space: 3)
Coordinates:
  * time     (time) datetime64[ns] 2000-01-01 2000-01-02 2000-01-03 2000-01-04
  * space    (space) object &#39;IA&#39; &#39;IL&#39; &#39;IN&#39;
Data variables:
    bar      (time, space) float64 0.05036 0.9936 0.451 ... 0.2731 0.4817 0.2769
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 访问数据集中的变量</span></span><br><span class="line">temp = <span class="number">15</span> + <span class="number">8</span> * np.random.randn(<span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line">precip = <span class="number">10</span> * np.random.rand(<span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line">lon = [[-<span class="number">99.83</span>, -<span class="number">99.32</span>], [-<span class="number">99.79</span>, -<span class="number">99.23</span>]]</span><br><span class="line">lat = [[<span class="number">42.25</span>, <span class="number">42.21</span>], [<span class="number">42.63</span>, <span class="number">42.59</span>]]</span><br><span class="line">ds = xr.Dataset(&#123;<span class="string">&quot;temperature&quot;</span>: ([<span class="string">&quot;x&quot;</span>, <span class="string">&quot;y&quot;</span>, <span class="string">&quot;time&quot;</span>], temp),</span><br><span class="line">              <span class="string">&quot;precipitation&quot;</span>: ([<span class="string">&quot;x&quot;</span>, <span class="string">&quot;y&quot;</span>, <span class="string">&quot;time&quot;</span>], precip),&#125;,</span><br><span class="line">             coords=&#123;<span class="string">&quot;lon&quot;</span>: ([<span class="string">&quot;x&quot;</span>, <span class="string">&quot;y&quot;</span>], lon),</span><br><span class="line">                    <span class="string">&quot;lat&quot;</span>: ([<span class="string">&quot;x&quot;</span>, <span class="string">&quot;y&quot;</span>], lat),</span><br><span class="line">                    <span class="string">&quot;time&quot;</span>: pd.date_range(<span class="string">&quot;2014-09-06&quot;</span>, periods=<span class="number">3</span>),</span><br><span class="line">                    <span class="string">&quot;reference_time&quot;</span>: pd.Timestamp(<span class="string">&quot;2014-09-05&quot;</span>)&#125; )</span><br><span class="line"><span class="built_in">print</span>(ds[<span class="string">&quot;temperature&quot;</span>])</span><br></pre></td></tr></table></figure>

<pre><code>&lt;xarray.DataArray &#39;temperature&#39; (x: 2, y: 2, time: 3)&gt;
array([[[15.03349336, 15.44033513,  6.51238387],
        [19.54120058, -3.60023195, 21.78888719]],

       [[14.36421838, 25.00615749, -7.38567232],
        [16.29567998, 22.08970341,  3.72752459]]])
Coordinates:
    lon             (x, y) float64 -99.83 -99.32 -99.79 -99.23
    lat             (x, y) float64 42.25 42.21 42.63 42.59
  * time            (time) datetime64[ns] 2014-09-06 2014-09-07 2014-09-08
    reference_time  datetime64[ns] 2014-09-05
Dimensions without coordinates: x, y
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用类似字典的语法完整创建一个数据集</span></span><br><span class="line">ds = xr.Dataset()</span><br><span class="line">ds[<span class="string">&quot;temperature&quot;</span>] = ((<span class="string">&quot;x&quot;</span>, <span class="string">&quot;y&quot;</span>, <span class="string">&quot;time&quot;</span>), temp)</span><br><span class="line">ds[<span class="string">&quot;temperature_double&quot;</span>] = ((<span class="string">&quot;x&quot;</span>, <span class="string">&quot;y&quot;</span>, <span class="string">&quot;time&quot;</span>), temp * <span class="number">2</span>)</span><br><span class="line">ds[<span class="string">&quot;precipitation&quot;</span>] = ((<span class="string">&quot;x&quot;</span>, <span class="string">&quot;y&quot;</span>, <span class="string">&quot;time&quot;</span>), precip)</span><br><span class="line">ds.coords[<span class="string">&quot;lat&quot;</span>] = ((<span class="string">&quot;x&quot;</span>, <span class="string">&quot;y&quot;</span>), lat)</span><br><span class="line">ds.coords[<span class="string">&quot;lon&quot;</span>] = ((<span class="string">&quot;x&quot;</span>, <span class="string">&quot;y&quot;</span>), lon)</span><br><span class="line">ds.coords[<span class="string">&quot;time&quot;</span>] = pd.date_range(<span class="string">&quot;2014-09-06&quot;</span>, periods=<span class="number">3</span>)</span><br><span class="line">ds.coords[<span class="string">&quot;reference_time&quot;</span>] = pd.Timestamp(<span class="string">&quot;2014-09-05&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(ds)</span><br></pre></td></tr></table></figure>

<pre><code>&lt;xarray.Dataset&gt;
Dimensions:             (x: 2, y: 2, time: 3)
Coordinates:
    lat                 (x, y) float64 42.25 42.21 42.63 42.59
    lon                 (x, y) float64 -99.83 -99.32 -99.79 -99.23
  * time                (time) datetime64[ns] 2014-09-06 2014-09-07 2014-09-08
    reference_time      datetime64[ns] 2014-09-05
Dimensions without coordinates: x, y
Data variables:
    temperature         (x, y, time) float64 15.03 15.44 6.512 ... 22.09 3.728
    temperature_double  (x, y, time) float64 30.07 30.88 13.02 ... 44.18 7.455
    precipitation       (x, y, time) float64 1.99 7.872 2.105 ... 5.925 0.6317
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 通过drop ()等方法删除变量</span></span><br><span class="line">ds = xr.Dataset()</span><br><span class="line">ds[<span class="string">&quot;temperature&quot;</span>] = ((<span class="string">&quot;x&quot;</span>, <span class="string">&quot;y&quot;</span>, <span class="string">&quot;time&quot;</span>), temp)</span><br><span class="line">ds[<span class="string">&quot;temperature_double&quot;</span>] = ((<span class="string">&quot;x&quot;</span>, <span class="string">&quot;y&quot;</span>, <span class="string">&quot;time&quot;</span>), temp * <span class="number">2</span>)</span><br><span class="line">ds[<span class="string">&quot;precipitation&quot;</span>] = ((<span class="string">&quot;x&quot;</span>, <span class="string">&quot;y&quot;</span>, <span class="string">&quot;time&quot;</span>), precip)</span><br><span class="line">ds.coords[<span class="string">&quot;lat&quot;</span>] = ((<span class="string">&quot;x&quot;</span>, <span class="string">&quot;y&quot;</span>), lat)</span><br><span class="line">ds.coords[<span class="string">&quot;lon&quot;</span>] = ((<span class="string">&quot;x&quot;</span>, <span class="string">&quot;y&quot;</span>), lon)</span><br><span class="line">ds.coords[<span class="string">&quot;time&quot;</span>] = pd.date_range(<span class="string">&quot;2014-09-06&quot;</span>, periods=<span class="number">3</span>)</span><br><span class="line">ds.coords[<span class="string">&quot;reference_time&quot;</span>] = pd.Timestamp(<span class="string">&quot;2014-09-05&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(ds)</span><br><span class="line">ds = ds.drop(<span class="string">&quot;temperature&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(ds)</span><br></pre></td></tr></table></figure>

<pre><code>&lt;xarray.Dataset&gt;
Dimensions:             (x: 2, y: 2, time: 3)
Coordinates:
    lat                 (x, y) float64 42.25 42.21 42.63 42.59
    lon                 (x, y) float64 -99.83 -99.32 -99.79 -99.23
  * time                (time) datetime64[ns] 2014-09-06 2014-09-07 2014-09-08
    reference_time      datetime64[ns] 2014-09-05
Dimensions without coordinates: x, y
Data variables:
    temperature         (x, y, time) float64 15.03 15.44 6.512 ... 22.09 3.728
    temperature_double  (x, y, time) float64 30.07 30.88 13.02 ... 44.18 7.455
    precipitation       (x, y, time) float64 1.99 7.872 2.105 ... 5.925 0.6317
&lt;xarray.Dataset&gt;
Dimensions:             (x: 2, y: 2, time: 3)
Coordinates:
    lat                 (x, y) float64 42.25 42.21 42.63 42.59
    lon                 (x, y) float64 -99.83 -99.32 -99.79 -99.23
  * time                (time) datetime64[ns] 2014-09-06 2014-09-07 2014-09-08
    reference_time      datetime64[ns] 2014-09-05
Dimensions without coordinates: x, y
Data variables:
    temperature_double  (x, y, time) float64 30.07 30.88 13.02 ... 44.18 7.455
    precipitation       (x, y, time) float64 1.99 7.872 2.105 ... 5.925 0.6317
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#使用assign()来修改或替换数据集的值</span></span><br><span class="line">ds = xr.Dataset()</span><br><span class="line">ds[<span class="string">&quot;temperature&quot;</span>] = ((<span class="string">&quot;x&quot;</span>, <span class="string">&quot;y&quot;</span>, <span class="string">&quot;time&quot;</span>), temp)</span><br><span class="line">ds[<span class="string">&quot;temperature_double&quot;</span>] = ((<span class="string">&quot;x&quot;</span>, <span class="string">&quot;y&quot;</span>, <span class="string">&quot;time&quot;</span>), temp * <span class="number">2</span>)</span><br><span class="line">ds[<span class="string">&quot;precipitation&quot;</span>] = ((<span class="string">&quot;x&quot;</span>, <span class="string">&quot;y&quot;</span>, <span class="string">&quot;time&quot;</span>), precip)</span><br><span class="line">ds.coords[<span class="string">&quot;lat&quot;</span>] = ((<span class="string">&quot;x&quot;</span>, <span class="string">&quot;y&quot;</span>), lat)</span><br><span class="line">ds.coords[<span class="string">&quot;lon&quot;</span>] = ((<span class="string">&quot;x&quot;</span>, <span class="string">&quot;y&quot;</span>), lon)</span><br><span class="line">ds.coords[<span class="string">&quot;time&quot;</span>] = pd.date_range(<span class="string">&quot;2014-09-06&quot;</span>, periods=<span class="number">3</span>)</span><br><span class="line">ds.coords[<span class="string">&quot;reference_time&quot;</span>] = pd.Timestamp(<span class="string">&quot;2014-09-05&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(ds)</span><br><span class="line">ds.assign(temperature2=<span class="number">2</span> * ds.temperature)</span><br><span class="line"><span class="built_in">print</span>(ds)</span><br></pre></td></tr></table></figure>

<pre><code>&lt;xarray.Dataset&gt;
Dimensions:             (x: 2, y: 2, time: 3)
Coordinates:
    lat                 (x, y) float64 42.25 42.21 42.63 42.59
    lon                 (x, y) float64 -99.83 -99.32 -99.79 -99.23
  * time                (time) datetime64[ns] 2014-09-06 2014-09-07 2014-09-08
    reference_time      datetime64[ns] 2014-09-05
Dimensions without coordinates: x, y
Data variables:
    temperature         (x, y, time) float64 15.03 15.44 6.512 ... 22.09 3.728
    temperature_double  (x, y, time) float64 30.07 30.88 13.02 ... 44.18 7.455
    precipitation       (x, y, time) float64 1.99 7.872 2.105 ... 5.925 0.6317
&lt;xarray.Dataset&gt;
Dimensions:             (x: 2, y: 2, time: 3)
Coordinates:
    lat                 (x, y) float64 42.25 42.21 42.63 42.59
    lon                 (x, y) float64 -99.83 -99.32 -99.79 -99.23
  * time                (time) datetime64[ns] 2014-09-06 2014-09-07 2014-09-08
    reference_time      datetime64[ns] 2014-09-05
Dimensions without coordinates: x, y
Data variables:
    temperature         (x, y, time) float64 15.03 15.44 6.512 ... 22.09 3.728
    temperature_double  (x, y, time) float64 30.07 30.88 13.02 ... 44.18 7.455
    precipitation       (x, y, time) float64 1.99 7.872 2.105 ... 5.925 0.6317
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用assign_coords()对DataArray的坐标标签进行重新声明</span></span><br><span class="line">da = xr.DataArray(np.random.rand(<span class="number">4</span>),coords=[np.array([<span class="number">358</span>, <span class="number">359</span>, <span class="number">0</span>, <span class="number">1</span>])],dims=<span class="string">&quot;lon&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(da)</span><br><span class="line">da.assign_coords(lon=(((da.lon + <span class="number">180</span>) % <span class="number">360</span>) - <span class="number">180</span>))</span><br><span class="line"><span class="built_in">print</span>(da)</span><br></pre></td></tr></table></figure>

<pre><code>&lt;xarray.DataArray (lon: 4)&gt;
array([0.18946962, 0.0144292 , 0.47497827, 0.26471126])
Coordinates:
  * lon      (lon) int64 358 359 0 1
&lt;xarray.DataArray (lon: 4)&gt;
array([0.18946962, 0.0144292 , 0.47497827, 0.26471126])
Coordinates:
  * lon      (lon) int64 358 359 0 1
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 通过rename()对变量进行重命名</span></span><br><span class="line">ds.rename(&#123;<span class="string">&quot;temperature&quot;</span>: <span class="string">&quot;temp&quot;</span>, <span class="string">&quot;precipitation&quot;</span>: <span class="string">&quot;precip&quot;</span>&#125;)</span><br></pre></td></tr></table></figure>




<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

<p>:root {<br>  –xr-font-color0: var(–jp-content-font-color0, rgba(0, 0, 0, 1));<br>  –xr-font-color2: var(–jp-content-font-color2, rgba(0, 0, 0, 0.54));<br>  –xr-font-color3: var(–jp-content-font-color3, rgba(0, 0, 0, 0.38));<br>  –xr-border-color: var(–jp-border-color2, #e0e0e0);<br>  –xr-disabled-color: var(–jp-layout-color3, #bdbdbd);<br>  –xr-background-color: var(–jp-layout-color0, white);<br>  –xr-background-color-row-even: var(–jp-layout-color1, white);<br>  –xr-background-color-row-odd: var(–jp-layout-color2, #eeeeee);<br>}</p>
<p>html[theme&#x3D;dark],<br>body.vscode-dark {<br>  –xr-font-color0: rgba(255, 255, 255, 1);<br>  –xr-font-color2: rgba(255, 255, 255, 0.54);<br>  –xr-font-color3: rgba(255, 255, 255, 0.38);<br>  –xr-border-color: #1F1F1F;<br>  –xr-disabled-color: #515151;<br>  –xr-background-color: #111111;<br>  –xr-background-color-row-even: #111111;<br>  –xr-background-color-row-odd: #313131;<br>}</p>
<p>.xr-wrap {<br>  display: block;<br>  min-width: 300px;<br>  max-width: 700px;<br>}</p>
<p>.xr-text-repr-fallback {<br>  &#x2F;* fallback to plain text repr when CSS is not injected (untrusted notebook) *&#x2F;<br>  display: none;<br>}</p>
<p>.xr-header {<br>  padding-top: 6px;<br>  padding-bottom: 6px;<br>  margin-bottom: 4px;<br>  border-bottom: solid 1px var(–xr-border-color);<br>}</p>
<p>.xr-header &gt; div,<br>.xr-header &gt; ul {<br>  display: inline;<br>  margin-top: 0;<br>  margin-bottom: 0;<br>}</p>
<p>.xr-obj-type,<br>.xr-array-name {<br>  margin-left: 2px;<br>  margin-right: 10px;<br>}</p>
<p>.xr-obj-type {<br>  color: var(–xr-font-color2);<br>}</p>
<p>.xr-sections {<br>  padding-left: 0 !important;<br>  display: grid;<br>  grid-template-columns: 150px auto auto 1fr 20px 20px;<br>}</p>
<p>.xr-section-item {<br>  display: contents;<br>}</p>
<p>.xr-section-item input {<br>  display: none;<br>}</p>
<p>.xr-section-item input + label {<br>  color: var(–xr-disabled-color);<br>}</p>
<p>.xr-section-item input:enabled + label {<br>  cursor: pointer;<br>  color: var(–xr-font-color2);<br>}</p>
<p>.xr-section-item input:enabled + label:hover {<br>  color: var(–xr-font-color0);<br>}</p>
<p>.xr-section-summary {<br>  grid-column: 1;<br>  color: var(–xr-font-color2);<br>  font-weight: 500;<br>}</p>
<p>.xr-section-summary &gt; span {<br>  display: inline-block;<br>  padding-left: 0.5em;<br>}</p>
<p>.xr-section-summary-in:disabled + label {<br>  color: var(–xr-font-color2);<br>}</p>
<p>.xr-section-summary-in + label:before {<br>  display: inline-block;<br>  content: ‘►’;<br>  font-size: 11px;<br>  width: 15px;<br>  text-align: center;<br>}</p>
<p>.xr-section-summary-in:disabled + label:before {<br>  color: var(–xr-disabled-color);<br>}</p>
<p>.xr-section-summary-in:checked + label:before {<br>  content: ‘▼’;<br>}</p>
<p>.xr-section-summary-in:checked + label &gt; span {<br>  display: none;<br>}</p>
<p>.xr-section-summary,<br>.xr-section-inline-details {<br>  padding-top: 4px;<br>  padding-bottom: 4px;<br>}</p>
<p>.xr-section-inline-details {<br>  grid-column: 2 &#x2F; -1;<br>}</p>
<p>.xr-section-details {<br>  display: none;<br>  grid-column: 1 &#x2F; -1;<br>  margin-bottom: 5px;<br>}</p>
<p>.xr-section-summary-in:checked ~ .xr-section-details {<br>  display: contents;<br>}</p>
<p>.xr-array-wrap {<br>  grid-column: 1 &#x2F; -1;<br>  display: grid;<br>  grid-template-columns: 20px auto;<br>}</p>
<p>.xr-array-wrap &gt; label {<br>  grid-column: 1;<br>  vertical-align: top;<br>}</p>
<p>.xr-preview {<br>  color: var(–xr-font-color3);<br>}</p>
<p>.xr-array-preview,<br>.xr-array-data {<br>  padding: 0 5px !important;<br>  grid-column: 2;<br>}</p>
<p>.xr-array-data,<br>.xr-array-in:checked ~ .xr-array-preview {<br>  display: none;<br>}</p>
<p>.xr-array-in:checked ~ .xr-array-data,<br>.xr-array-preview {<br>  display: inline-block;<br>}</p>
<p>.xr-dim-list {<br>  display: inline-block !important;<br>  list-style: none;<br>  padding: 0 !important;<br>  margin: 0;<br>}</p>
<p>.xr-dim-list li {<br>  display: inline-block;<br>  padding: 0;<br>  margin: 0;<br>}</p>
<p>.xr-dim-list:before {<br>  content: ‘(‘;<br>}</p>
<p>.xr-dim-list:after {<br>  content: ‘)’;<br>}</p>
<p>.xr-dim-list li:not(:last-child):after {<br>  content: ‘,’;<br>  padding-right: 5px;<br>}</p>
<p>.xr-has-index {<br>  font-weight: bold;<br>}</p>
<p>.xr-var-list,<br>.xr-var-item {<br>  display: contents;<br>}</p>
<p>.xr-var-item &gt; div,<br>.xr-var-item label,<br>.xr-var-item &gt; .xr-var-name span {<br>  background-color: var(–xr-background-color-row-even);<br>  margin-bottom: 0;<br>}</p>
<p>.xr-var-item &gt; .xr-var-name:hover span {<br>  padding-right: 5px;<br>}</p>
<p>.xr-var-list &gt; li:nth-child(odd) &gt; div,<br>.xr-var-list &gt; li:nth-child(odd) &gt; label,<br>.xr-var-list &gt; li:nth-child(odd) &gt; .xr-var-name span {<br>  background-color: var(–xr-background-color-row-odd);<br>}</p>
<p>.xr-var-name {<br>  grid-column: 1;<br>}</p>
<p>.xr-var-dims {<br>  grid-column: 2;<br>}</p>
<p>.xr-var-dtype {<br>  grid-column: 3;<br>  text-align: right;<br>  color: var(–xr-font-color2);<br>}</p>
<p>.xr-var-preview {<br>  grid-column: 4;<br>}</p>
<p>.xr-var-name,<br>.xr-var-dims,<br>.xr-var-dtype,<br>.xr-preview,<br>.xr-attrs dt {<br>  white-space: nowrap;<br>  overflow: hidden;<br>  text-overflow: ellipsis;<br>  padding-right: 10px;<br>}</p>
<p>.xr-var-name:hover,<br>.xr-var-dims:hover,<br>.xr-var-dtype:hover,<br>.xr-attrs dt:hover {<br>  overflow: visible;<br>  width: auto;<br>  z-index: 1;<br>}</p>
<p>.xr-var-attrs,<br>.xr-var-data {<br>  display: none;<br>  background-color: var(–xr-background-color) !important;<br>  padding-bottom: 5px !important;<br>}</p>
<p>.xr-var-attrs-in:checked ~ .xr-var-attrs,<br>.xr-var-data-in:checked ~ .xr-var-data {<br>  display: block;<br>}</p>
<p>.xr-var-data &gt; table {<br>  float: right;<br>}</p>
<p>.xr-var-name span,<br>.xr-var-data,<br>.xr-attrs {<br>  padding-left: 25px !important;<br>}</p>
<p>.xr-attrs,<br>.xr-var-attrs,<br>.xr-var-data {<br>  grid-column: 1 &#x2F; -1;<br>}</p>
<p>dl.xr-attrs {<br>  padding: 0;<br>  margin: 0;<br>  display: grid;<br>  grid-template-columns: 125px auto;<br>}</p>
<p>.xr-attrs dt,<br>.xr-attrs dd {<br>  padding: 0;<br>  margin: 0;<br>  float: left;<br>  padding-right: 10px;<br>  width: auto;<br>}</p>
<p>.xr-attrs dt {<br>  font-weight: normal;<br>  grid-column: 1;<br>}</p>
<p>.xr-attrs dt:hover span {<br>  display: inline-block;<br>  background: var(–xr-background-color);<br>  padding-right: 10px;<br>}</p>
<p>.xr-attrs dd {<br>  grid-column: 2;<br>  white-space: pre-wrap;<br>  word-break: break-all;<br>}</p>
<p>.xr-icon-database,<br>.xr-icon-file-text2 {<br>  display: inline-block;<br>  vertical-align: middle;<br>  width: 1em;<br>  height: 1.5em !important;<br>  stroke-width: 0;<br>  stroke: currentColor;<br>  fill: currentColor;<br>}<br></style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;<br>Dimensions:             (x: 2, y: 2, time: 3)<br>Coordinates:<br>    lat                 (x, y) float64 42.25 42.21 42.63 42.59<br>    lon                 (x, y) float64 -99.83 -99.32 -99.79 -99.23</p>
<ul>
<li>time                (time) datetime64[ns] 2014-09-06 2014-09-07 2014-09-08<br>reference_time      datetime64[ns] 2014-09-05<br>Dimensions without coordinates: x, y<br>Data variables:<br>temp                (x, y, time) float64 15.03 15.44 6.512 ... 22.09 3.728<br>temperature_double  (x, y, time) float64 30.07 30.88 13.02 ... 44.18 7.455<br>precip              (x, y, time) float64 1.99 7.872 2.105 ... 5.925 0.6317</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-75f0f96d-4043-43db-946f-967acf1e5876' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-75f0f96d-4043-43db-946f-967acf1e5876' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span>x</span>: 2</li><li><span>y</span>: 2</li><li><span class='xr-has-index'>time</span>: 3</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-f3e62943-0b11-4112-93ca-81ec1f6412cf' class='xr-section-summary-in' type='checkbox'  checked><label for='section-f3e62943-0b11-4112-93ca-81ec1f6412cf' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>lat</span></div><div class='xr-var-dims'>(x, y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>42.25 42.21 42.63 42.59</div><input id='attrs-d99a9615-41c2-4044-8ae4-09a8b481a537' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-d99a9615-41c2-4044-8ae4-09a8b481a537' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6110595f-6825-4672-a061-6b55caa785ca' class='xr-var-data-in' type='checkbox'><label for='data-6110595f-6825-4672-a061-6b55caa785ca' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[42.25, 42.21],<br>   [42.63, 42.59]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lon</span></div><div class='xr-var-dims'>(x, y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-99.83 -99.32 -99.79 -99.23</div><input id='attrs-f51af3b6-c103-443f-9a8e-c73b5df19d23' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f51af3b6-c103-443f-9a8e-c73b5df19d23' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0e24e2a1-2a45-41c1-8f19-5df874bb4ccc' class='xr-var-data-in' type='checkbox'><label for='data-0e24e2a1-2a45-41c1-8f19-5df874bb4ccc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[-99.83, -99.32],<br>   [-99.79, -99.23]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2014-09-06 2014-09-07 2014-09-08</div><input id='attrs-99a9cfee-bea1-4c27-addd-318a9b52f1ce' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-99a9cfee-bea1-4c27-addd-318a9b52f1ce' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ff38d134-b85e-4785-ad81-a4038663c12e' class='xr-var-data-in' type='checkbox'><label for='data-ff38d134-b85e-4785-ad81-a4038663c12e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2014-09-06T00:00:00.000000000&#x27;, &#x27;2014-09-07T00:00:00.000000000&#x27;,<br>   &#x27;2014-09-08T00:00:00.000000000&#x27;], dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>reference_time</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2014-09-05</div><input id='attrs-47e77d49-bfe4-4b94-a7c1-a1207ddcc108' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-47e77d49-bfe4-4b94-a7c1-a1207ddcc108' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-af564e83-1540-46a4-8858-ac72f711a622' class='xr-var-data-in' type='checkbox'><label for='data-af564e83-1540-46a4-8858-ac72f711a622' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(&#x27;2014-09-05T00:00:00.000000000&#x27;, dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-52e04b82-1885-42c2-9169-ed14a3128ee7' class='xr-section-summary-in' type='checkbox'  checked><label for='section-52e04b82-1885-42c2-9169-ed14a3128ee7' class='xr-section-summary' >Data variables: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>temp</span></div><div class='xr-var-dims'>(x, y, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>15.03 15.44 6.512 … 22.09 3.728</div><input id='attrs-fc31de44-90ac-40bb-a32d-75f871022e05' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-fc31de44-90ac-40bb-a32d-75f871022e05' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-54a47b46-ea35-46e1-ab53-764d5468b083' class='xr-var-data-in' type='checkbox'><label for='data-54a47b46-ea35-46e1-ab53-764d5468b083' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[15.03349336, 15.44033513,  6.51238387],<br>[19.54120058, -3.60023195, 21.78888719]],<br>   [[14.36421838, 25.00615749, -7.38567232],<br>[16.29567998, 22.08970341,  3.72752459]]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>temperature_double</span></div><div class='xr-var-dims'>(x, y, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>30.07 30.88 13.02 … 44.18 7.455</div><input id='attrs-daa0676b-9fc0-4ba5-8b8c-91e3d9d52bff' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-daa0676b-9fc0-4ba5-8b8c-91e3d9d52bff' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-32bbabab-19ac-4e39-9cc2-fb1e8213a155' class='xr-var-data-in' type='checkbox'><label for='data-32bbabab-19ac-4e39-9cc2-fb1e8213a155' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[ 30.06698671,  30.88067026,  13.02476775],<br>[ 39.08240116,  -7.20046389,  43.57777438]],<br>   [[ 28.72843677,  50.01231498, -14.77134463],<br>[ 32.59135996,  44.17940682,   7.45504918]]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>precip</span></div><div class='xr-var-dims'>(x, y, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.99 7.872 2.105 … 5.925 0.6317</div><input id='attrs-cedd5189-3e89-41b4-aefd-5be1c100985e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-cedd5189-3e89-41b4-aefd-5be1c100985e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fecd51e8-f73d-4860-8f28-b4dfb830e6d2' class='xr-var-data-in' type='checkbox'><label for='data-fecd51e8-f73d-4860-8f28-b4dfb830e6d2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[1.9897773 , 7.87231296, 2.10522697],<br>[2.53095556, 8.37213625, 0.52534701]],<br>   [[1.31426226, 4.44083463, 8.82139997],<br>[5.00723746, 5.92526386, 0.63166452]]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-f8787307-14e3-421a-9864-ea245241d0b4' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-f8787307-14e3-421a-9864-ea245241d0b4' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></li>
</ul>
<h3 id="5-1-5-数据数组与数据集的处理"><a href="#5-1-5-数据数组与数据集的处理" class="headerlink" title="5.1.5  数据数组与数据集的处理"></a>5.1.5  数据数组与数据集的处理</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建数据数组</span></span><br><span class="line">da = xr.DataArray(np.random.rand(<span class="number">4</span>, <span class="number">3</span>),</span><br><span class="line">               [(<span class="string">&quot;time&quot;</span>, pd.date_range(<span class="string">&quot;2000-01-01&quot;</span>, periods=<span class="number">4</span>)),(<span class="string">&quot;space&quot;</span>, [<span class="string">&quot;level&quot;</span>, <span class="string">&quot;lat&quot;</span>, <span class="string">&quot;lon&quot;</span>])])</span><br><span class="line"><span class="built_in">print</span>(da)</span><br><span class="line"><span class="comment"># 利用位置进行索引</span></span><br><span class="line"><span class="built_in">print</span>(da[<span class="number">0</span>, <span class="number">0</span>])</span><br><span class="line"><span class="built_in">print</span>(da[:, [<span class="number">2</span>, <span class="number">1</span>]])</span><br><span class="line"><span class="comment"># 使用.loc属性进行基于标签的索引</span></span><br><span class="line"><span class="built_in">print</span>(da.loc[<span class="string">&quot;2000-01-01&quot;</span>:<span class="string">&quot;2000-01-02&quot;</span>, <span class="string">&quot;lat&quot;</span>])</span><br><span class="line"><span class="comment"># 利用基于标签的索引来修改数据的值</span></span><br><span class="line">da.loc[<span class="string">&quot;2000-01-01&quot;</span>, [<span class="string">&quot;lat&quot;</span>, <span class="string">&quot;lon&quot;</span>]] = -<span class="number">10</span></span><br><span class="line"><span class="built_in">print</span>(da)</span><br><span class="line"><span class="comment"># 利用维度名称进行索引</span></span><br><span class="line"><span class="built_in">print</span>(da[<span class="built_in">dict</span>(space=<span class="number">0</span>, time=<span class="built_in">slice</span>(<span class="literal">None</span>, <span class="number">2</span>))])</span><br><span class="line"><span class="comment"># 利用维度坐标标签索引</span></span><br><span class="line"><span class="built_in">print</span>(da.loc[<span class="built_in">dict</span>(time=<span class="built_in">slice</span>(<span class="string">&quot;2000-01-01&quot;</span>, <span class="string">&quot;2000-01-02&quot;</span>))])</span><br><span class="line"><span class="built_in">print</span>(da.isel(space=<span class="number">0</span>, time=<span class="built_in">slice</span>(<span class="literal">None</span>, <span class="number">2</span>)))</span><br><span class="line"><span class="built_in">print</span>(da.sel(time=<span class="built_in">slice</span>(<span class="string">&quot;2000-01-01&quot;</span>, <span class="string">&quot;2000-01-02&quot;</span>)))</span><br></pre></td></tr></table></figure>

<pre><code>&lt;xarray.DataArray (time: 4, space: 3)&gt;
array([[0.83459434, 0.62437497, 0.82596113],
       [0.34848421, 0.76559789, 0.28536279],
       [0.90091043, 0.97759082, 0.76602217],
       [0.26035703, 0.01217118, 0.48790219]])
Coordinates:
  * time     (time) datetime64[ns] 2000-01-01 2000-01-02 2000-01-03 2000-01-04
  * space    (space) &lt;U5 &#39;level&#39; &#39;lat&#39; &#39;lon&#39;
&lt;xarray.DataArray ()&gt;
array(0.83459434)
Coordinates:
    time     datetime64[ns] 2000-01-01
    space    &lt;U5 &#39;level&#39;
&lt;xarray.DataArray (time: 4, space: 2)&gt;
array([[0.82596113, 0.62437497],
       [0.28536279, 0.76559789],
       [0.76602217, 0.97759082],
       [0.48790219, 0.01217118]])
Coordinates:
  * time     (time) datetime64[ns] 2000-01-01 2000-01-02 2000-01-03 2000-01-04
  * space    (space) &lt;U5 &#39;lon&#39; &#39;lat&#39;
&lt;xarray.DataArray (time: 2)&gt;
array([0.62437497, 0.76559789])
Coordinates:
  * time     (time) datetime64[ns] 2000-01-01 2000-01-02
    space    &lt;U5 &#39;lat&#39;
&lt;xarray.DataArray (time: 4, space: 3)&gt;
array([[  0.83459434, -10.        , -10.        ],
       [  0.34848421,   0.76559789,   0.28536279],
       [  0.90091043,   0.97759082,   0.76602217],
       [  0.26035703,   0.01217118,   0.48790219]])
Coordinates:
  * time     (time) datetime64[ns] 2000-01-01 2000-01-02 2000-01-03 2000-01-04
  * space    (space) &lt;U5 &#39;level&#39; &#39;lat&#39; &#39;lon&#39;
&lt;xarray.DataArray (time: 2)&gt;
array([0.83459434, 0.34848421])
Coordinates:
  * time     (time) datetime64[ns] 2000-01-01 2000-01-02
    space    &lt;U5 &#39;level&#39;
&lt;xarray.DataArray (time: 2, space: 3)&gt;
array([[  0.83459434, -10.        , -10.        ],
       [  0.34848421,   0.76559789,   0.28536279]])
Coordinates:
  * time     (time) datetime64[ns] 2000-01-01 2000-01-02
  * space    (space) &lt;U5 &#39;level&#39; &#39;lat&#39; &#39;lon&#39;
&lt;xarray.DataArray (time: 2)&gt;
array([0.83459434, 0.34848421])
Coordinates:
  * time     (time) datetime64[ns] 2000-01-01 2000-01-02
    space    &lt;U5 &#39;level&#39;
&lt;xarray.DataArray (time: 2, space: 3)&gt;
array([[  0.83459434, -10.        , -10.        ],
       [  0.34848421,   0.76559789,   0.28536279]])
Coordinates:
  * time     (time) datetime64[ns] 2000-01-01 2000-01-02
  * space    (space) &lt;U5 &#39;level&#39; &#39;lat&#39; &#39;lon&#39;
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 邻近模糊索引</span></span><br><span class="line">da = xr.DataArray([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], [(<span class="string">&quot;x&quot;</span>, [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>])])</span><br><span class="line"><span class="built_in">print</span>(da)</span><br><span class="line"><span class="built_in">print</span>(da.sel(x=[<span class="number">1.1</span>, <span class="number">1.9</span>], method=<span class="string">&quot;nearest&quot;</span>))</span><br><span class="line"><span class="built_in">print</span>(da.sel(x=<span class="number">0.1</span>, method=<span class="string">&quot;backfill&quot;</span>))</span><br><span class="line"><span class="built_in">print</span>(da.sel(x=[<span class="number">0.5</span>, <span class="number">1</span>, <span class="number">1.5</span>, <span class="number">2</span>, <span class="number">2.5</span>], method=<span class="string">&quot;pad&quot;</span>))</span><br></pre></td></tr></table></figure>

<pre><code>&lt;xarray.DataArray (x: 3)&gt;
array([1, 2, 3])
Coordinates:
  * x        (x) int64 0 1 2
&lt;xarray.DataArray (x: 2)&gt;
array([2, 3])
Coordinates:
  * x        (x) int64 1 2
&lt;xarray.DataArray ()&gt;
array(2)
Coordinates:
    x        int64 1
&lt;xarray.DataArray (x: 5)&gt;
array([1, 2, 2, 3, 3])
Coordinates:
  * x        (x) int64 0 1 1 2 2
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用tolerance参数设置模糊索引允许的最大偏差范围</span></span><br><span class="line">da = xr.DataArray([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], [(<span class="string">&quot;x&quot;</span>, [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>])])</span><br><span class="line"><span class="built_in">print</span>(da.reindex(x=[<span class="number">0.9</span>, <span class="number">1.1</span>, <span class="number">1.5</span>], method=<span class="string">&quot;nearest&quot;</span>, tolerance=<span class="number">0.2</span>))</span><br></pre></td></tr></table></figure>

<pre><code>&lt;xarray.DataArray (x: 3)&gt;
array([ 2.,  2., nan])
Coordinates:
  * x        (x) float64 0.9 1.1 1.5
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 保持数据的原始形状，且需要掩盖掉某些元素</span></span><br><span class="line">da = xr.DataArray(np.arange(<span class="number">16</span>).reshape(<span class="number">4</span>, <span class="number">4</span>), dims=[<span class="string">&quot;x&quot;</span>, <span class="string">&quot;y&quot;</span>])</span><br><span class="line"><span class="built_in">print</span>(da.where(da.y &lt; <span class="number">2</span>))</span><br><span class="line"><span class="comment"># 剔除缺测部分</span></span><br><span class="line"><span class="built_in">print</span>(da.where(da.y &lt; <span class="number">2</span>, drop=<span class="literal">True</span>))</span><br></pre></td></tr></table></figure>

<pre><code>&lt;xarray.DataArray (x: 4, y: 4)&gt;
array([[ 0.,  1., nan, nan],
       [ 4.,  5., nan, nan],
       [ 8.,  9., nan, nan],
       [12., 13., nan, nan]])
Dimensions without coordinates: x, y
&lt;xarray.DataArray (x: 4, y: 2)&gt;
array([[ 0.,  1.],
       [ 4.,  5.],
       [ 8.,  9.],
       [12., 13.]])
Dimensions without coordinates: x, y
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 缺测值处理</span></span><br><span class="line">x = xr.DataArray([<span class="number">0</span>, <span class="number">1</span>, np.nan, np.nan, <span class="number">2</span>], dims=[<span class="string">&quot;x&quot;</span>])</span><br><span class="line"><span class="built_in">print</span>(x)</span><br><span class="line"><span class="comment"># 根据x中缺测值的位置返回布尔值</span></span><br><span class="line"><span class="built_in">print</span>(x.isnull())</span><br><span class="line"><span class="comment"># 根据x中非缺测值的位置返回布尔值</span></span><br><span class="line"><span class="built_in">print</span>(x.notnull())</span><br><span class="line"><span class="comment"># 返回x中非缺测值的个数</span></span><br><span class="line"><span class="built_in">print</span>(x.count())</span><br><span class="line"><span class="comment"># 将数据数组x中名为x的维度上的缺测值去除</span></span><br><span class="line"><span class="built_in">print</span>(x.dropna(dim=<span class="string">&quot;x&quot;</span>))</span><br><span class="line"><span class="comment"># 将数据数组x中的缺测值替换为−1</span></span><br><span class="line"><span class="built_in">print</span>(x.fillna(-<span class="number">1</span>))</span><br><span class="line"><span class="comment"># 将数据数组中的缺测值替换为向前最近的一个非缺测值</span></span><br><span class="line"><span class="built_in">print</span>(x.ffill(<span class="string">&quot;x&quot;</span>))</span><br><span class="line"><span class="comment"># 将数据数组中的缺测值替换为向后最近的一个非缺测值</span></span><br><span class="line"><span class="built_in">print</span>(x.bfill(<span class="string">&quot;x&quot;</span>))</span><br></pre></td></tr></table></figure>

<pre><code>&lt;xarray.DataArray (x: 5)&gt;
array([ 0.,  1., nan, nan,  2.])
Dimensions without coordinates: x
&lt;xarray.DataArray (x: 5)&gt;
array([False, False,  True,  True, False])
Dimensions without coordinates: x
&lt;xarray.DataArray (x: 5)&gt;
array([ True,  True, False, False,  True])
Dimensions without coordinates: x
&lt;xarray.DataArray ()&gt;
array(3)
&lt;xarray.DataArray (x: 3)&gt;
array([0., 1., 2.])
Dimensions without coordinates: x
&lt;xarray.DataArray (x: 5)&gt;
array([ 0.,  1., -1., -1.,  2.])
Dimensions without coordinates: x
&lt;xarray.DataArray (x: 5)&gt;
array([0., 1., 1., 1., 2.])
Dimensions without coordinates: x
&lt;xarray.DataArray (x: 5)&gt;
array([0., 1., 2., 2., 2.])
Dimensions without coordinates: x
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 聚合运算</span></span><br><span class="line">arr = xr.DataArray(np.random.RandomState(<span class="number">0</span>).randn(<span class="number">2</span>, <span class="number">3</span>), [(<span class="string">&quot;lat&quot;</span>, [<span class="number">5</span>, <span class="number">10</span>]), (<span class="string">&quot;lon&quot;</span>, [<span class="number">15</span>, <span class="number">20</span>, <span class="number">25</span>])])</span><br><span class="line"><span class="built_in">print</span>(arr)</span><br><span class="line"><span class="comment"># 对其沿lat轴求和</span></span><br><span class="line"><span class="built_in">print</span>(arr.<span class="built_in">sum</span>(dim=<span class="string">&quot;lat&quot;</span>))</span><br><span class="line"><span class="comment"># 对整个数据数组求标准差</span></span><br><span class="line"><span class="built_in">print</span>(arr.std([<span class="string">&quot;lat&quot;</span>, <span class="string">&quot;lon&quot;</span>]))</span><br><span class="line"><span class="comment"># 返回整个数据数组的最小值</span></span><br><span class="line"><span class="built_in">print</span>(arr.<span class="built_in">min</span>())</span><br></pre></td></tr></table></figure>

<pre><code>&lt;xarray.DataArray (lat: 2, lon: 3)&gt;
array([[ 1.76405235,  0.40015721,  0.97873798],
       [ 2.2408932 ,  1.86755799, -0.97727788]])
Coordinates:
  * lat      (lat) int64 5 10
  * lon      (lon) int64 15 20 25
&lt;xarray.DataArray (lon: 3)&gt;
array([4.00494555e+00, 2.26771520e+00, 1.46010423e-03])
Coordinates:
  * lon      (lon) int64 15 20 25
&lt;xarray.DataArray ()&gt;
array(1.09038344)
&lt;xarray.DataArray ()&gt;
array(-0.97727788)
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 通过设置skipna=False来禁止跳过缺测值NaN</span></span><br><span class="line"><span class="built_in">print</span>(xr.DataArray([<span class="number">1</span>, <span class="number">2</span>, np.nan, <span class="number">3</span>]).mean())</span><br><span class="line"><span class="built_in">print</span>(xr.DataArray([<span class="number">1</span>, <span class="number">2</span>, np.nan, <span class="number">3</span>]).mean(skipna=<span class="literal">False</span>))</span><br></pre></td></tr></table></figure>

<pre><code>&lt;xarray.DataArray ()&gt;
array(2.)
&lt;xarray.DataArray ()&gt;
array(nan)
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 数据滑动</span></span><br><span class="line">arr = xr.DataArray(np.arange(<span class="number">0</span>, <span class="number">7.5</span>, <span class="number">0.5</span>).reshape(<span class="number">3</span>, <span class="number">5</span>), dims=(<span class="string">&quot;lat&quot;</span>, <span class="string">&quot;lon&quot;</span>))</span><br><span class="line"><span class="built_in">print</span>(arr)</span><br><span class="line"><span class="built_in">print</span>(arr.rolling(lon=<span class="number">3</span>))</span><br><span class="line"><span class="comment"># 聚合运算的方法可以直接对Rolling对象使用</span></span><br><span class="line">r = arr.rolling(lon=<span class="number">3</span>)</span><br><span class="line"><span class="built_in">print</span>(r.mean())</span><br><span class="line"><span class="comment"># 通过传递center=True来使结果居中</span></span><br><span class="line">r = arr.rolling(lon=<span class="number">3</span>, center=<span class="literal">True</span>)</span><br><span class="line"><span class="built_in">print</span>(r.mean())</span><br><span class="line"><span class="comment"># 在调用 rolling()时设置min_periods将更改窗口中的最小滑动长度，以便在聚合时具有值</span></span><br><span class="line">r = arr.rolling(lon=<span class="number">3</span>, center=<span class="literal">True</span>, min_periods=<span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(r.mean())</span><br><span class="line"><span class="comment"># 多维度滑动</span></span><br><span class="line"><span class="built_in">print</span>(arr.rolling(lat=<span class="number">2</span>, lon=<span class="number">3</span>, min_periods=<span class="number">2</span>))</span><br></pre></td></tr></table></figure>

<pre><code>&lt;xarray.DataArray (lat: 3, lon: 5)&gt;
array([[0. , 0.5, 1. , 1.5, 2. ],
       [2.5, 3. , 3.5, 4. , 4.5],
       [5. , 5.5, 6. , 6.5, 7. ]])
Dimensions without coordinates: lat, lon
DataArrayRolling [lon-&gt;3]
&lt;xarray.DataArray (lat: 3, lon: 5)&gt;
array([[nan, nan, 0.5, 1. , 1.5],
       [nan, nan, 3. , 3.5, 4. ],
       [nan, nan, 5.5, 6. , 6.5]])
Dimensions without coordinates: lat, lon
&lt;xarray.DataArray (lat: 3, lon: 5)&gt;
array([[nan, 0.5, 1. , 1.5, nan],
       [nan, 3. , 3.5, 4. , nan],
       [nan, 5.5, 6. , 6.5, nan]])
Dimensions without coordinates: lat, lon
&lt;xarray.DataArray (lat: 3, lon: 5)&gt;
array([[0.25, 0.5 , 1.  , 1.5 , 1.75],
       [2.75, 3.  , 3.5 , 4.  , 4.25],
       [5.25, 5.5 , 6.  , 6.5 , 6.75]])
Dimensions without coordinates: lat, lon
DataArrayRolling [lat-&gt;2,lon-&gt;3]
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 数据的拆分与组合</span></span><br><span class="line">ds = xr.Dataset(&#123;<span class="string">&quot;foo&quot;</span>: ((<span class="string">&quot;x&quot;</span>, <span class="string">&quot;y&quot;</span>), np.random.rand(<span class="number">4</span>, <span class="number">3</span>))&#125;,coords=&#123;<span class="string">&quot;x&quot;</span>: [<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>], <span class="string">&quot;letters&quot;</span>: (<span class="string">&quot;x&quot;</span>, <span class="built_in">list</span>(<span class="string">&quot;abba&quot;</span>))&#125;)</span><br><span class="line">arr = ds[<span class="string">&quot;foo&quot;</span>]</span><br><span class="line"><span class="built_in">print</span>(ds)</span><br><span class="line"><span class="comment"># 按数据集中变量或坐标的名称进行分组</span></span><br><span class="line"><span class="built_in">print</span>(ds.groupby(<span class="string">&quot;letters&quot;</span>))</span><br><span class="line"><span class="comment"># 使用.groups属性查看组索引</span></span><br><span class="line"><span class="built_in">print</span>(ds.groupby(<span class="string">&quot;letters&quot;</span>).groups)</span><br><span class="line"><span class="comment"># 对每个分组进行函数运算</span></span><br><span class="line"><span class="built_in">print</span>(ds[<span class="string">&quot;foo&quot;</span>].groupby(<span class="string">&quot;letters&quot;</span>).mean(dim=<span class="string">&quot;x&quot;</span>))</span><br></pre></td></tr></table></figure>

<pre><code>&lt;xarray.Dataset&gt;
Dimensions:  (x: 4, y: 3)
Coordinates:
  * x        (x) int64 10 20 30 40
    letters  (x) &lt;U1 &#39;a&#39; &#39;b&#39; &#39;b&#39; &#39;a&#39;
Dimensions without coordinates: y
Data variables:
    foo      (x, y) float64 0.9129 0.5615 0.9985 0.788 ... 0.7002 0.2049 0.02066
DatasetGroupBy, grouped over &#39;letters&#39;
2 groups with labels &#39;a&#39;, &#39;b&#39;.
&#123;&#39;a&#39;: [0, 3], &#39;b&#39;: [1, 2]&#125;
&lt;xarray.DataArray &#39;foo&#39; (letters: 2, y: 3)&gt;
array([[0.80654464, 0.38319598, 0.50960111],
       [0.72969603, 0.11503978, 0.44786172]])
Coordinates:
  * letters  (letters) object &#39;a&#39; &#39;b&#39;
Dimensions without coordinates: y
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 数据的变形和重组</span></span><br><span class="line">ds = xr.Dataset(&#123;<span class="string">&quot;foo&quot;</span>: ((<span class="string">&quot;x&quot;</span>, <span class="string">&quot;y&quot;</span>, <span class="string">&quot;z&quot;</span>), [[[<span class="number">42</span>]]]), <span class="string">&quot;bar&quot;</span>: ((<span class="string">&quot;y&quot;</span>, <span class="string">&quot;z&quot;</span>), [[<span class="number">24</span>]])&#125;)</span><br><span class="line"><span class="comment"># 使用transpose(&quot;y&quot;, &quot;z&quot;, &quot;x&quot;)调整其维度</span></span><br><span class="line"><span class="built_in">print</span>(ds.transpose(<span class="string">&quot;y&quot;</span>, <span class="string">&quot;z&quot;</span>, <span class="string">&quot;x&quot;</span>))</span><br><span class="line"><span class="comment"># 当不传入参数时，则默认逆转全部维度顺序</span></span><br><span class="line"><span class="built_in">print</span>(ds.transpose())</span><br><span class="line"><span class="comment"># 扩充和删除维度</span></span><br><span class="line">expanded = ds.expand_dims(<span class="string">&quot;w&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(expanded)</span><br><span class="line"><span class="built_in">print</span>(expanded.squeeze(<span class="string">&quot;w&quot;</span>))</span><br></pre></td></tr></table></figure>

<pre><code>&lt;xarray.Dataset&gt;
Dimensions:  (x: 1, y: 1, z: 1)
Dimensions without coordinates: x, y, z
Data variables:
    foo      (y, z, x) int64 42
    bar      (y, z) int64 24
&lt;xarray.Dataset&gt;
Dimensions:  (x: 1, y: 1, z: 1)
Dimensions without coordinates: x, y, z
Data variables:
    foo      (z, y, x) int64 42
    bar      (z, y) int64 24
&lt;xarray.Dataset&gt;
Dimensions:  (x: 1, y: 1, z: 1, w: 1)
Dimensions without coordinates: x, y, z, w
Data variables:
    foo      (w, x, y, z) int64 42
    bar      (w, y, z) int64 24
&lt;xarray.Dataset&gt;
Dimensions:  (x: 1, y: 1, z: 1)
Dimensions without coordinates: x, y, z
Data variables:
    foo      (x, y, z) int64 42
    bar      (y, z) int64 24
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 数据集和数据数组的转换</span></span><br><span class="line">ds = xr.Dataset(&#123;<span class="string">&quot;foo&quot;</span>: ((<span class="string">&quot;x&quot;</span>, <span class="string">&quot;y&quot;</span>, <span class="string">&quot;z&quot;</span>), [[[<span class="number">42</span>]]]), <span class="string">&quot;bar&quot;</span>: ((<span class="string">&quot;y&quot;</span>, <span class="string">&quot;z&quot;</span>), [[<span class="number">24</span>]])&#125;)</span><br><span class="line"><span class="built_in">print</span>(ds.to_array())</span><br><span class="line">ds = xr.Dataset(&#123;<span class="string">&quot;foo&quot;</span>: ((<span class="string">&quot;x&quot;</span>, <span class="string">&quot;y&quot;</span>, <span class="string">&quot;z&quot;</span>), [[[<span class="number">42</span>]]]), <span class="string">&quot;bar&quot;</span>: ((<span class="string">&quot;y&quot;</span>, <span class="string">&quot;z&quot;</span>), [[<span class="number">24</span>]])&#125;)</span><br><span class="line">arr = ds.to_array()</span><br><span class="line"><span class="built_in">print</span>(arr.to_dataset(dim=<span class="string">&quot;variable&quot;</span>))</span><br></pre></td></tr></table></figure>

<pre><code>&lt;xarray.DataArray (variable: 2, x: 1, y: 1, z: 1)&gt;
array([[[[42]]],


       [[[24]]]])
Coordinates:
  * variable  (variable) &lt;U3 &#39;foo&#39; &#39;bar&#39;
Dimensions without coordinates: x, y, z
&lt;xarray.Dataset&gt;
Dimensions:  (x: 1, y: 1, z: 1)
Dimensions without coordinates: x, y, z
Data variables:
    foo      (x, y, z) int64 42
    bar      (x, y, z) int64 24
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 数据维度的堆栈与出栈</span></span><br><span class="line">array = xr.DataArray(np.random.randn(<span class="number">2</span>, <span class="number">3</span>), coords=[(<span class="string">&quot;x&quot;</span>, [<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>]), (<span class="string">&quot;y&quot;</span>, [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>])])</span><br><span class="line"><span class="built_in">print</span>(array)</span><br><span class="line"><span class="comment"># 对数据的x和y维度进行堆叠</span></span><br><span class="line">stacked = array.stack(z=(<span class="string">&quot;x&quot;</span>, <span class="string">&quot;y&quot;</span>))</span><br><span class="line"><span class="built_in">print</span>(stacked)</span><br><span class="line"><span class="comment"># 使用unstack()方法将堆叠的数据拆分</span></span><br><span class="line"><span class="built_in">print</span>(stacked.unstack(<span class="string">&quot;z&quot;</span>))</span><br></pre></td></tr></table></figure>

<pre><code>&lt;xarray.DataArray (x: 2, y: 3)&gt;
array([[ 0.23731548,  1.39402883,  0.74502096],
       [-1.68168184,  0.08053787,  0.00270266]])
Coordinates:
  * x        (x) &lt;U1 &#39;a&#39; &#39;b&#39;
  * y        (y) int64 0 1 2
&lt;xarray.DataArray (z: 6)&gt;
array([ 0.23731548,  1.39402883,  0.74502096, -1.68168184,  0.08053787,
        0.00270266])
Coordinates:
  * z        (z) MultiIndex
  - x        (z) object &#39;a&#39; &#39;a&#39; &#39;a&#39; &#39;b&#39; &#39;b&#39; &#39;b&#39;
  - y        (z) int64 0 1 2 0 1 2
&lt;xarray.DataArray (x: 2, y: 3)&gt;
array([[ 0.23731548,  1.39402883,  0.74502096],
       [-1.68168184,  0.08053787,  0.00270266]])
Coordinates:
  * x        (x) object &#39;a&#39; &#39;b&#39;
  * y        (y) int64 0 1 2
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 数据的移动和滚动</span></span><br><span class="line">array = xr.DataArray([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], dims=<span class="string">&quot;x&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(array)</span><br><span class="line"><span class="comment"># 将数据向右侧移动两次</span></span><br><span class="line"><span class="built_in">print</span>(array.shift(x=<span class="number">2</span>))</span><br><span class="line"><span class="comment"># 将数据向右滚动两次</span></span><br><span class="line"><span class="built_in">print</span>(array.roll(x=<span class="number">2</span>, roll_coords=<span class="literal">True</span>))</span><br></pre></td></tr></table></figure>

<pre><code>&lt;xarray.DataArray (x: 4)&gt;
array([1, 2, 3, 4])
Dimensions without coordinates: x
&lt;xarray.DataArray (x: 4)&gt;
array([nan, nan,  1.,  2.])
Dimensions without coordinates: x
&lt;xarray.DataArray (x: 4)&gt;
array([3, 4, 1, 2])
Dimensions without coordinates: x
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 数据合并</span></span><br><span class="line">arr = xr.DataArray(np.random.randn(<span class="number">2</span>, <span class="number">3</span>), [(<span class="string">&quot;x&quot;</span>, [<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>]), (<span class="string">&quot;y&quot;</span>, [<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>])])</span><br><span class="line"><span class="built_in">print</span>(arr)</span><br><span class="line"><span class="comment"># 合并数据数组arr的两个子数组</span></span><br><span class="line"><span class="built_in">print</span>(xr.concat([arr[:, <span class="number">2</span>:], arr[:, <span class="number">1</span>:]], dim=<span class="string">&quot;y&quot;</span>))</span><br><span class="line"><span class="comment"># 使用不同变量组合数据集或数据数组</span></span><br><span class="line"><span class="built_in">print</span>(xr.merge([xr.DataArray(n, name=<span class="string">&quot;var%d&quot;</span> % n) <span class="keyword">for</span> n <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>)]))</span><br><span class="line"><span class="comment"># 使用不同索引或缺失值组合数据集或数据数组</span></span><br><span class="line">ar0 = xr.DataArray([[<span class="number">0</span>, <span class="number">0</span>], [<span class="number">0</span>, <span class="number">0</span>]], [(<span class="string">&quot;x&quot;</span>, [<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>]), (<span class="string">&quot;y&quot;</span>, [-<span class="number">1</span>, <span class="number">0</span>])])</span><br><span class="line">ar1 = xr.DataArray([[<span class="number">1</span>, <span class="number">1</span>], [<span class="number">1</span>, <span class="number">1</span>]], [(<span class="string">&quot;x&quot;</span>, [<span class="string">&quot;b&quot;</span>, <span class="string">&quot;c&quot;</span>]), (<span class="string">&quot;y&quot;</span>, [<span class="number">0</span>, <span class="number">1</span>])])</span><br><span class="line"><span class="built_in">print</span>(ar0.combine_first(ar1))</span><br><span class="line"><span class="built_in">print</span>(ar1.combine_first(ar0))</span><br></pre></td></tr></table></figure>

<pre><code>&lt;xarray.DataArray (x: 2, y: 3)&gt;
array([[-1.98082369, -0.93221737, -1.07522404],
       [-0.4474485 ,  0.55808941, -0.48316307]])
Coordinates:
  * x        (x) &lt;U1 &#39;a&#39; &#39;b&#39;
  * y        (y) int64 10 20 30
&lt;xarray.DataArray (x: 2, y: 3)&gt;
array([[-1.07522404, -0.93221737, -1.07522404],
       [-0.48316307,  0.55808941, -0.48316307]])
Coordinates:
  * x        (x) &lt;U1 &#39;a&#39; &#39;b&#39;
  * y        (y) int64 30 20 30
&lt;xarray.Dataset&gt;
Dimensions:  ()
Data variables:
    var0     int64 0
    var1     int64 1
    var2     int64 2
    var3     int64 3
    var4     int64 4
&lt;xarray.DataArray (x: 3, y: 3)&gt;
array([[ 0.,  0., nan],
       [ 0.,  0.,  1.],
       [nan,  1.,  1.]])
Coordinates:
  * x        (x) &lt;U1 &#39;a&#39; &#39;b&#39; &#39;c&#39;
  * y        (y) int64 -1 0 1
&lt;xarray.DataArray (x: 3, y: 3)&gt;
array([[ 0.,  0., nan],
       [ 0.,  1.,  1.],
       [nan,  1.,  1.]])
Coordinates:
  * x        (x) &lt;U1 &#39;a&#39; &#39;b&#39; &#39;c&#39;
  * y        (y) int64 -1 0 1
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 沿多个维度组合数据集或数据数组</span></span><br><span class="line">arr = xr.DataArray(name=<span class="string">&quot;temperature&quot;</span>, data=[[<span class="number">1</span>,<span class="number">2</span>],[<span class="number">3</span>,<span class="number">4</span>]], dims=[<span class="string">&quot;x&quot;</span>, <span class="string">&quot;y&quot;</span>])</span><br><span class="line">ds_grid = [[arr, arr], [arr, arr]]</span><br><span class="line"><span class="built_in">print</span>(xr.combine_nested(ds_grid, concat_dim=[<span class="string">&quot;x&quot;</span>, <span class="string">&quot;y&quot;</span>]))</span><br><span class="line"><span class="comment"># 从数据的坐标自动推断顺序</span></span><br><span class="line">x1 = xr.DataArray(name=<span class="string">&quot;foo&quot;</span>, data=[<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>], coords=[(<span class="string">&quot;x&quot;</span>, [<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>])])</span><br><span class="line">x2 = xr.DataArray(name=<span class="string">&quot;foo&quot;</span>, data=[<span class="number">2</span>,<span class="number">4</span>,<span class="number">6</span>], coords=[(<span class="string">&quot;x&quot;</span>, [<span class="number">2</span>,<span class="number">4</span>,<span class="number">6</span>])])</span><br><span class="line"><span class="built_in">print</span>(xr.combine_by_coords([x2, x1]))</span><br></pre></td></tr></table></figure>

<pre><code>&lt;xarray.DataArray &#39;temperature&#39; (x: 4, y: 4)&gt;
array([[1, 2, 1, 2],
       [3, 4, 3, 4],
       [1, 2, 1, 2],
       [3, 4, 3, 4]])
Dimensions without coordinates: x, y
&lt;xarray.Dataset&gt;
Dimensions:  (x: 6)
Coordinates:
  * x        (x) int64 1 2 3 4 5 6
Data variables:
    foo      (x) float64 1.0 2.0 3.0 4.0 5.0 6.0


/opt/conda/lib/python3.7/site-packages/xarray/core/dataarray.py:789: FutureWarning: elementwise comparison failed; returning scalar instead, but in the future will perform elementwise comparison
  return key in self.data
/opt/conda/lib/python3.7/site-packages/xarray/core/dataarray.py:789: FutureWarning: elementwise comparison failed; returning scalar instead, but in the future will perform elementwise comparison
  return key in self.data
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 时间序列数据</span></span><br><span class="line"><span class="built_in">print</span>(pd.to_datetime([<span class="string">&quot;2000-01-01&quot;</span>, <span class="string">&quot;2000-02-02&quot;</span>]))</span><br><span class="line"><span class="built_in">print</span>(pd.date_range(<span class="string">&quot;2000-01-01&quot;</span>, periods=<span class="number">365</span>))</span><br><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"><span class="built_in">print</span>(xr.Dataset(&#123;<span class="string">&quot;time&quot;</span>: datetime.datetime(<span class="number">2000</span>, <span class="number">1</span>, <span class="number">1</span>)&#125;))</span><br></pre></td></tr></table></figure>

<pre><code>DatetimeIndex([&#39;2000-01-01&#39;, &#39;2000-02-02&#39;], dtype=&#39;datetime64[ns]&#39;, freq=None)
DatetimeIndex([&#39;2000-01-01&#39;, &#39;2000-01-02&#39;, &#39;2000-01-03&#39;, &#39;2000-01-04&#39;,
               &#39;2000-01-05&#39;, &#39;2000-01-06&#39;, &#39;2000-01-07&#39;, &#39;2000-01-08&#39;,
               &#39;2000-01-09&#39;, &#39;2000-01-10&#39;,
               ...
               &#39;2000-12-21&#39;, &#39;2000-12-22&#39;, &#39;2000-12-23&#39;, &#39;2000-12-24&#39;,
               &#39;2000-12-25&#39;, &#39;2000-12-26&#39;, &#39;2000-12-27&#39;, &#39;2000-12-28&#39;,
               &#39;2000-12-29&#39;, &#39;2000-12-30&#39;],
              dtype=&#39;datetime64[ns]&#39;, length=365, freq=&#39;D&#39;)
&lt;xarray.Dataset&gt;
Dimensions:  ()
Data variables:
    time     datetime64[ns] 2000-01-01
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># datetime索引</span></span><br><span class="line">time = pd.date_range(<span class="string">&quot;2000-01-01&quot;</span>, freq=<span class="string">&quot;H&quot;</span>, periods=<span class="number">365</span> * <span class="number">24</span>)</span><br><span class="line">ds = xr.Dataset(&#123;<span class="string">&quot;foo&quot;</span>: (<span class="string">&quot;time&quot;</span>, np.arange(<span class="number">365</span> * <span class="number">24</span>)), <span class="string">&quot;time&quot;</span>: time&#125;)</span><br><span class="line"><span class="built_in">print</span>(ds.sel(time=<span class="string">&quot;2000-01&quot;</span>))</span><br><span class="line"><span class="built_in">print</span>(ds.sel(time=<span class="built_in">slice</span>(<span class="string">&quot;2000-06-01&quot;</span>, <span class="string">&quot;2000-06-10&quot;</span>)))</span><br><span class="line"><span class="built_in">print</span>(ds.sel(time=datetime.time(<span class="number">12</span>)))</span><br></pre></td></tr></table></figure>

<pre><code>&lt;xarray.Dataset&gt;
Dimensions:  (time: 744)
Coordinates:
  * time     (time) datetime64[ns] 2000-01-01 ... 2000-01-31T23:00:00
Data variables:
    foo      (time) int64 0 1 2 3 4 5 6 7 8 ... 736 737 738 739 740 741 742 743
&lt;xarray.Dataset&gt;
Dimensions:  (time: 240)
Coordinates:
  * time     (time) datetime64[ns] 2000-06-01 ... 2000-06-10T23:00:00
Data variables:
    foo      (time) int64 3648 3649 3650 3651 3652 ... 3883 3884 3885 3886 3887
&lt;xarray.Dataset&gt;
Dimensions:  (time: 365)
Coordinates:
  * time     (time) datetime64[ns] 2000-01-01T12:00:00 ... 2000-12-30T12:00:00
Data variables:
    foo      (time) int64 12 36 60 84 108 132 ... 8628 8652 8676 8700 8724 8748
</code></pre>
<h2 id="5-2-Metpy入门"><a href="#5-2-Metpy入门" class="headerlink" title="5.2 Metpy入门"></a>5.2 Metpy入门</h2><h3 id="5-2-2-MetPy的单位制"><a href="#5-2-2-MetPy的单位制" class="headerlink" title="5.2.2  MetPy的单位制"></a>5.2.2  MetPy的单位制</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># MetPy的单位制运算</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> metpy.units <span class="keyword">import</span> units</span><br><span class="line">distance = np.arange(<span class="number">1</span>, <span class="number">5</span>) * units.meters</span><br><span class="line">time = units.Quantity(np.arange(<span class="number">1</span>, <span class="number">5</span>), <span class="string">&#x27;sec&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(distance / time)</span><br><span class="line"><span class="built_in">print</span>(<span class="number">3</span> * units.inch + <span class="number">5</span> * units.cm)</span><br><span class="line"><span class="built_in">print</span>((<span class="number">1</span> * units.inch).to(units.mm))</span><br></pre></td></tr></table></figure>

<pre><code>[1.0 1.0 1.0 1.0] meter / second
4.968503937007874 inch
25.4 millimeter
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 转换为国际单位制</span></span><br><span class="line">Lf = <span class="number">3.34e6</span> * units(<span class="string">&#x27;J/kg&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(Lf, Lf.to_base_units(), sep=<span class="string">&#x27;\n&#x27;</span>)</span><br></pre></td></tr></table></figure>

<pre><code>3340000.0 joule / kilogram
3340000.0 meter ** 2 / second ** 2
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 偏移量单位</span></span><br><span class="line">Lf = <span class="number">3.34e6</span> * units(<span class="string">&#x27;J/kg&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(Lf, Lf.to_base_units(), sep=<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="number">25</span> * units.degC + <span class="number">5</span> * units.delta_degC)</span><br><span class="line"><span class="built_in">print</span>(<span class="number">273</span> * units.kelvin + <span class="number">10</span> * units.kelvin)</span><br></pre></td></tr></table></figure>

<pre><code>3340000.0 joule / kilogram
3340000.0 meter ** 2 / second ** 2
30 degree_Celsius
283 kelvin
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用带有单位的变量进行MetPy中的函数计算</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> metpy.calc <span class="keyword">as</span> mpcalc</span><br><span class="line"><span class="keyword">from</span> metpy.units <span class="keyword">import</span> units</span><br><span class="line">temperature = <span class="number">73.2</span> * units(<span class="string">&quot;degF&quot;</span>)<span class="comment">#通过unit()函数传入单位字符串，当单位字符串包含空格及符号时只能用此方法</span></span><br><span class="line">rh = <span class="number">64</span> * units.percent <span class="comment">#通过units.xxx赋单位</span></span><br><span class="line">dewpoint = mpcalc.dewpoint_from_relative_humidity(temperature, rh)</span><br><span class="line"><span class="built_in">print</span>(dewpoint)</span><br></pre></td></tr></table></figure>

<pre><code>15.726236381245258 degree_Celsius
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Metpy中的常数使用</span></span><br><span class="line"><span class="keyword">import</span> metpy.constants <span class="keyword">as</span> constants</span><br><span class="line"><span class="built_in">print</span>(<span class="number">5</span>*units.m * constants.g)</span><br></pre></td></tr></table></figure>

<pre><code>49.033249999999995 meter ** 2 / second ** 2
</code></pre>

      
    </div>
    
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2000/01/01/%E7%AC%AC%E5%85%AD%E7%AB%A0/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">&lt;</strong>
      <div class="article-nav-title">
        
          python气象信息系统工程 第六章
        
      </div>
    </a>
  
  
    <a href="/2000/01/01/%E7%AC%AC%E5%9B%9B%E7%AB%A0/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">python气象信息系统工程 第四章</div>
      <strong class="article-nav-caption">&gt;</strong>
    </a>
  
</nav>

  
</article>






</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
      <div class="footer-left">
        &copy; 2024 Nuist666
      </div>
        <div class="footer-right">
          <a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/preccrep/hexo-theme-jelly" target="_blank">Jelly</a>
        </div>
    </div>
  </div>
</footer>
    </div>
    
  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">



<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: false,
		animate: true,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>

<script src="/js/main.js"></script>




  </div>
</body>
</html>