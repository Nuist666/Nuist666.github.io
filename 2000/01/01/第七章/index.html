<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>python气象信息系统工程 第七章 | Nuist666的个人博客</title>

  <!-- keywords -->
  

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="第7章 气象数据插值7.1  空间插值7.1.1  从站点到栅格123import pandas as pddf &#x3D; pd.read_csv(&#x27;&#x2F;home&#x2F;mw&#x2F;input&#x2F;pythonbook4259&#x2F;r160.txt&#x27;, sep&#x3D;&#x27;\s+&#x27;, names&#x3D;[&#x27;lat&#x27;, &#x27;lon&#x27;, &#x27;pre_ano&amp;#">
<meta property="og:type" content="article">
<meta property="og:title" content="python气象信息系统工程 第七章">
<meta property="og:url" content="https://nuist666.github.io/2000/01/01/%E7%AC%AC%E4%B8%83%E7%AB%A0/index.html">
<meta property="og:site_name" content="Nuist666的个人博客">
<meta property="og:description" content="第7章 气象数据插值7.1  空间插值7.1.1  从站点到栅格123import pandas as pddf &#x3D; pd.read_csv(&#x27;&#x2F;home&#x2F;mw&#x2F;input&#x2F;pythonbook4259&#x2F;r160.txt&#x27;, sep&#x3D;&#x27;\s+&#x27;, names&#x3D;[&#x27;lat&#x27;, &#x27;lon&#x27;, &#x27;pre_ano&amp;#">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="1999-12-31T16:07:00.000Z">
<meta property="article:modified_time" content="1999-12-31T16:07:00.000Z">
<meta property="article:author" content="Nuist666">
<meta property="article:tag" content="python,气象信息系统工程">
<meta name="twitter:card" content="summary">
  
    <link rel="alternative" href="/atom.xml" title="Nuist666的个人博客" type="application/atom+xml">
  
  
    <link rel="icon" href="/img/favicon.ico">
  
  
<link rel="stylesheet" href="/css/style.css">

  
  

  
<script src="//cdn.bootcss.com/require.js/2.3.2/require.min.js"></script>

  
<script src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script>


  
<meta name="generator" content="Hexo 7.1.1"></head>
<body>
  <div id="container">
    <div id="particles-js"></div>
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
				<img lazy-src="/img/avatar.png" class="js-avatar">
			
		</a>

		<hgroup>
			<h1 class="header-author"><a href="/">Nuist666</a></h1>
		</hgroup>

		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">Home</a></li>
				        
							<li><a href="/archives">Archives</a></li>
				        
						</ul>
					</nav>
					<nav class="half-header-menu">
						<a class="hide">Home</a>
						<a>Tags</a>
						<a>Links</a>
						<a>About</a>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/Nuist666" title="github">github</a>
					        
								<a class="mail" target="_blank" href="mailto:202183290043@gmail.com" title="mail">mail</a>
					        
								<a class="weibo" target="_blank" href="https://weibo.com/u/5586096129" title="weibo">weibo</a>
					        
								<a class="twitter" target="_blank" href="https://twitter.com/nuist_666" title="twitter">twitter</a>
					        
						</div>
						<!-- music -->
						
							<!-- <div style="position: absolute; bottom: 120px; left: auto; width: 85%;"> -->
							<div style="position: absolute; left: auto; width: 85%;">
								<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=220 height=86 src="//music.163.com/outchain/player?type=2&id=28411862&auto=1&height=66"></iframe>
							</div>
						
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/Overflow-Mirai-LLOneBot-OneBot/" style="font-size: 10px;">Overflow,Mirai,LLOneBot,OneBot</a> <a href="/tags/python-%E6%B0%94%E8%B1%A1%E4%BF%A1%E6%81%AF%E7%B3%BB%E7%BB%9F%E5%B7%A5%E7%A8%8B/" style="font-size: 20px;">python,气象信息系统工程</a> <a href="/tags/%E5%8D%8E%E4%B8%BA%E4%BA%91-%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2-Hexo/" style="font-size: 10px;">华为云,个人博客,Hexo</a> <a href="/tags/%E6%A8%A1%E6%9D%BF-%E5%B0%8F%E4%B9%A6%E5%8C%A0-%E4%B8%89%E5%B3%B0%E7%9C%9F%E7%99%BD-%E6%96%B0%E5%BB%BA/" style="font-size: 10px;">模板,小书匠,三峰真白,新建</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="https://qm.qq.com/q/HrJvHGMzek">qq</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="https://space.bilibili.com/3546647772531174">bilibili</a>
			        
			        </div>
				</section>
				

				
				
				<section class="switch-part switch-part4">
				
					<div id="js-aboutme">I&#39;m a student in NUIST.</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>

<img src="1" onerror="localStorage.setItem('modelId','25')" style="display: none;">

<script>

// live2d_path 参数建议使用绝对路径
const live2d_path = "https://fastly.jsdelivr.net/gh/stevenjoezhang/live2d-widget@latest/";
//const live2d_path = "/live2d-widget/";

// 封装异步加载资源的方法
function loadExternalResource(url, type) {
	return new Promise((resolve, reject) => {
		let tag;

		if (type === "css") {
			tag = document.createElement("link");
			tag.rel = "stylesheet";
			tag.href = url;
		}
		else if (type === "js") {
			tag = document.createElement("script");
			tag.src = url;
		}
		if (tag) {
			tag.onload = () => resolve(url);
			tag.onerror = () => reject(url);
			document.head.appendChild(tag);
		}
	});
}

// 加载 waifu.css live2d.min.js waifu-tips.js
	Promise.all([
		loadExternalResource(live2d_path + "waifu.css", "css"),
		loadExternalResource(live2d_path + "live2d.min.js", "js"),
		loadExternalResource(live2d_path + "waifu-tips.js", "js")
	]).then(() => {
		// 配置选项的具体用法见 README.md
		initWidget({
			waifuPath: live2d_path + "waifu-tips.json",
			apiPath: "https://api.zsq.im/live2d/",
			//cdnPath: "https://fastly.jsdelivr.net/gh/fghrsh/live2d_api/",
			tools: ["hitokoto", "asteroids", "switch-model", "switch-texture", "photo", "info", "quit"]
		});
	});

console.log(`
  く__,.ヘヽ.        /  ,ー､ 〉
           ＼ ', !-─‐-i  /  /´
           ／｀ｰ'       L/／｀ヽ､
         /   ／,   /|   ,   ,       ',
       ｲ   / /-‐/  ｉ  L_ ﾊ ヽ!   i
        ﾚ ﾍ 7ｲ｀ﾄ   ﾚ'ｧ-ﾄ､!ハ|   |
          !,/7 '0'     ´0iソ|    |
          |.从"    _     ,,,, / |./    |
          ﾚ'| i＞.､,,__  _,.イ /   .i   |
            ﾚ'| | / k_７_/ﾚ'ヽ,  ﾊ.  |
              | |/i 〈|/   i  ,.ﾍ |  i  |
             .|/ /  ｉ：    ﾍ!    ＼  |
              kヽ>､ﾊ    _,.ﾍ､    /､!
              !'〈//｀Ｔ´', ＼ ｀'7'ｰr'
              ﾚ'ヽL__|___i,___,ンﾚ|ノ
                  ﾄ-,/  |___./
                  'ｰ'    !_,.:
`);

</script>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide"></h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="/img/avatar.png" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author"></h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">Home</a></li>
		        
					<li><a href="/archives">Archives</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/Nuist666" title="github">github</a>
			        
						<a class="mail" target="_blank" href="mailto:202183290043@gmail.com" title="mail">mail</a>
			        
						<a class="weibo" target="_blank" href="https://weibo.com/u/5586096129" title="weibo">weibo</a>
			        
						<a class="twitter" target="_blank" href="https://twitter.com/nuist_666" title="twitter">twitter</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap"><article id="post-第七章" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2000/01/01/%E7%AC%AC%E4%B8%83%E7%AB%A0/" class="article-date">
  	<time datetime="1999-12-31T16:07:00.000Z" itemprop="datePublished">2000-01-01</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      python气象信息系统工程 第七章
      
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
	<div class="article-tag tagcloud">
		<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python-%E6%B0%94%E8%B1%A1%E4%BF%A1%E6%81%AF%E7%B3%BB%E7%BB%9F%E5%B7%A5%E7%A8%8B/" rel="tag">python,气象信息系统工程</a></li></ul>
	</div>

        
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/%E5%B0%8F%E4%B9%A6%E5%8C%A0-python/">/小书匠/python</a>
	</div>


        
        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="第7章-气象数据插值"><a href="#第7章-气象数据插值" class="headerlink" title="第7章 气象数据插值"></a>第7章 气象数据插值</h1><h2 id="7-1-空间插值"><a href="#7-1-空间插值" class="headerlink" title="7.1  空间插值"></a>7.1  空间插值</h2><h3 id="7-1-1-从站点到栅格"><a href="#7-1-1-从站点到栅格" class="headerlink" title="7.1.1  从站点到栅格"></a>7.1.1  从站点到栅格</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">df = pd.read_csv(<span class="string">&#x27;/home/mw/input/pythonbook4259/r160.txt&#x27;</span>, sep=<span class="string">&#x27;\s+&#x27;</span>, names=[<span class="string">&#x27;lat&#x27;</span>, <span class="string">&#x27;lon&#x27;</span>, <span class="string">&#x27;pre_ano&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(df)</span><br></pre></td></tr></table></figure>

<pre><code>       lat     lon   pre_ano
0    51.72  126.65  0.098331
1    48.77  121.92 -0.167619
2    49.22  119.75 -0.064597
3    50.45  121.70 -0.046360
4    49.17  125.23  0.017577
..     ...     ...       ...
155  47.73   88.08 -0.036620
156  46.73   83.00  0.071207
157  44.43   84.66 -0.205051
158  43.95   81.33  0.170275
159  43.78   87.62 -0.103539

[160 rows x 3 columns]
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pykrige.ok <span class="keyword">import</span> OrdinaryKriging</span><br><span class="line">krige = OrdinaryKriging(</span><br><span class="line">          df[<span class="string">&#x27;lon&#x27;</span>],</span><br><span class="line">          df[<span class="string">&#x27;lat&#x27;</span>],</span><br><span class="line">          df[<span class="string">&#x27;pre_ano&#x27;</span>],</span><br><span class="line">          variogram_model=<span class="string">&quot;linear&quot;</span>,</span><br><span class="line">          verbose=<span class="literal">False</span>,</span><br><span class="line">          enable_plotting=<span class="literal">False</span>,</span><br><span class="line">       )</span><br></pre></td></tr></table></figure>


<pre><code>---------------------------------------------------------------------------

ModuleNotFoundError                       Traceback (most recent call last)

&lt;ipython-input-2-137613763ad2&gt; in &lt;module&gt;
----&gt; 1 from pykrige.ok import OrdinaryKriging
      2 krige = OrdinaryKriging(
      3           df[&#39;lon&#39;],
      4           df[&#39;lat&#39;],
      5           df[&#39;pre_ano&#39;],


ModuleNotFoundError: No module named &#39;pykrige&#39;
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">lon = np.arange(<span class="number">76.0</span>, <span class="number">131.5</span>+<span class="number">0.5</span>, <span class="number">0.5</span>) <span class="comment"># np.arange()函数创建的数组不包含参数传入的终点值</span></span><br><span class="line">lat = np.arange(<span class="number">20.5</span>, <span class="number">51.5</span>+<span class="number">0.5</span>, <span class="number">0.5</span>) <span class="comment"># 所以在终点值后再加入一个步长以确保最后一个值被包含在结果中</span></span><br><span class="line"><span class="built_in">print</span>(lon.shape, lat.shape)</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pre_grid, ss = krige.execute(<span class="string">&quot;grid&quot;</span>, lon, lat)</span><br><span class="line"><span class="built_in">print</span>(pre_grid)</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> xarray <span class="keyword">as</span> xr</span><br><span class="line">pre_da = xr.DataArray(pre_grid, coords=[lat, lon], dims=[<span class="string">&#x27;lat&#x27;</span>, <span class="string">&#x27;lon&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(pre_da)</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> metpy.interpolate <span class="keyword">import</span> inverse_distance_to_grid</span><br><span class="line"></span><br><span class="line">lon = np.arange(<span class="number">76.0</span>, <span class="number">131.5</span>+<span class="number">0.5</span>, <span class="number">0.5</span>)</span><br><span class="line">lat = np.arange(<span class="number">20.5</span>, <span class="number">51.5</span>+<span class="number">0.5</span>, <span class="number">0.5</span>)</span><br><span class="line">lon_grid, lat_grid = np.meshgrid(lon, lat) <span class="comment"># 生成交织的二维经纬栅格</span></span><br><span class="line"><span class="comment"># 注意：inverse_distance_to_grid()使用的目标栅格为交织后的二维经纬栅格</span></span><br><span class="line">pre_grid = inverse_distance_to_grid(</span><br><span class="line">              df[<span class="string">&#x27;lon&#x27;</span>].values,</span><br><span class="line">              df[<span class="string">&#x27;lat&#x27;</span>].values,</span><br><span class="line">              df[<span class="string">&#x27;pre_ano&#x27;</span>].values,</span><br><span class="line">              lon_grid,</span><br><span class="line">              lat_grid,</span><br><span class="line">              r=<span class="number">15</span>,</span><br><span class="line">              min_neighbors=<span class="number">3</span></span><br><span class="line">          )</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(pre_grid)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<pre><code>[[        nan         nan         nan ... -0.41675891 -0.41730563
  -0.41772805]
 [        nan         nan         nan ... -0.41783573 -0.41883586
  -0.42000272]
 [        nan         nan         nan ... -0.41931729 -0.41991869
  -0.42128663]
 ...
 [-0.04594149 -0.04876271 -0.05241695 ... -0.15684901 -0.15684024
  -0.15693899]
 [-0.04011599 -0.04204267 -0.04612476 ... -0.1527561  -0.15290136
  -0.15305936]
 [-0.03320475 -0.03582687 -0.03862931 ... -0.14872947 -0.14882568
  -0.14891597]]
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> xarray <span class="keyword">as</span> xr</span><br><span class="line"></span><br><span class="line">pre_da = xr.DataArray(pre_grid, coords=[lat, lon], dims=[<span class="string">&#x27;lat&#x27;</span>, <span class="string">&#x27;lon&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(pre_da)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<pre><code>&lt;xarray.DataArray (lat: 63, lon: 112)&gt;
array([[        nan,         nan,         nan, ..., -0.41675891,
        -0.41730563, -0.41772805],
       [        nan,         nan,         nan, ..., -0.41783573,
        -0.41883586, -0.42000272],
       [        nan,         nan,         nan, ..., -0.41931729,
        -0.41991869, -0.42128663],
       ...,
       [-0.04594149, -0.04876271, -0.05241695, ..., -0.15684901,
        -0.15684024, -0.15693899],
       [-0.04011599, -0.04204267, -0.04612476, ..., -0.1527561 ,
        -0.15290136, -0.15305936],
       [-0.03320475, -0.03582687, -0.03862931, ..., -0.14872947,
        -0.14882568, -0.14891597]])
Coordinates:
  * lat      (lat) float64 20.5 21.0 21.5 22.0 22.5 ... 49.5 50.0 50.5 51.0 51.5
  * lon      (lon) float64 76.0 76.5 77.0 77.5 78.0 ... 130.0 130.5 131.0 131.5
</code></pre>
<h3 id="7-1-2-从栅格到站点"><a href="#7-1-2-从栅格到站点" class="headerlink" title="7.1.2  从栅格到站点"></a>7.1.2  从栅格到站点</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(pre_da)</span><br></pre></td></tr></table></figure>

<pre><code>&lt;xarray.DataArray (lat: 63, lon: 112)&gt;
array([[        nan,         nan,         nan, ..., -0.41675891,
        -0.41730563, -0.41772805],
       [        nan,         nan,         nan, ..., -0.41783573,
        -0.41883586, -0.42000272],
       [        nan,         nan,         nan, ..., -0.41931729,
        -0.41991869, -0.42128663],
       ...,
       [-0.04594149, -0.04876271, -0.05241695, ..., -0.15684901,
        -0.15684024, -0.15693899],
       [-0.04011599, -0.04204267, -0.04612476, ..., -0.1527561 ,
        -0.15290136, -0.15305936],
       [-0.03320475, -0.03582687, -0.03862931, ..., -0.14872947,
        -0.14882568, -0.14891597]])
Coordinates:
  * lat      (lat) float64 20.5 21.0 21.5 22.0 22.5 ... 49.5 50.0 50.5 51.0 51.5
  * lon      (lon) float64 76.0 76.5 77.0 77.5 78.0 ... 130.0 130.5 131.0 131.5
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pre_sta = pre_da.interp(lon=lon, lat=lat, method=<span class="string">&#x27;linear&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(pre_sta)</span><br></pre></td></tr></table></figure>

<pre><code>&lt;xarray.DataArray (lat: 63, lon: 112)&gt;
array([[        nan,         nan,         nan, ..., -0.41675891,
        -0.41730563, -0.41772805],
       [        nan,         nan,         nan, ..., -0.41783573,
        -0.41883586, -0.42000272],
       [        nan,         nan,         nan, ..., -0.41931729,
        -0.41991869, -0.42128663],
       ...,
       [-0.04594149, -0.04876271, -0.05241695, ..., -0.15684901,
        -0.15684024, -0.15693899],
       [-0.04011599, -0.04204267, -0.04612476, ..., -0.1527561 ,
        -0.15290136, -0.15305936],
       [-0.03320475, -0.03582687, -0.03862931, ..., -0.14872947,
        -0.14882568, -0.14891597]])
Coordinates:
  * lon      (lon) float64 76.0 76.5 77.0 77.5 78.0 ... 130.0 130.5 131.0 131.5
  * lat      (lat) float64 20.5 21.0 21.5 22.0 22.5 ... 49.5 50.0 50.5 51.0 51.5
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pre_df = pre_sta.to_dataframe(<span class="string">&#x27;pre_ano&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(pre_df)</span><br></pre></td></tr></table></figure>

<pre><code>             pre_ano
lat  lon            
20.5 76.0        NaN
     76.5        NaN
     77.0        NaN
     77.5        NaN
     78.0        NaN
...              ...
51.5 129.5 -0.148536
     130.0 -0.148608
     130.5 -0.148729
     131.0 -0.148826
     131.5 -0.148916

[7056 rows x 1 columns]
</code></pre>
<h3 id="7-1-3-从栅格到栅格"><a href="#7-1-3-从栅格到栅格" class="headerlink" title="7.1.3  从栅格到栅格"></a>7.1.3  从栅格到栅格</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(pre_da)</span><br></pre></td></tr></table></figure>

<pre><code>&lt;xarray.DataArray (lat: 63, lon: 112)&gt;
array([[        nan,         nan,         nan, ..., -0.41675891,
        -0.41730563, -0.41772805],
       [        nan,         nan,         nan, ..., -0.41783573,
        -0.41883586, -0.42000272],
       [        nan,         nan,         nan, ..., -0.41931729,
        -0.41991869, -0.42128663],
       ...,
       [-0.04594149, -0.04876271, -0.05241695, ..., -0.15684901,
        -0.15684024, -0.15693899],
       [-0.04011599, -0.04204267, -0.04612476, ..., -0.1527561 ,
        -0.15290136, -0.15305936],
       [-0.03320475, -0.03582687, -0.03862931, ..., -0.14872947,
        -0.14882568, -0.14891597]])
Coordinates:
  * lat      (lat) float64 20.5 21.0 21.5 22.0 22.5 ... 49.5 50.0 50.5 51.0 51.5
  * lon      (lon) float64 76.0 76.5 77.0 77.5 78.0 ... 130.0 130.5 131.0 131.5
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">pre_grid1 = pre_da.interp(lon=[<span class="number">80</span>, <span class="number">90</span>, <span class="number">100</span>, <span class="number">120</span>], </span><br><span class="line">                      lat=[<span class="number">25</span>, <span class="number">30</span>, <span class="number">35</span>, <span class="number">40</span>], </span><br><span class="line">                      method=<span class="string">&#x27;linear&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(pre_sta)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<pre><code>&lt;xarray.DataArray (lat: 63, lon: 112)&gt;
array([[        nan,         nan,         nan, ..., -0.41675891,
        -0.41730563, -0.41772805],
       [        nan,         nan,         nan, ..., -0.41783573,
        -0.41883586, -0.42000272],
       [        nan,         nan,         nan, ..., -0.41931729,
        -0.41991869, -0.42128663],
       ...,
       [-0.04594149, -0.04876271, -0.05241695, ..., -0.15684901,
        -0.15684024, -0.15693899],
       [-0.04011599, -0.04204267, -0.04612476, ..., -0.1527561 ,
        -0.15290136, -0.15305936],
       [-0.03320475, -0.03582687, -0.03862931, ..., -0.14872947,
        -0.14882568, -0.14891597]])
Coordinates:
  * lon      (lon) float64 76.0 76.5 77.0 77.5 78.0 ... 130.0 130.5 131.0 131.5
  * lat      (lat) float64 20.5 21.0 21.5 22.0 22.5 ... 49.5 50.0 50.5 51.0 51.5
</code></pre>
<h2 id="7-2-时间插值"><a href="#7-2-时间插值" class="headerlink" title="7.2  时间插值"></a>7.2  时间插值</h2><h3 id="7-2-1-站点时间内插"><a href="#7-2-1-站点时间内插" class="headerlink" title="7.2.1  站点时间内插"></a>7.2.1  站点时间内插</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="comment">#构造数组</span></span><br><span class="line">df = pd.DataFrame([[<span class="number">21.7</span>, <span class="number">983</span>, <span class="number">0.64</span>],</span><br><span class="line">                  [<span class="number">19.2</span>, <span class="number">991</span>, <span class="number">0.75</span>],</span><br><span class="line">                  [<span class="number">13.4</span>, <span class="number">973</span>, <span class="number">0.83</span>]],</span><br><span class="line">                 columns=[<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;rh&#x27;</span>]</span><br><span class="line">                )</span><br><span class="line">df[<span class="string">&#x27;time&#x27;</span>] = pd.to_datetime([<span class="string">&#x27;2020-02-19&#x27;</span>, <span class="string">&#x27;2020-02-20&#x27;</span>, <span class="string">&#x27;2020-02-22&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<pre><code>      t    p    rh       time
0  21.7  983  0.64 2020-02-19
1  19.2  991  0.75 2020-02-20
2  13.4  973  0.83 2020-02-22
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">df = df.set_index(<span class="string">&#x27;time&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<pre><code>               t    p    rh
time                       
2020-02-19  21.7  983  0.64
2020-02-20  19.2  991  0.75
2020-02-22  13.4  973  0.83
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">df_interp = df.resample(<span class="string">&#x27;1D&#x27;</span>).interpolate(method=<span class="string">&#x27;linear&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(df_interp)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<pre><code>               t      p    rh
time                         
2020-02-19  21.7  983.0  0.64
2020-02-20  19.2  991.0  0.75
2020-02-21  16.3  982.0  0.79
2020-02-22  13.4  973.0  0.83
</code></pre>
<h3 id="7-2-2-栅格时间内插"><a href="#7-2-2-栅格时间内插" class="headerlink" title="7.2.2  栅格时间内插"></a>7.2.2  栅格时间内插</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> xarray <span class="keyword">as</span> xr</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="comment">#构造数组</span></span><br><span class="line">da = xr.DataArray(np.<span class="built_in">abs</span>(np.random.randn(<span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>)*<span class="number">5</span>+<span class="number">15</span>),coords=[pd.to_datetime([<span class="string">&#x27;2020-02-19&#x27;</span>, <span class="string">&#x27;2020-02-20&#x27;</span>, <span class="string">&#x27;2020-02-22&#x27;</span>]),[<span class="number">20</span>, <span class="number">25</span>, <span class="number">30</span>], [<span class="number">120</span>, <span class="number">125</span>, <span class="number">130</span>]],dims=[<span class="string">&#x27;time&#x27;</span>, <span class="string">&#x27;lat&#x27;</span>, <span class="string">&#x27;lon&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(da)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<pre><code>&lt;xarray.DataArray (time: 3, lat: 3, lon: 3)&gt;
array([[[25.36833749,  9.835558  ,  9.70410351],
        [16.96870264,  7.33170443, 14.86629016],
        [16.39984725, 16.46497263, 16.3571344 ]],

       [[14.5675103 , 12.17993797,  9.57918095],
        [23.61240778, 14.57624162, 10.1265022 ],
        [12.1024726 , 10.50885673, 11.87143659]],

       [[ 7.60884169, 20.78943309,  7.90046148],
        [18.41886334, 23.20704066, 17.45145241],
        [ 5.89131442, 19.3040832 , 14.7046148 ]]])
Coordinates:
  * time     (time) datetime64[ns] 2020-02-19 2020-02-20 2020-02-22
  * lat      (lat) int64 20 25 30
  * lon      (lon) int64 120 125 130
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">da_interp = da.interp(time=[<span class="string">&#x27;2020-02-21&#x27;</span>], method=<span class="string">&#x27;linear&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(da_interp)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<pre><code>&lt;xarray.DataArray (time: 1, lat: 3, lon: 3)&gt;
array([[[11.08817599, 16.48468553,  8.73982122],
        [21.01563556, 18.89164114, 13.78897731],
        [ 8.99689351, 14.90646997, 13.28802569]]])
Coordinates:
  * lat      (lat) int64 20 25 30
  * lon      (lon) int64 120 125 130
  * time     (time) datetime64[ns] 2020-02-21
</code></pre>
<script src="https://utteranc.es/client.js"
        repo="Nuist666/blog_comment"
        issue-term="python气象信息系统工程 第七章"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>
      
    </div>
    
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2000/01/01/%E7%AC%AC%E5%85%AB%E7%AB%A0/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">&lt;</strong>
      <div class="article-nav-title">
        
          python气象信息系统工程 第八章
        
      </div>
    </a>
  
  
    <a href="/2000/01/01/%E7%AC%AC%E5%85%AD%E7%AB%A0/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">python气象信息系统工程 第六章</div>
      <strong class="article-nav-caption">&gt;</strong>
    </a>
  
</nav>

  
</article>






</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
      <div class="footer-left">
        &copy; 2024 Nuist666
      </div>
        <div class="footer-right">
          <a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/preccrep/hexo-theme-jelly" target="_blank">Jelly</a>
        </div>
    </div>
  </div>
</footer>
    </div>
    
  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">



<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: false,
		animate: true,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>

<script src="/js/main.js"></script>




  </div>
</body>
</html>